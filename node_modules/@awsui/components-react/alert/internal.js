import { __assign, __rest } from "tslib";
import React from 'react';
import clsx from 'clsx';
import { InternalButton } from '../button/internal';
import InternalIcon from '../icon/internal';
import { getBaseProps } from '../internal/base-component';
import VisualContext from '../internal/components/visual-context';
import styles from './styles.css.js';
import { fireNonCancelableEvent } from '../internal/events';
import { useContainerBreakpoints } from '../internal/hooks/container-queries';
import { useVisualRefresh } from '../internal/hooks/use-visual-mode';
import mergeRefs from 'react-merge-refs';
var typeToIcon = {
    error: 'status-negative',
    warning: 'status-warning',
    success: 'status-positive',
    info: 'status-info'
};
export default function InternalAlert(_a) {
    var _b;
    var _c = _a.type, type = _c === void 0 ? 'info' : _c, _d = _a.visible, visible = _d === void 0 ? true : _d, dismissible = _a.dismissible, dismissAriaLabel = _a.dismissAriaLabel, children = _a.children, header = _a.header, buttonText = _a.buttonText, action = _a.action, onDismiss = _a.onDismiss, onButtonClick = _a.onButtonClick, _e = _a.__internalRootRef, __internalRootRef = _e === void 0 ? null : _e, rest = __rest(_a, ["type", "visible", "dismissible", "dismissAriaLabel", "children", "header", "buttonText", "action", "onDismiss", "onButtonClick", "__internalRootRef"]);
    var baseProps = getBaseProps(rest);
    var _f = useContainerBreakpoints(['xs']), breakpoint = _f[0], ref = _f[1];
    var isRefresh = useVisualRefresh(ref);
    var size = isRefresh ? 'normal' : header && children ? 'big' : 'normal';
    var actionButton = action || (React.createElement(InternalButton, { className: styles['action-button'], onClick: function () { return fireNonCancelableEvent(onButtonClick); }, formAction: "none" }, buttonText));
    var hasAction = Boolean(action || buttonText);
    return (React.createElement("div", __assign({}, baseProps, { "aria-hidden": !visible, className: clsx(styles.root, (_b = {}, _b[styles.hidden] = !visible, _b), baseProps.className, styles["breakpoint-" + breakpoint]), ref: mergeRefs([ref, __internalRootRef]) }),
        React.createElement(VisualContext, { contextName: "alert" },
            React.createElement("div", { className: clsx(styles.alert, styles["type-" + type]) },
                React.createElement("div", { className: clsx(styles.icon, styles.text) },
                    React.createElement(InternalIcon, { name: typeToIcon[type], size: size })),
                React.createElement("div", { className: styles.body },
                    React.createElement("div", { className: clsx(styles.message, styles.text) },
                        header && React.createElement("div", { className: styles.header }, header),
                        React.createElement("div", { className: styles.content }, children)),
                    hasAction && React.createElement("div", { className: styles.action }, actionButton)),
                dismissible && (React.createElement("div", { className: styles.dismiss },
                    React.createElement(InternalButton, { className: styles['dismiss-button'], variant: "icon", iconName: "close", formAction: "none", ariaLabel: dismissAriaLabel, onClick: function () { return fireNonCancelableEvent(onDismiss); } })))))));
}
