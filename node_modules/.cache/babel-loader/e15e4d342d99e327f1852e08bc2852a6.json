{"ast":null,"code":"import { __assign, __rest, __spreadArray } from \"tslib\";\nimport React, { useCallback, useImperativeHandle, useLayoutEffect, useMemo, useRef } from 'react';\nimport clsx from 'clsx';\nimport { getBaseProps } from '../internal/base-component';\nimport { fireNonCancelableEvent } from '../internal/events';\nimport { useStableEventHandler } from '../internal/hooks/use-stable-event-handler';\nimport InternalAttributeEditor from '../attribute-editor/internal';\nimport InternalStatusIndicator from '../status-indicator/internal';\nimport InternalBox from '../box/internal';\nimport { FormFieldError } from '../form-field/internal';\nimport { TagControl, UndoButton } from './internal';\nimport { validate } from './validation';\nimport { findIndex, useMemoizedArray } from './utils';\nimport styles from './styles.css.js';\nimport { applyDisplayName } from '../internal/utils/apply-display-name';\nimport useBaseComponent from '../internal/hooks/use-base-component';\n\nvar isItemRemovable = function (_a) {\n  var tag = _a.tag;\n  return !tag.markedForRemoval;\n};\n\nvar TagEditor = React.forwardRef(function (_a, ref) {\n  var _b, _c;\n\n  var _d = _a.tags,\n      tags = _d === void 0 ? [] : _d,\n      i18nStrings = _a.i18nStrings,\n      _e = _a.loading,\n      loading = _e === void 0 ? false : _e,\n      _f = _a.tagLimit,\n      tagLimit = _f === void 0 ? 50 : _f,\n      allowedCharacterPattern = _a.allowedCharacterPattern,\n      keysRequest = _a.keysRequest,\n      valuesRequest = _a.valuesRequest,\n      onChange = _a.onChange,\n      restProps = __rest(_a, [\"tags\", \"i18nStrings\", \"loading\", \"tagLimit\", \"allowedCharacterPattern\", \"keysRequest\", \"valuesRequest\", \"onChange\"]);\n\n  var baseComponentProps = useBaseComponent('TagEditor');\n  var remainingTags = tagLimit - tags.filter(function (tag) {\n    return !tag.markedForRemoval;\n  }).length;\n  var attributeEditorRef = useRef(null);\n  var keyInputRefs = useRef([]);\n  var valueInputRefs = useRef([]);\n  var undoButtonRefs = useRef([]);\n  var initialKeyOptionsRef = useRef([]);\n  var keyDirtyStateRef = useRef([]);\n  var focusEventRef = useRef();\n  useLayoutEffect(function () {\n    var _a;\n\n    (_a = focusEventRef.current) === null || _a === void 0 ? void 0 : _a.apply(undefined);\n    focusEventRef.current = undefined;\n  });\n  var errors = validate(tags, keyDirtyStateRef.current, i18nStrings, allowedCharacterPattern ? new RegExp(allowedCharacterPattern) : undefined);\n  var internalTags = useMemoizedArray(tags.map(function (tag, i) {\n    return {\n      tag: tag,\n      error: errors[i]\n    };\n  }), function (prev, next) {\n    var _a, _b, _c, _d;\n\n    return prev.tag === next.tag && ((_a = prev.error) === null || _a === void 0 ? void 0 : _a.key) === ((_b = next.error) === null || _b === void 0 ? void 0 : _b.key) && ((_c = prev.error) === null || _c === void 0 ? void 0 : _c.value) === ((_d = next.error) === null || _d === void 0 ? void 0 : _d.value);\n  });\n  useImperativeHandle(ref, function () {\n    return {\n      focus: function () {\n        var _a, _b;\n\n        var errorIndex = findIndex(internalTags, function (_a) {\n          var error = _a.error;\n          return (error === null || error === void 0 ? void 0 : error.key) || (error === null || error === void 0 ? void 0 : error.value);\n        });\n\n        if (errorIndex !== -1) {\n          var refArray = ((_a = internalTags[errorIndex].error) === null || _a === void 0 ? void 0 : _a.key) ? keyInputRefs : valueInputRefs;\n          (_b = refArray.current[errorIndex]) === null || _b === void 0 ? void 0 : _b.focus();\n        }\n      }\n    };\n  }, [internalTags]);\n  var validateAndFire = useCallback(function (newTags) {\n    fireNonCancelableEvent(onChange, {\n      tags: newTags,\n      valid: !validate(newTags, keyDirtyStateRef.current, i18nStrings, allowedCharacterPattern ? new RegExp(allowedCharacterPattern) : undefined).some(function (error) {\n        return error;\n      })\n    });\n  }, [onChange, i18nStrings, allowedCharacterPattern]);\n\n  var onAddButtonClick = function () {\n    validateAndFire(__spreadArray(__spreadArray([], tags, true), [{\n      key: '',\n      value: '',\n      existing: false\n    }], false));\n\n    focusEventRef.current = function () {\n      var _a;\n\n      (_a = keyInputRefs.current[tags.length]) === null || _a === void 0 ? void 0 : _a.focus();\n    };\n  };\n\n  var onRemoveButtonClick = useStableEventHandler(function (_a) {\n    var _b;\n\n    var detail = _a.detail;\n    var existing = tags[detail.itemIndex].existing;\n    validateAndFire(__spreadArray(__spreadArray(__spreadArray([], tags.slice(0, detail.itemIndex), true), existing ? [__assign(__assign({}, tags[detail.itemIndex]), {\n      markedForRemoval: true\n    })] : [], true), tags.slice(detail.itemIndex + 1), true));\n\n    if (existing) {\n      focusEventRef.current = function () {\n        var _a;\n\n        (_a = undoButtonRefs.current[detail.itemIndex]) === null || _a === void 0 ? void 0 : _a.focus();\n      };\n    } else {\n      keyDirtyStateRef.current.splice(detail.itemIndex, 1);\n      (_b = keyInputRefs.current[detail.itemIndex]) === null || _b === void 0 ? void 0 : _b.focus();\n    }\n  });\n  var onKeyChange = useStableEventHandler(function (value, row) {\n    keyDirtyStateRef.current[row] = true;\n    validateAndFire(__spreadArray(__spreadArray(__spreadArray([], tags.slice(0, row), true), [__assign(__assign({}, tags[row]), {\n      key: value\n    })], false), tags.slice(row + 1), true));\n  });\n  var onKeyBlur = useStableEventHandler(function (row) {\n    keyDirtyStateRef.current[row] = true;\n    validateAndFire(__spreadArray([], tags, true));\n  });\n  var onValueChange = useStableEventHandler(function (value, row) {\n    validateAndFire(__spreadArray(__spreadArray(__spreadArray([], tags.slice(0, row), true), [__assign(__assign({}, tags[row]), {\n      value: value\n    })], false), tags.slice(row + 1), true));\n  });\n  var onUndoRemoval = useStableEventHandler(function (row) {\n    validateAndFire(__spreadArray(__spreadArray(__spreadArray([], tags.slice(0, row), true), [__assign(__assign({}, tags[row]), {\n      markedForRemoval: false\n    })], false), tags.slice(row + 1), true));\n\n    focusEventRef.current = function () {\n      var _a;\n\n      (_a = attributeEditorRef.current) === null || _a === void 0 ? void 0 : _a.focusRemoveButton(row);\n    };\n  });\n  var definition = useMemo(function () {\n    return [{\n      label: i18nStrings.keyHeader,\n      control: function (_a, row) {\n        var tag = _a.tag;\n        return React.createElement(TagControl, {\n          row: row,\n          value: tag.key,\n          readOnly: tag.existing,\n          limit: 200,\n          defaultOptions: [],\n          placeholder: i18nStrings.keyPlaceholder,\n          errorText: i18nStrings.keysSuggestionError,\n          loadingText: i18nStrings.keysSuggestionLoading,\n          suggestionText: i18nStrings.keySuggestion,\n          tooManySuggestionText: i18nStrings.tooManyKeysSuggestion,\n          enteredTextLabel: i18nStrings.enteredKeyLabel,\n          onRequest: keysRequest,\n          onChange: onKeyChange,\n          onBlur: onKeyBlur,\n          initialOptionsRef: initialKeyOptionsRef,\n          ref: function (ref) {\n            keyInputRefs.current[row] = ref;\n          }\n        });\n      },\n      errorText: function (_a) {\n        var error = _a.error;\n        return error === null || error === void 0 ? void 0 : error.key;\n      }\n    }, {\n      label: React.createElement(React.Fragment, null, i18nStrings.valueHeader, \" - \", React.createElement(\"i\", null, i18nStrings.optional)),\n      control: function (_a, row) {\n        var _b;\n\n        var tag = _a.tag;\n        return tag.markedForRemoval ? React.createElement(\"div\", {\n          role: \"alert\"\n        }, React.createElement(InternalBox, {\n          margin: {\n            top: 'xxs'\n          }\n        }, i18nStrings.undoPrompt, ' ', React.createElement(UndoButton, {\n          onClick: function () {\n            return onUndoRemoval(row);\n          },\n          ref: function (elem) {\n            undoButtonRefs.current[row] = elem;\n          }\n        }, i18nStrings.undoButton))) : React.createElement(TagControl, {\n          row: row,\n          value: tag.value,\n          readOnly: false,\n          limit: 200,\n          defaultOptions: (_b = tag.valueSuggestionOptions) !== null && _b !== void 0 ? _b : [],\n          placeholder: i18nStrings.valuePlaceholder,\n          errorText: i18nStrings.valuesSuggestionError,\n          loadingText: i18nStrings.valuesSuggestionLoading,\n          suggestionText: i18nStrings.valueSuggestion,\n          tooManySuggestionText: i18nStrings.tooManyValuesSuggestion,\n          enteredTextLabel: i18nStrings.enteredValueLabel,\n          filteringKey: tag.key,\n          onRequest: valuesRequest && function (value) {\n            return valuesRequest(tag.key, value);\n          },\n          onChange: onValueChange,\n          ref: function (ref) {\n            valueInputRefs.current[row] = ref;\n          }\n        });\n      },\n      errorText: function (_a) {\n        var error = _a.error;\n        return error === null || error === void 0 ? void 0 : error.value;\n      }\n    }];\n  }, [i18nStrings, keysRequest, onKeyChange, onKeyBlur, valuesRequest, onValueChange, onUndoRemoval]);\n\n  if (loading) {\n    return React.createElement(\"div\", {\n      className: styles.root,\n      ref: baseComponentProps.__internalRootRef\n    }, React.createElement(InternalStatusIndicator, {\n      className: styles.loading,\n      type: \"loading\"\n    }, i18nStrings.loading));\n  }\n\n  var baseProps = getBaseProps(restProps);\n  return React.createElement(InternalAttributeEditor, __assign({}, baseProps, baseComponentProps, {\n    ref: attributeEditorRef,\n    className: clsx(styles.root, baseProps.className),\n    items: internalTags,\n    isItemRemovable: isItemRemovable,\n    onAddButtonClick: onAddButtonClick,\n    onRemoveButtonClick: onRemoveButtonClick,\n    addButtonText: i18nStrings.addButton,\n    removeButtonText: i18nStrings.removeButton,\n    disableAddButton: remainingTags <= 0,\n    empty: i18nStrings.emptyTags,\n    additionalInfo: React.createElement(\"div\", {\n      \"aria-live\": \"polite\"\n    }, remainingTags < 0 ? React.createElement(FormFieldError, null, (_b = i18nStrings.tagLimitExceeded(tagLimit)) !== null && _b !== void 0 ? _b : '') : remainingTags === 0 ? (_c = i18nStrings.tagLimitReached(tagLimit)) !== null && _c !== void 0 ? _c : '' : i18nStrings.tagLimit(remainingTags)),\n    definition: definition\n  }));\n});\napplyDisplayName(TagEditor, 'TagEditor');\nexport default TagEditor;","map":{"version":3,"sources":["/Users/isingheg/Desktop/projects/amazonforvolunteers-ui/node_modules/@awsui/components-react/tag-editor/index.js"],"names":["__assign","__rest","__spreadArray","React","useCallback","useImperativeHandle","useLayoutEffect","useMemo","useRef","clsx","getBaseProps","fireNonCancelableEvent","useStableEventHandler","InternalAttributeEditor","InternalStatusIndicator","InternalBox","FormFieldError","TagControl","UndoButton","validate","findIndex","useMemoizedArray","styles","applyDisplayName","useBaseComponent","isItemRemovable","_a","tag","markedForRemoval","TagEditor","forwardRef","ref","_b","_c","_d","tags","i18nStrings","_e","loading","_f","tagLimit","allowedCharacterPattern","keysRequest","valuesRequest","onChange","restProps","baseComponentProps","remainingTags","filter","length","attributeEditorRef","keyInputRefs","valueInputRefs","undoButtonRefs","initialKeyOptionsRef","keyDirtyStateRef","focusEventRef","current","apply","undefined","errors","RegExp","internalTags","map","i","error","prev","next","key","value","focus","errorIndex","refArray","validateAndFire","newTags","valid","some","onAddButtonClick","existing","onRemoveButtonClick","detail","itemIndex","slice","splice","onKeyChange","row","onKeyBlur","onValueChange","onUndoRemoval","focusRemoveButton","definition","label","keyHeader","control","createElement","readOnly","limit","defaultOptions","placeholder","keyPlaceholder","errorText","keysSuggestionError","loadingText","keysSuggestionLoading","suggestionText","keySuggestion","tooManySuggestionText","tooManyKeysSuggestion","enteredTextLabel","enteredKeyLabel","onRequest","onBlur","initialOptionsRef","Fragment","valueHeader","optional","role","margin","top","undoPrompt","onClick","elem","undoButton","valueSuggestionOptions","valuePlaceholder","valuesSuggestionError","valuesSuggestionLoading","valueSuggestion","tooManyValuesSuggestion","enteredValueLabel","filteringKey","className","root","__internalRootRef","type","baseProps","items","addButtonText","addButton","removeButtonText","removeButton","disableAddButton","empty","emptyTags","additionalInfo","tagLimitExceeded","tagLimitReached"],"mappings":"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","sourcesContent":["import { __assign, __rest, __spreadArray } from \"tslib\";\nimport React, { useCallback, useImperativeHandle, useLayoutEffect, useMemo, useRef } from 'react';\nimport clsx from 'clsx';\nimport { getBaseProps } from '../internal/base-component';\nimport { fireNonCancelableEvent } from '../internal/events';\nimport { useStableEventHandler } from '../internal/hooks/use-stable-event-handler';\nimport InternalAttributeEditor from '../attribute-editor/internal';\nimport InternalStatusIndicator from '../status-indicator/internal';\nimport InternalBox from '../box/internal';\nimport { FormFieldError } from '../form-field/internal';\nimport { TagControl, UndoButton } from './internal';\nimport { validate } from './validation';\nimport { findIndex, useMemoizedArray } from './utils';\nimport styles from './styles.css.js';\nimport { applyDisplayName } from '../internal/utils/apply-display-name';\nimport useBaseComponent from '../internal/hooks/use-base-component';\nvar isItemRemovable = function (_a) {\n    var tag = _a.tag;\n    return !tag.markedForRemoval;\n};\nvar TagEditor = React.forwardRef(function (_a, ref) {\n    var _b, _c;\n    var _d = _a.tags, tags = _d === void 0 ? [] : _d, i18nStrings = _a.i18nStrings, _e = _a.loading, loading = _e === void 0 ? false : _e, _f = _a.tagLimit, tagLimit = _f === void 0 ? 50 : _f, allowedCharacterPattern = _a.allowedCharacterPattern, keysRequest = _a.keysRequest, valuesRequest = _a.valuesRequest, onChange = _a.onChange, restProps = __rest(_a, [\"tags\", \"i18nStrings\", \"loading\", \"tagLimit\", \"allowedCharacterPattern\", \"keysRequest\", \"valuesRequest\", \"onChange\"]);\n    var baseComponentProps = useBaseComponent('TagEditor');\n    var remainingTags = tagLimit - tags.filter(function (tag) { return !tag.markedForRemoval; }).length;\n    var attributeEditorRef = useRef(null);\n    var keyInputRefs = useRef([]);\n    var valueInputRefs = useRef([]);\n    var undoButtonRefs = useRef([]);\n    var initialKeyOptionsRef = useRef([]);\n    var keyDirtyStateRef = useRef([]);\n    var focusEventRef = useRef();\n    useLayoutEffect(function () {\n        var _a;\n        (_a = focusEventRef.current) === null || _a === void 0 ? void 0 : _a.apply(undefined);\n        focusEventRef.current = undefined;\n    });\n    var errors = validate(tags, keyDirtyStateRef.current, i18nStrings, allowedCharacterPattern ? new RegExp(allowedCharacterPattern) : undefined);\n    var internalTags = useMemoizedArray(tags.map(function (tag, i) { return ({ tag: tag, error: errors[i] }); }), function (prev, next) {\n        var _a, _b, _c, _d;\n        return prev.tag === next.tag && ((_a = prev.error) === null || _a === void 0 ? void 0 : _a.key) === ((_b = next.error) === null || _b === void 0 ? void 0 : _b.key) && ((_c = prev.error) === null || _c === void 0 ? void 0 : _c.value) === ((_d = next.error) === null || _d === void 0 ? void 0 : _d.value);\n    });\n    useImperativeHandle(ref, function () { return ({\n        focus: function () {\n            var _a, _b;\n            var errorIndex = findIndex(internalTags, function (_a) {\n                var error = _a.error;\n                return (error === null || error === void 0 ? void 0 : error.key) || (error === null || error === void 0 ? void 0 : error.value);\n            });\n            if (errorIndex !== -1) {\n                var refArray = ((_a = internalTags[errorIndex].error) === null || _a === void 0 ? void 0 : _a.key) ? keyInputRefs : valueInputRefs;\n                (_b = refArray.current[errorIndex]) === null || _b === void 0 ? void 0 : _b.focus();\n            }\n        }\n    }); }, [internalTags]);\n    var validateAndFire = useCallback(function (newTags) {\n        fireNonCancelableEvent(onChange, {\n            tags: newTags,\n            valid: !validate(newTags, keyDirtyStateRef.current, i18nStrings, allowedCharacterPattern ? new RegExp(allowedCharacterPattern) : undefined).some(function (error) { return error; })\n        });\n    }, [onChange, i18nStrings, allowedCharacterPattern]);\n    var onAddButtonClick = function () {\n        validateAndFire(__spreadArray(__spreadArray([], tags, true), [{ key: '', value: '', existing: false }], false));\n        focusEventRef.current = function () {\n            var _a;\n            (_a = keyInputRefs.current[tags.length]) === null || _a === void 0 ? void 0 : _a.focus();\n        };\n    };\n    var onRemoveButtonClick = useStableEventHandler(function (_a) {\n        var _b;\n        var detail = _a.detail;\n        var existing = tags[detail.itemIndex].existing;\n        validateAndFire(__spreadArray(__spreadArray(__spreadArray([], tags.slice(0, detail.itemIndex), true), (existing ? [__assign(__assign({}, tags[detail.itemIndex]), { markedForRemoval: true })] : []), true), tags.slice(detail.itemIndex + 1), true));\n        if (existing) {\n            focusEventRef.current = function () {\n                var _a;\n                (_a = undoButtonRefs.current[detail.itemIndex]) === null || _a === void 0 ? void 0 : _a.focus();\n            };\n        }\n        else {\n            keyDirtyStateRef.current.splice(detail.itemIndex, 1);\n            (_b = keyInputRefs.current[detail.itemIndex]) === null || _b === void 0 ? void 0 : _b.focus();\n        }\n    });\n    var onKeyChange = useStableEventHandler(function (value, row) {\n        keyDirtyStateRef.current[row] = true;\n        validateAndFire(__spreadArray(__spreadArray(__spreadArray([], tags.slice(0, row), true), [__assign(__assign({}, tags[row]), { key: value })], false), tags.slice(row + 1), true));\n    });\n    var onKeyBlur = useStableEventHandler(function (row) {\n        keyDirtyStateRef.current[row] = true;\n        validateAndFire(__spreadArray([], tags, true));\n    });\n    var onValueChange = useStableEventHandler(function (value, row) {\n        validateAndFire(__spreadArray(__spreadArray(__spreadArray([], tags.slice(0, row), true), [__assign(__assign({}, tags[row]), { value: value })], false), tags.slice(row + 1), true));\n    });\n    var onUndoRemoval = useStableEventHandler(function (row) {\n        validateAndFire(__spreadArray(__spreadArray(__spreadArray([], tags.slice(0, row), true), [__assign(__assign({}, tags[row]), { markedForRemoval: false })], false), tags.slice(row + 1), true));\n        focusEventRef.current = function () {\n            var _a;\n            (_a = attributeEditorRef.current) === null || _a === void 0 ? void 0 : _a.focusRemoveButton(row);\n        };\n    });\n    var definition = useMemo(function () { return [\n        {\n            label: i18nStrings.keyHeader,\n            control: function (_a, row) {\n                var tag = _a.tag;\n                return (React.createElement(TagControl, { row: row, value: tag.key, readOnly: tag.existing, limit: 200, defaultOptions: [], placeholder: i18nStrings.keyPlaceholder, errorText: i18nStrings.keysSuggestionError, loadingText: i18nStrings.keysSuggestionLoading, suggestionText: i18nStrings.keySuggestion, tooManySuggestionText: i18nStrings.tooManyKeysSuggestion, enteredTextLabel: i18nStrings.enteredKeyLabel, onRequest: keysRequest, onChange: onKeyChange, onBlur: onKeyBlur, initialOptionsRef: initialKeyOptionsRef, ref: function (ref) {\n                        keyInputRefs.current[row] = ref;\n                    } }));\n            },\n            errorText: function (_a) {\n                var error = _a.error;\n                return error === null || error === void 0 ? void 0 : error.key;\n            }\n        },\n        {\n            label: (React.createElement(React.Fragment, null,\n                i18nStrings.valueHeader,\n                \" - \",\n                React.createElement(\"i\", null, i18nStrings.optional))),\n            control: function (_a, row) {\n                var _b;\n                var tag = _a.tag;\n                return tag.markedForRemoval ? (React.createElement(\"div\", { role: \"alert\" },\n                    React.createElement(InternalBox, { margin: { top: 'xxs' } },\n                        i18nStrings.undoPrompt,\n                        ' ',\n                        React.createElement(UndoButton, { onClick: function () { return onUndoRemoval(row); }, ref: function (elem) {\n                                undoButtonRefs.current[row] = elem;\n                            } }, i18nStrings.undoButton)))) : (React.createElement(TagControl, { row: row, value: tag.value, readOnly: false, limit: 200, defaultOptions: (_b = tag.valueSuggestionOptions) !== null && _b !== void 0 ? _b : [], placeholder: i18nStrings.valuePlaceholder, errorText: i18nStrings.valuesSuggestionError, loadingText: i18nStrings.valuesSuggestionLoading, suggestionText: i18nStrings.valueSuggestion, tooManySuggestionText: i18nStrings.tooManyValuesSuggestion, enteredTextLabel: i18nStrings.enteredValueLabel, filteringKey: tag.key, onRequest: valuesRequest && (function (value) { return valuesRequest(tag.key, value); }), onChange: onValueChange, ref: function (ref) {\n                        valueInputRefs.current[row] = ref;\n                    } }));\n            },\n            errorText: function (_a) {\n                var error = _a.error;\n                return error === null || error === void 0 ? void 0 : error.value;\n            }\n        },\n    ]; }, [i18nStrings, keysRequest, onKeyChange, onKeyBlur, valuesRequest, onValueChange, onUndoRemoval]);\n    if (loading) {\n        return (React.createElement(\"div\", { className: styles.root, ref: baseComponentProps.__internalRootRef },\n            React.createElement(InternalStatusIndicator, { className: styles.loading, type: \"loading\" }, i18nStrings.loading)));\n    }\n    var baseProps = getBaseProps(restProps);\n    return (React.createElement(InternalAttributeEditor, __assign({}, baseProps, baseComponentProps, { ref: attributeEditorRef, className: clsx(styles.root, baseProps.className), items: internalTags, isItemRemovable: isItemRemovable, onAddButtonClick: onAddButtonClick, onRemoveButtonClick: onRemoveButtonClick, addButtonText: i18nStrings.addButton, removeButtonText: i18nStrings.removeButton, disableAddButton: remainingTags <= 0, empty: i18nStrings.emptyTags, additionalInfo: React.createElement(\"div\", { \"aria-live\": \"polite\" }, remainingTags < 0 ? (React.createElement(FormFieldError, null, (_b = i18nStrings.tagLimitExceeded(tagLimit)) !== null && _b !== void 0 ? _b : '')) : remainingTags === 0 ? ((_c = i18nStrings.tagLimitReached(tagLimit)) !== null && _c !== void 0 ? _c : '') : (i18nStrings.tagLimit(remainingTags))), definition: definition })));\n});\napplyDisplayName(TagEditor, 'TagEditor');\nexport default TagEditor;\n"]},"metadata":{},"sourceType":"module"}