{"ast":null,"code":"import { isInteractive } from '../../internal/components/option/utils/filter-options';\nimport { useEffect, useRef } from 'react';\nimport { createHighlightedOptionHook } from '../../internal/components/options-list/utils/use-highlight-option';\nimport { useOpenState } from '../../internal/components/options-list/utils/use-open-state';\nimport { useMenuKeyboard, useTriggerKeyboard } from '../../internal/components/options-list/utils/use-keyboard';\nimport { useIds } from '../../internal/components/options-list/utils/use-ids';\nimport { connectOptionsByValue } from './connect-options';\nimport useForwardFocus from '../../internal/hooks/forward-focus';\nimport { usePrevious } from '../../internal/hooks/use-previous';\nimport { fireCancelableEvent } from '../../internal/events/index';\nimport { containsOrEqual } from '../../internal/utils/dom';\nvar useHighlightedOption = createHighlightedOptionHook({\n  isInteractive: isInteractive\n});\nexport function useSelect(_a) {\n  var selectedOptions = _a.selectedOptions,\n      updateSelectedOption = _a.updateSelectedOption,\n      options = _a.options,\n      filteringType = _a.filteringType,\n      onBlur = _a.onBlur,\n      onFocus = _a.onFocus,\n      externalRef = _a.externalRef,\n      keepOpen = _a.keepOpen,\n      fireLoadItems = _a.fireLoadItems,\n      setFilteringValue = _a.setFilteringValue;\n  var filterRef = useRef(null);\n  var triggerRef = useRef(null);\n  var menuRef = useRef(null);\n  var hasFilter = filteringType !== 'none';\n  var activeRef = hasFilter ? filterRef : menuRef;\n  var isKeyboard = useRef(false);\n  var isSelectingUsingSpace = useRef(false);\n\n  var __selectedOptions = connectOptionsByValue(options, selectedOptions);\n\n  var _b = useHighlightedOption(options),\n      highlightedOption = _b.highlightedOption,\n      highlightedIndex = _b.highlightedIndex,\n      moveHighlight = _b.moveHighlight,\n      resetHighlight = _b.resetHighlight,\n      setHighlightedIndex = _b.setHighlightedIndex,\n      highlightOption = _b.highlightOption,\n      goHome = _b.goHome,\n      goEnd = _b.goEnd;\n\n  var _c = useOpenState({\n    onOpen: function () {\n      return fireLoadItems('');\n    },\n    onClose: function () {\n      resetHighlight();\n      setFilteringValue('');\n    }\n  }),\n      isOpen = _c.isOpen,\n      openDropdown = _c.openDropdown,\n      closeDropdown = _c.closeDropdown,\n      toggleDropdown = _c.toggleDropdown;\n\n  var focused = useRef(false);\n\n  var handleFocus = function () {\n    if (!focused.current) {\n      fireCancelableEvent(onFocus, {});\n      focused.current = true;\n    }\n  };\n\n  var handleBlur = function (_a) {\n    var detail = _a.detail;\n    var relatedTarget = detail.relatedTarget;\n    var nextFocusedIsTrigger = relatedTarget ? containsOrEqual(triggerRef.current, relatedTarget) : false;\n    var nextFocusedInsideDropdown = relatedTarget ? containsOrEqual(menuRef.current, relatedTarget) || containsOrEqual(filterRef.current, relatedTarget) : false;\n    var nextFocusedInsideComponent = nextFocusedIsTrigger || nextFocusedInsideDropdown;\n    var focusingOut = focused.current && !nextFocusedInsideComponent;\n\n    if (nextFocusedIsTrigger || focusingOut) {\n      closeDropdown();\n    }\n\n    if (focusingOut) {\n      fireCancelableEvent(onBlur, {});\n      focused.current = false;\n    }\n  };\n\n  var hasHighlightedOption = !!highlightedOption;\n  var hasSelectedOption = __selectedOptions.length > 0;\n\n  var _d = useIds({\n    hasHighlightedOption: hasHighlightedOption,\n    hasSelectedOption: hasSelectedOption\n  }),\n      highlightedOptionId = _d.highlightedOptionId,\n      selectedOptionId = _d.selectedOptionId,\n      menuId = _d.menuId;\n\n  var selectOption = function (option) {\n    var _a;\n\n    isSelectingUsingSpace.current = false;\n    var optionToSelect = option || highlightedOption;\n\n    if (!optionToSelect) {\n      return;\n    }\n\n    updateSelectedOption(optionToSelect.option);\n\n    if (!keepOpen) {\n      (_a = triggerRef.current) === null || _a === void 0 ? void 0 : _a.focus();\n      closeDropdown();\n    }\n  };\n\n  var activeKeyDownHandler = useMenuKeyboard({\n    moveHighlight: moveHighlight,\n    selectOption: selectOption,\n    goHome: goHome,\n    goEnd: goEnd,\n    closeDropdown: function () {\n      var _a;\n\n      (_a = triggerRef.current) === null || _a === void 0 ? void 0 : _a.focus();\n      closeDropdown();\n    },\n    isKeyboard: isKeyboard,\n    isSelectingUsingSpace: isSelectingUsingSpace,\n    preventNativeSpace: !hasFilter\n  });\n  var triggerKeyDownHandler = useTriggerKeyboard({\n    openDropdown: openDropdown,\n    goHome: goHome,\n    isKeyboard: isKeyboard\n  });\n\n  var getTriggerProps = function (disabled) {\n    if (disabled === void 0) {\n      disabled = false;\n    }\n\n    var triggerProps = {\n      ref: triggerRef,\n      onFocus: handleFocus,\n      onBlur: handleBlur\n    };\n\n    if (!disabled) {\n      triggerProps.onMouseDown = function (event) {\n        var _a;\n\n        event.preventDefault();\n\n        if (isOpen) {\n          (_a = triggerRef.current) === null || _a === void 0 ? void 0 : _a.focus();\n        }\n\n        toggleDropdown();\n      };\n\n      triggerProps.onKeyDown = triggerKeyDownHandler;\n    }\n\n    if (hasSelectedOption) {\n      triggerProps.ariaLabelledby = selectedOptionId;\n    }\n\n    return triggerProps;\n  };\n\n  var getFilterProps = function () {\n    var _a;\n\n    if (!hasFilter) {\n      return {};\n    }\n\n    return {\n      ref: filterRef,\n      onKeyDown: activeKeyDownHandler,\n      __onBlurWithDetail: handleBlur,\n      onFocus: handleFocus,\n      onChange: function (event) {\n        setFilteringValue(event.detail.value);\n        resetHighlight();\n      },\n      __onDelayedInput: function (event) {\n        fireLoadItems(event.detail.value);\n      },\n      __nativeAttributes: (_a = {\n        'aria-activedescendant': highlightedOptionId\n      }, _a['aria-owns'] = menuId, _a)\n    };\n  };\n\n  var getMenuProps = function () {\n    var menuProps = {\n      id: menuId,\n      ref: menuRef,\n      open: isOpen,\n      onFocus: handleFocus,\n      onBlur: handleBlur,\n      onMouseUp: function (itemIndex) {\n        isKeyboard.current = false;\n\n        if (itemIndex > -1) {\n          selectOption(options[itemIndex]);\n        }\n      },\n      onMouseMove: function (itemIndex) {\n        isKeyboard.current = false;\n\n        if (itemIndex > -1) {\n          setHighlightedIndex(itemIndex);\n        }\n      }\n    };\n\n    if (!hasFilter) {\n      menuProps.onKeyDown = activeKeyDownHandler;\n      menuProps.onBlur = handleBlur;\n      menuProps.onFocus = handleFocus;\n      menuProps.nativeAttributes = {\n        'aria-activedescendant': highlightedOptionId\n      };\n    }\n\n    return menuProps;\n  };\n\n  var getOptionProps = function (option, index) {\n    var _a;\n\n    var highlighted = option === highlightedOption;\n    var selected = __selectedOptions.indexOf(option) > -1;\n    var isNextSelected = __selectedOptions.indexOf(options[index + 1]) > -1;\n    var optionProps = (_a = {\n      key: index,\n      option: option,\n      highlighted: highlighted,\n      selected: selected,\n      isNextSelected: isNextSelected\n    }, _a['data-mouse-target'] = isInteractive(option) ? index : -1, _a);\n\n    if (highlighted) {\n      optionProps.id = highlightedOptionId;\n    }\n\n    return optionProps;\n  };\n\n  var prevOpen = usePrevious(isOpen);\n  useEffect(function () {\n    if (isOpen && !prevOpen && hasSelectedOption) {\n      setHighlightedIndex(options.indexOf(__selectedOptions[0]));\n    }\n  }, [isOpen, __selectedOptions, hasSelectedOption, setHighlightedIndex, options, prevOpen]);\n  useEffect(function () {\n    var _a;\n\n    if (isOpen) {\n      (_a = activeRef.current) === null || _a === void 0 ? void 0 : _a.focus({\n        preventScroll: true\n      });\n    }\n  }, [isOpen, activeRef]);\n  useForwardFocus(externalRef, triggerRef);\n  var announceSelected = !!highlightedOption && __selectedOptions.indexOf(highlightedOption) > -1;\n  return {\n    isOpen: isOpen,\n    highlightedOption: highlightedOption,\n    highlightedIndex: highlightedIndex,\n    getTriggerProps: getTriggerProps,\n    getMenuProps: getMenuProps,\n    getFilterProps: getFilterProps,\n    getOptionProps: getOptionProps,\n    isKeyboard: isKeyboard,\n    highlightOption: highlightOption,\n    selectOption: selectOption,\n    announceSelected: announceSelected\n  };\n}","map":{"version":3,"sources":["/Users/isingheg/Desktop/projects/test-react-amplify/node_modules/@awsui/components-react/select/utils/use-select.js"],"names":["isInteractive","useEffect","useRef","createHighlightedOptionHook","useOpenState","useMenuKeyboard","useTriggerKeyboard","useIds","connectOptionsByValue","useForwardFocus","usePrevious","fireCancelableEvent","containsOrEqual","useHighlightedOption","useSelect","_a","selectedOptions","updateSelectedOption","options","filteringType","onBlur","onFocus","externalRef","keepOpen","fireLoadItems","setFilteringValue","filterRef","triggerRef","menuRef","hasFilter","activeRef","isKeyboard","isSelectingUsingSpace","__selectedOptions","_b","highlightedOption","highlightedIndex","moveHighlight","resetHighlight","setHighlightedIndex","highlightOption","goHome","goEnd","_c","onOpen","onClose","isOpen","openDropdown","closeDropdown","toggleDropdown","focused","handleFocus","current","handleBlur","detail","relatedTarget","nextFocusedIsTrigger","nextFocusedInsideDropdown","nextFocusedInsideComponent","focusingOut","hasHighlightedOption","hasSelectedOption","length","_d","highlightedOptionId","selectedOptionId","menuId","selectOption","option","optionToSelect","focus","activeKeyDownHandler","preventNativeSpace","triggerKeyDownHandler","getTriggerProps","disabled","triggerProps","ref","onMouseDown","event","preventDefault","onKeyDown","ariaLabelledby","getFilterProps","__onBlurWithDetail","onChange","value","__onDelayedInput","__nativeAttributes","getMenuProps","menuProps","id","open","onMouseUp","itemIndex","onMouseMove","nativeAttributes","getOptionProps","index","highlighted","selected","indexOf","isNextSelected","optionProps","key","prevOpen","preventScroll","announceSelected"],"mappings":"AAAA,SAASA,aAAT,QAA8B,uDAA9B;AACA,SAASC,SAAT,EAAoBC,MAApB,QAAkC,OAAlC;AACA,SAASC,2BAAT,QAA4C,mEAA5C;AACA,SAASC,YAAT,QAA6B,6DAA7B;AACA,SAASC,eAAT,EAA0BC,kBAA1B,QAAoD,2DAApD;AACA,SAASC,MAAT,QAAuB,sDAAvB;AACA,SAASC,qBAAT,QAAsC,mBAAtC;AACA,OAAOC,eAAP,MAA4B,oCAA5B;AACA,SAASC,WAAT,QAA4B,mCAA5B;AACA,SAASC,mBAAT,QAAoC,6BAApC;AACA,SAASC,eAAT,QAAgC,0BAAhC;AACA,IAAIC,oBAAoB,GAAGV,2BAA2B,CAAC;AAAEH,EAAAA,aAAa,EAAEA;AAAjB,CAAD,CAAtD;AACA,OAAO,SAASc,SAAT,CAAmBC,EAAnB,EAAuB;AAC1B,MAAIC,eAAe,GAAGD,EAAE,CAACC,eAAzB;AAAA,MAA0CC,oBAAoB,GAAGF,EAAE,CAACE,oBAApE;AAAA,MAA0FC,OAAO,GAAGH,EAAE,CAACG,OAAvG;AAAA,MAAgHC,aAAa,GAAGJ,EAAE,CAACI,aAAnI;AAAA,MAAkJC,MAAM,GAAGL,EAAE,CAACK,MAA9J;AAAA,MAAsKC,OAAO,GAAGN,EAAE,CAACM,OAAnL;AAAA,MAA4LC,WAAW,GAAGP,EAAE,CAACO,WAA7M;AAAA,MAA0NC,QAAQ,GAAGR,EAAE,CAACQ,QAAxO;AAAA,MAAkPC,aAAa,GAAGT,EAAE,CAACS,aAArQ;AAAA,MAAoRC,iBAAiB,GAAGV,EAAE,CAACU,iBAA3S;AACA,MAAIC,SAAS,GAAGxB,MAAM,CAAC,IAAD,CAAtB;AACA,MAAIyB,UAAU,GAAGzB,MAAM,CAAC,IAAD,CAAvB;AACA,MAAI0B,OAAO,GAAG1B,MAAM,CAAC,IAAD,CAApB;AACA,MAAI2B,SAAS,GAAGV,aAAa,KAAK,MAAlC;AACA,MAAIW,SAAS,GAAGD,SAAS,GAAGH,SAAH,GAAeE,OAAxC;AACA,MAAIG,UAAU,GAAG7B,MAAM,CAAC,KAAD,CAAvB;AACA,MAAI8B,qBAAqB,GAAG9B,MAAM,CAAC,KAAD,CAAlC;;AACA,MAAI+B,iBAAiB,GAAGzB,qBAAqB,CAACU,OAAD,EAAUF,eAAV,CAA7C;;AACA,MAAIkB,EAAE,GAAGrB,oBAAoB,CAACK,OAAD,CAA7B;AAAA,MAAwCiB,iBAAiB,GAAGD,EAAE,CAACC,iBAA/D;AAAA,MAAkFC,gBAAgB,GAAGF,EAAE,CAACE,gBAAxG;AAAA,MAA0HC,aAAa,GAAGH,EAAE,CAACG,aAA7I;AAAA,MAA4JC,cAAc,GAAGJ,EAAE,CAACI,cAAhL;AAAA,MAAgMC,mBAAmB,GAAGL,EAAE,CAACK,mBAAzN;AAAA,MAA8OC,eAAe,GAAGN,EAAE,CAACM,eAAnQ;AAAA,MAAoRC,MAAM,GAAGP,EAAE,CAACO,MAAhS;AAAA,MAAwSC,KAAK,GAAGR,EAAE,CAACQ,KAAnT;;AACA,MAAIC,EAAE,GAAGvC,YAAY,CAAC;AAClBwC,IAAAA,MAAM,EAAE,YAAY;AAAE,aAAOpB,aAAa,CAAC,EAAD,CAApB;AAA2B,KAD/B;AAElBqB,IAAAA,OAAO,EAAE,YAAY;AACjBP,MAAAA,cAAc;AACdb,MAAAA,iBAAiB,CAAC,EAAD,CAAjB;AACH;AALiB,GAAD,CAArB;AAAA,MAMIqB,MAAM,GAAGH,EAAE,CAACG,MANhB;AAAA,MAMwBC,YAAY,GAAGJ,EAAE,CAACI,YAN1C;AAAA,MAMwDC,aAAa,GAAGL,EAAE,CAACK,aAN3E;AAAA,MAM0FC,cAAc,GAAGN,EAAE,CAACM,cAN9G;;AAOA,MAAIC,OAAO,GAAGhD,MAAM,CAAC,KAAD,CAApB;;AACA,MAAIiD,WAAW,GAAG,YAAY;AAC1B,QAAI,CAACD,OAAO,CAACE,OAAb,EAAsB;AAClBzC,MAAAA,mBAAmB,CAACU,OAAD,EAAU,EAAV,CAAnB;AACA6B,MAAAA,OAAO,CAACE,OAAR,GAAkB,IAAlB;AACH;AACJ,GALD;;AAMA,MAAIC,UAAU,GAAG,UAAUtC,EAAV,EAAc;AAC3B,QAAIuC,MAAM,GAAGvC,EAAE,CAACuC,MAAhB;AACA,QAAIC,aAAa,GAAGD,MAAM,CAACC,aAA3B;AACA,QAAIC,oBAAoB,GAAGD,aAAa,GAAG3C,eAAe,CAACe,UAAU,CAACyB,OAAZ,EAAqBG,aAArB,CAAlB,GAAwD,KAAhG;AACA,QAAIE,yBAAyB,GAAGF,aAAa,GACvC3C,eAAe,CAACgB,OAAO,CAACwB,OAAT,EAAkBG,aAAlB,CAAf,IAAmD3C,eAAe,CAACc,SAAS,CAAC0B,OAAX,EAAoBG,aAApB,CAD3B,GAEvC,KAFN;AAGA,QAAIG,0BAA0B,GAAGF,oBAAoB,IAAIC,yBAAzD;AACA,QAAIE,WAAW,GAAGT,OAAO,CAACE,OAAR,IAAmB,CAACM,0BAAtC;;AACA,QAAIF,oBAAoB,IAAIG,WAA5B,EAAyC;AACrCX,MAAAA,aAAa;AAChB;;AACD,QAAIW,WAAJ,EAAiB;AACbhD,MAAAA,mBAAmB,CAACS,MAAD,EAAS,EAAT,CAAnB;AACA8B,MAAAA,OAAO,CAACE,OAAR,GAAkB,KAAlB;AACH;AACJ,GAhBD;;AAiBA,MAAIQ,oBAAoB,GAAG,CAAC,CAACzB,iBAA7B;AACA,MAAI0B,iBAAiB,GAAG5B,iBAAiB,CAAC6B,MAAlB,GAA2B,CAAnD;;AACA,MAAIC,EAAE,GAAGxD,MAAM,CAAC;AAAEqD,IAAAA,oBAAoB,EAAEA,oBAAxB;AAA8CC,IAAAA,iBAAiB,EAAEA;AAAjE,GAAD,CAAf;AAAA,MAAuGG,mBAAmB,GAAGD,EAAE,CAACC,mBAAhI;AAAA,MAAqJC,gBAAgB,GAAGF,EAAE,CAACE,gBAA3K;AAAA,MAA6LC,MAAM,GAAGH,EAAE,CAACG,MAAzM;;AACA,MAAIC,YAAY,GAAG,UAAUC,MAAV,EAAkB;AACjC,QAAIrD,EAAJ;;AACAiB,IAAAA,qBAAqB,CAACoB,OAAtB,GAAgC,KAAhC;AACA,QAAIiB,cAAc,GAAGD,MAAM,IAAIjC,iBAA/B;;AACA,QAAI,CAACkC,cAAL,EAAqB;AACjB;AACH;;AACDpD,IAAAA,oBAAoB,CAACoD,cAAc,CAACD,MAAhB,CAApB;;AACA,QAAI,CAAC7C,QAAL,EAAe;AACX,OAACR,EAAE,GAAGY,UAAU,CAACyB,OAAjB,MAA8B,IAA9B,IAAsCrC,EAAE,KAAK,KAAK,CAAlD,GAAsD,KAAK,CAA3D,GAA+DA,EAAE,CAACuD,KAAH,EAA/D;AACAtB,MAAAA,aAAa;AAChB;AACJ,GAZD;;AAaA,MAAIuB,oBAAoB,GAAGlE,eAAe,CAAC;AACvCgC,IAAAA,aAAa,EAAEA,aADwB;AAEvC8B,IAAAA,YAAY,EAAEA,YAFyB;AAGvC1B,IAAAA,MAAM,EAAEA,MAH+B;AAIvCC,IAAAA,KAAK,EAAEA,KAJgC;AAKvCM,IAAAA,aAAa,EAAE,YAAY;AACvB,UAAIjC,EAAJ;;AACA,OAACA,EAAE,GAAGY,UAAU,CAACyB,OAAjB,MAA8B,IAA9B,IAAsCrC,EAAE,KAAK,KAAK,CAAlD,GAAsD,KAAK,CAA3D,GAA+DA,EAAE,CAACuD,KAAH,EAA/D;AACAtB,MAAAA,aAAa;AAChB,KATsC;AAUvCjB,IAAAA,UAAU,EAAEA,UAV2B;AAWvCC,IAAAA,qBAAqB,EAAEA,qBAXgB;AAYvCwC,IAAAA,kBAAkB,EAAE,CAAC3C;AAZkB,GAAD,CAA1C;AAcA,MAAI4C,qBAAqB,GAAGnE,kBAAkB,CAAC;AAAEyC,IAAAA,YAAY,EAAEA,YAAhB;AAA8BN,IAAAA,MAAM,EAAEA,MAAtC;AAA8CV,IAAAA,UAAU,EAAEA;AAA1D,GAAD,CAA9C;;AACA,MAAI2C,eAAe,GAAG,UAAUC,QAAV,EAAoB;AACtC,QAAIA,QAAQ,KAAK,KAAK,CAAtB,EAAyB;AAAEA,MAAAA,QAAQ,GAAG,KAAX;AAAmB;;AAC9C,QAAIC,YAAY,GAAG;AACfC,MAAAA,GAAG,EAAElD,UADU;AAEfN,MAAAA,OAAO,EAAE8B,WAFM;AAGf/B,MAAAA,MAAM,EAAEiC;AAHO,KAAnB;;AAKA,QAAI,CAACsB,QAAL,EAAe;AACXC,MAAAA,YAAY,CAACE,WAAb,GAA2B,UAAUC,KAAV,EAAiB;AACxC,YAAIhE,EAAJ;;AACAgE,QAAAA,KAAK,CAACC,cAAN;;AACA,YAAIlC,MAAJ,EAAY;AACR,WAAC/B,EAAE,GAAGY,UAAU,CAACyB,OAAjB,MAA8B,IAA9B,IAAsCrC,EAAE,KAAK,KAAK,CAAlD,GAAsD,KAAK,CAA3D,GAA+DA,EAAE,CAACuD,KAAH,EAA/D;AACH;;AACDrB,QAAAA,cAAc;AACjB,OAPD;;AAQA2B,MAAAA,YAAY,CAACK,SAAb,GAAyBR,qBAAzB;AACH;;AACD,QAAIZ,iBAAJ,EAAuB;AACnBe,MAAAA,YAAY,CAACM,cAAb,GAA8BjB,gBAA9B;AACH;;AACD,WAAOW,YAAP;AACH,GAtBD;;AAuBA,MAAIO,cAAc,GAAG,YAAY;AAC7B,QAAIpE,EAAJ;;AACA,QAAI,CAACc,SAAL,EAAgB;AACZ,aAAO,EAAP;AACH;;AACD,WAAO;AACHgD,MAAAA,GAAG,EAAEnD,SADF;AAEHuD,MAAAA,SAAS,EAAEV,oBAFR;AAGHa,MAAAA,kBAAkB,EAAE/B,UAHjB;AAIHhC,MAAAA,OAAO,EAAE8B,WAJN;AAKHkC,MAAAA,QAAQ,EAAE,UAAUN,KAAV,EAAiB;AACvBtD,QAAAA,iBAAiB,CAACsD,KAAK,CAACzB,MAAN,CAAagC,KAAd,CAAjB;AACAhD,QAAAA,cAAc;AACjB,OARE;AASHiD,MAAAA,gBAAgB,EAAE,UAAUR,KAAV,EAAiB;AAC/BvD,QAAAA,aAAa,CAACuD,KAAK,CAACzB,MAAN,CAAagC,KAAd,CAAb;AACH,OAXE;AAYHE,MAAAA,kBAAkB,GAAGzE,EAAE,GAAG;AAClB,iCAAyBiD;AADP,OAAL,EAGjBjD,EAAE,CAAC,WAAD,CAAF,GAAkBmD,MAHD,EAIjBnD,EAJc;AAZf,KAAP;AAkBH,GAvBD;;AAwBA,MAAI0E,YAAY,GAAG,YAAY;AAC3B,QAAIC,SAAS,GAAG;AACZC,MAAAA,EAAE,EAAEzB,MADQ;AAEZW,MAAAA,GAAG,EAAEjD,OAFO;AAGZgE,MAAAA,IAAI,EAAE9C,MAHM;AAIZzB,MAAAA,OAAO,EAAE8B,WAJG;AAKZ/B,MAAAA,MAAM,EAAEiC,UALI;AAMZwC,MAAAA,SAAS,EAAE,UAAUC,SAAV,EAAqB;AAC5B/D,QAAAA,UAAU,CAACqB,OAAX,GAAqB,KAArB;;AACA,YAAI0C,SAAS,GAAG,CAAC,CAAjB,EAAoB;AAChB3B,UAAAA,YAAY,CAACjD,OAAO,CAAC4E,SAAD,CAAR,CAAZ;AACH;AACJ,OAXW;AAYZC,MAAAA,WAAW,EAAE,UAAUD,SAAV,EAAqB;AAC9B/D,QAAAA,UAAU,CAACqB,OAAX,GAAqB,KAArB;;AACA,YAAI0C,SAAS,GAAG,CAAC,CAAjB,EAAoB;AAChBvD,UAAAA,mBAAmB,CAACuD,SAAD,CAAnB;AACH;AACJ;AAjBW,KAAhB;;AAmBA,QAAI,CAACjE,SAAL,EAAgB;AACZ6D,MAAAA,SAAS,CAACT,SAAV,GAAsBV,oBAAtB;AACAmB,MAAAA,SAAS,CAACtE,MAAV,GAAmBiC,UAAnB;AACAqC,MAAAA,SAAS,CAACrE,OAAV,GAAoB8B,WAApB;AACAuC,MAAAA,SAAS,CAACM,gBAAV,GAA6B;AACzB,iCAAyBhC;AADA,OAA7B;AAGH;;AACD,WAAO0B,SAAP;AACH,GA7BD;;AA8BA,MAAIO,cAAc,GAAG,UAAU7B,MAAV,EAAkB8B,KAAlB,EAAyB;AAC1C,QAAInF,EAAJ;;AACA,QAAIoF,WAAW,GAAG/B,MAAM,KAAKjC,iBAA7B;AACA,QAAIiE,QAAQ,GAAGnE,iBAAiB,CAACoE,OAAlB,CAA0BjC,MAA1B,IAAoC,CAAC,CAApD;AACA,QAAIkC,cAAc,GAAGrE,iBAAiB,CAACoE,OAAlB,CAA0BnF,OAAO,CAACgF,KAAK,GAAG,CAAT,CAAjC,IAAgD,CAAC,CAAtE;AACA,QAAIK,WAAW,IAAIxF,EAAE,GAAG;AAChByF,MAAAA,GAAG,EAAEN,KADW;AAEhB9B,MAAAA,MAAM,EAAEA,MAFQ;AAGhB+B,MAAAA,WAAW,EAAEA,WAHG;AAIhBC,MAAAA,QAAQ,EAAEA,QAJM;AAKhBE,MAAAA,cAAc,EAAEA;AALA,KAAL,EAOfvF,EAAE,CAAC,mBAAD,CAAF,GAA0Bf,aAAa,CAACoE,MAAD,CAAb,GAAwB8B,KAAxB,GAAgC,CAAC,CAP5C,EAQfnF,EARW,CAAf;;AASA,QAAIoF,WAAJ,EAAiB;AACbI,MAAAA,WAAW,CAACZ,EAAZ,GAAiB3B,mBAAjB;AACH;;AACD,WAAOuC,WAAP;AACH,GAlBD;;AAmBA,MAAIE,QAAQ,GAAG/F,WAAW,CAACoC,MAAD,CAA1B;AACA7C,EAAAA,SAAS,CAAC,YAAY;AAClB,QAAI6C,MAAM,IAAI,CAAC2D,QAAX,IAAuB5C,iBAA3B,EAA8C;AAC1CtB,MAAAA,mBAAmB,CAACrB,OAAO,CAACmF,OAAR,CAAgBpE,iBAAiB,CAAC,CAAD,CAAjC,CAAD,CAAnB;AACH;AACJ,GAJQ,EAIN,CAACa,MAAD,EAASb,iBAAT,EAA4B4B,iBAA5B,EAA+CtB,mBAA/C,EAAoErB,OAApE,EAA6EuF,QAA7E,CAJM,CAAT;AAKAxG,EAAAA,SAAS,CAAC,YAAY;AAClB,QAAIc,EAAJ;;AACA,QAAI+B,MAAJ,EAAY;AACR,OAAC/B,EAAE,GAAGe,SAAS,CAACsB,OAAhB,MAA6B,IAA7B,IAAqCrC,EAAE,KAAK,KAAK,CAAjD,GAAqD,KAAK,CAA1D,GAA8DA,EAAE,CAACuD,KAAH,CAAS;AAAEoC,QAAAA,aAAa,EAAE;AAAjB,OAAT,CAA9D;AACH;AACJ,GALQ,EAKN,CAAC5D,MAAD,EAAShB,SAAT,CALM,CAAT;AAMArB,EAAAA,eAAe,CAACa,WAAD,EAAcK,UAAd,CAAf;AACA,MAAIgF,gBAAgB,GAAG,CAAC,CAACxE,iBAAF,IAAuBF,iBAAiB,CAACoE,OAAlB,CAA0BlE,iBAA1B,IAA+C,CAAC,CAA9F;AACA,SAAO;AACHW,IAAAA,MAAM,EAAEA,MADL;AAEHX,IAAAA,iBAAiB,EAAEA,iBAFhB;AAGHC,IAAAA,gBAAgB,EAAEA,gBAHf;AAIHsC,IAAAA,eAAe,EAAEA,eAJd;AAKHe,IAAAA,YAAY,EAAEA,YALX;AAMHN,IAAAA,cAAc,EAAEA,cANb;AAOHc,IAAAA,cAAc,EAAEA,cAPb;AAQHlE,IAAAA,UAAU,EAAEA,UART;AASHS,IAAAA,eAAe,EAAEA,eATd;AAUH2B,IAAAA,YAAY,EAAEA,YAVX;AAWHwC,IAAAA,gBAAgB,EAAEA;AAXf,GAAP;AAaH","sourcesContent":["import { isInteractive } from '../../internal/components/option/utils/filter-options';\nimport { useEffect, useRef } from 'react';\nimport { createHighlightedOptionHook } from '../../internal/components/options-list/utils/use-highlight-option';\nimport { useOpenState } from '../../internal/components/options-list/utils/use-open-state';\nimport { useMenuKeyboard, useTriggerKeyboard } from '../../internal/components/options-list/utils/use-keyboard';\nimport { useIds } from '../../internal/components/options-list/utils/use-ids';\nimport { connectOptionsByValue } from './connect-options';\nimport useForwardFocus from '../../internal/hooks/forward-focus';\nimport { usePrevious } from '../../internal/hooks/use-previous';\nimport { fireCancelableEvent } from '../../internal/events/index';\nimport { containsOrEqual } from '../../internal/utils/dom';\nvar useHighlightedOption = createHighlightedOptionHook({ isInteractive: isInteractive });\nexport function useSelect(_a) {\n    var selectedOptions = _a.selectedOptions, updateSelectedOption = _a.updateSelectedOption, options = _a.options, filteringType = _a.filteringType, onBlur = _a.onBlur, onFocus = _a.onFocus, externalRef = _a.externalRef, keepOpen = _a.keepOpen, fireLoadItems = _a.fireLoadItems, setFilteringValue = _a.setFilteringValue;\n    var filterRef = useRef(null);\n    var triggerRef = useRef(null);\n    var menuRef = useRef(null);\n    var hasFilter = filteringType !== 'none';\n    var activeRef = hasFilter ? filterRef : menuRef;\n    var isKeyboard = useRef(false);\n    var isSelectingUsingSpace = useRef(false);\n    var __selectedOptions = connectOptionsByValue(options, selectedOptions);\n    var _b = useHighlightedOption(options), highlightedOption = _b.highlightedOption, highlightedIndex = _b.highlightedIndex, moveHighlight = _b.moveHighlight, resetHighlight = _b.resetHighlight, setHighlightedIndex = _b.setHighlightedIndex, highlightOption = _b.highlightOption, goHome = _b.goHome, goEnd = _b.goEnd;\n    var _c = useOpenState({\n        onOpen: function () { return fireLoadItems(''); },\n        onClose: function () {\n            resetHighlight();\n            setFilteringValue('');\n        }\n    }), isOpen = _c.isOpen, openDropdown = _c.openDropdown, closeDropdown = _c.closeDropdown, toggleDropdown = _c.toggleDropdown;\n    var focused = useRef(false);\n    var handleFocus = function () {\n        if (!focused.current) {\n            fireCancelableEvent(onFocus, {});\n            focused.current = true;\n        }\n    };\n    var handleBlur = function (_a) {\n        var detail = _a.detail;\n        var relatedTarget = detail.relatedTarget;\n        var nextFocusedIsTrigger = relatedTarget ? containsOrEqual(triggerRef.current, relatedTarget) : false;\n        var nextFocusedInsideDropdown = relatedTarget\n            ? containsOrEqual(menuRef.current, relatedTarget) || containsOrEqual(filterRef.current, relatedTarget)\n            : false;\n        var nextFocusedInsideComponent = nextFocusedIsTrigger || nextFocusedInsideDropdown;\n        var focusingOut = focused.current && !nextFocusedInsideComponent;\n        if (nextFocusedIsTrigger || focusingOut) {\n            closeDropdown();\n        }\n        if (focusingOut) {\n            fireCancelableEvent(onBlur, {});\n            focused.current = false;\n        }\n    };\n    var hasHighlightedOption = !!highlightedOption;\n    var hasSelectedOption = __selectedOptions.length > 0;\n    var _d = useIds({ hasHighlightedOption: hasHighlightedOption, hasSelectedOption: hasSelectedOption }), highlightedOptionId = _d.highlightedOptionId, selectedOptionId = _d.selectedOptionId, menuId = _d.menuId;\n    var selectOption = function (option) {\n        var _a;\n        isSelectingUsingSpace.current = false;\n        var optionToSelect = option || highlightedOption;\n        if (!optionToSelect) {\n            return;\n        }\n        updateSelectedOption(optionToSelect.option);\n        if (!keepOpen) {\n            (_a = triggerRef.current) === null || _a === void 0 ? void 0 : _a.focus();\n            closeDropdown();\n        }\n    };\n    var activeKeyDownHandler = useMenuKeyboard({\n        moveHighlight: moveHighlight,\n        selectOption: selectOption,\n        goHome: goHome,\n        goEnd: goEnd,\n        closeDropdown: function () {\n            var _a;\n            (_a = triggerRef.current) === null || _a === void 0 ? void 0 : _a.focus();\n            closeDropdown();\n        },\n        isKeyboard: isKeyboard,\n        isSelectingUsingSpace: isSelectingUsingSpace,\n        preventNativeSpace: !hasFilter\n    });\n    var triggerKeyDownHandler = useTriggerKeyboard({ openDropdown: openDropdown, goHome: goHome, isKeyboard: isKeyboard });\n    var getTriggerProps = function (disabled) {\n        if (disabled === void 0) { disabled = false; }\n        var triggerProps = {\n            ref: triggerRef,\n            onFocus: handleFocus,\n            onBlur: handleBlur\n        };\n        if (!disabled) {\n            triggerProps.onMouseDown = function (event) {\n                var _a;\n                event.preventDefault();\n                if (isOpen) {\n                    (_a = triggerRef.current) === null || _a === void 0 ? void 0 : _a.focus();\n                }\n                toggleDropdown();\n            };\n            triggerProps.onKeyDown = triggerKeyDownHandler;\n        }\n        if (hasSelectedOption) {\n            triggerProps.ariaLabelledby = selectedOptionId;\n        }\n        return triggerProps;\n    };\n    var getFilterProps = function () {\n        var _a;\n        if (!hasFilter) {\n            return {};\n        }\n        return {\n            ref: filterRef,\n            onKeyDown: activeKeyDownHandler,\n            __onBlurWithDetail: handleBlur,\n            onFocus: handleFocus,\n            onChange: function (event) {\n                setFilteringValue(event.detail.value);\n                resetHighlight();\n            },\n            __onDelayedInput: function (event) {\n                fireLoadItems(event.detail.value);\n            },\n            __nativeAttributes: (_a = {\n                    'aria-activedescendant': highlightedOptionId\n                },\n                _a['aria-owns'] = menuId,\n                _a)\n        };\n    };\n    var getMenuProps = function () {\n        var menuProps = {\n            id: menuId,\n            ref: menuRef,\n            open: isOpen,\n            onFocus: handleFocus,\n            onBlur: handleBlur,\n            onMouseUp: function (itemIndex) {\n                isKeyboard.current = false;\n                if (itemIndex > -1) {\n                    selectOption(options[itemIndex]);\n                }\n            },\n            onMouseMove: function (itemIndex) {\n                isKeyboard.current = false;\n                if (itemIndex > -1) {\n                    setHighlightedIndex(itemIndex);\n                }\n            }\n        };\n        if (!hasFilter) {\n            menuProps.onKeyDown = activeKeyDownHandler;\n            menuProps.onBlur = handleBlur;\n            menuProps.onFocus = handleFocus;\n            menuProps.nativeAttributes = {\n                'aria-activedescendant': highlightedOptionId\n            };\n        }\n        return menuProps;\n    };\n    var getOptionProps = function (option, index) {\n        var _a;\n        var highlighted = option === highlightedOption;\n        var selected = __selectedOptions.indexOf(option) > -1;\n        var isNextSelected = __selectedOptions.indexOf(options[index + 1]) > -1;\n        var optionProps = (_a = {\n                key: index,\n                option: option,\n                highlighted: highlighted,\n                selected: selected,\n                isNextSelected: isNextSelected\n            },\n            _a['data-mouse-target'] = isInteractive(option) ? index : -1,\n            _a);\n        if (highlighted) {\n            optionProps.id = highlightedOptionId;\n        }\n        return optionProps;\n    };\n    var prevOpen = usePrevious(isOpen);\n    useEffect(function () {\n        if (isOpen && !prevOpen && hasSelectedOption) {\n            setHighlightedIndex(options.indexOf(__selectedOptions[0]));\n        }\n    }, [isOpen, __selectedOptions, hasSelectedOption, setHighlightedIndex, options, prevOpen]);\n    useEffect(function () {\n        var _a;\n        if (isOpen) {\n            (_a = activeRef.current) === null || _a === void 0 ? void 0 : _a.focus({ preventScroll: true });\n        }\n    }, [isOpen, activeRef]);\n    useForwardFocus(externalRef, triggerRef);\n    var announceSelected = !!highlightedOption && __selectedOptions.indexOf(highlightedOption) > -1;\n    return {\n        isOpen: isOpen,\n        highlightedOption: highlightedOption,\n        highlightedIndex: highlightedIndex,\n        getTriggerProps: getTriggerProps,\n        getMenuProps: getMenuProps,\n        getFilterProps: getFilterProps,\n        getOptionProps: getOptionProps,\n        isKeyboard: isKeyboard,\n        highlightOption: highlightOption,\n        selectOption: selectOption,\n        announceSelected: announceSelected\n    };\n}\n"]},"metadata":{},"sourceType":"module"}