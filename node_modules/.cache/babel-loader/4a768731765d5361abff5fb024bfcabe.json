{"ast":null,"code":"import { __assign } from \"tslib\";\nimport React, { useState, useRef } from 'react';\nimport clsx from 'clsx';\nimport InternalSelect from '../select/internal';\nimport InternalSpaceBetween from '../space-between/internal';\nimport InternalAutosuggest from '../autosuggest/internal';\nimport InternalPopover from '../popover/internal';\nimport { InternalButton } from '../button/internal';\nimport { useUniqueId } from '../internal/hooks/use-unique-id/index';\nimport styles from './styles.css.js';\nimport { useLoadItems } from './use-load-items';\nimport { getAllowedOperators, getPropertyOptions, getPropertyByKey, operatorToDescription, getPropertySuggestions } from './controller';\n\nvar EditingFields = function (_a) {\n  var _b;\n\n  var temporaryToken = _a.temporaryToken,\n      setTemporaryToken = _a.setTemporaryToken,\n      asyncProps = _a.asyncProps,\n      asyncProperties = _a.asyncProperties,\n      filteringProperties = _a.filteringProperties,\n      filteringOptions = _a.filteringOptions,\n      onLoadItems = _a.onLoadItems,\n      customGroupsText = _a.customGroupsText,\n      i18nStrings = _a.i18nStrings,\n      disableFreeTextFiltering = _a.disableFreeTextFiltering;\n  var fields = [];\n  var property = temporaryToken.propertyKey !== undefined ? getPropertyByKey(filteringProperties, temporaryToken.propertyKey) : undefined;\n  var propertySelectHandlers = useLoadItems(onLoadItems);\n  var asyncPropertySelectProps = asyncProperties ? __assign(__assign({}, asyncProps), propertySelectHandlers) : {};\n  var propertyOptions = getPropertySuggestions(filteringProperties, customGroupsText, i18nStrings, function (_a) {\n    var propertyLabel = _a.propertyLabel,\n        key = _a.key;\n    return {\n      value: key,\n      label: propertyLabel,\n      dontCloseOnSelect: true\n    };\n  });\n  var allPropertiesOption = {\n    label: i18nStrings.allPropertiesLabel,\n    value: undefined\n  };\n\n  if (!disableFreeTextFiltering) {\n    propertyOptions.unshift(allPropertiesOption);\n  }\n\n  var propertyControlId = useUniqueId('property');\n  var propertySelect = React.createElement(InternalSelect, __assign({\n    controlId: propertyControlId,\n    options: propertyOptions,\n    selectedOption: property ? {\n      value: temporaryToken.propertyKey,\n      label: property.propertyLabel\n    } : allPropertiesOption,\n    onChange: function (e) {\n      var _a;\n\n      var filteringProperty = ((_a = e.detail.selectedOption) === null || _a === void 0 ? void 0 : _a.value) ? filteringProperties.reduce(function (acc, property) {\n        return property.key === e.detail.selectedOption.value ? property : acc;\n      }, undefined) : undefined;\n      var allowedOperators = filteringProperty ? getAllowedOperators(filteringProperty) : freeTextOperators;\n      var operator = temporaryToken.operator;\n\n      if (temporaryToken.operator && allowedOperators.indexOf(temporaryToken.operator) === -1) {\n        operator = allowedOperators[0];\n      }\n\n      setTemporaryToken(__assign(__assign({}, temporaryToken), {\n        operator: operator,\n        propertyKey: e.detail.selectedOption.value\n      }));\n    }\n  }, asyncPropertySelectProps));\n  fields.push({\n    text: i18nStrings.propertyText,\n    className: styles['property-selector'],\n    control: propertySelect,\n    controlId: propertyControlId\n  });\n  var operatorText = temporaryToken.operator;\n  var freeTextOperators = [':', '!:'];\n  var operatorOptions = (property ? getAllowedOperators(property) : freeTextOperators).map(function (operator) {\n    return {\n      value: operator,\n      label: operator,\n      description: operatorToDescription(operator, i18nStrings)\n    };\n  });\n  var operatorControlId = useUniqueId('operator');\n  var operatorSelect = temporaryToken && React.createElement(InternalSelect, {\n    controlId: operatorControlId,\n    options: operatorOptions,\n    triggerVariant: \"option\",\n    selectedOption: operatorText ? {\n      value: operatorText,\n      label: operatorText,\n      description: operatorToDescription(operatorText, i18nStrings)\n    } : null,\n    onChange: function (e) {\n      e.detail.selectedOption.value && setTemporaryToken(__assign(__assign({}, temporaryToken), {\n        operator: e.detail.selectedOption.value\n      }));\n    },\n    disabled: !temporaryToken\n  });\n  fields.push({\n    text: i18nStrings.operatorText,\n    className: styles['operator-selector'],\n    control: operatorSelect,\n    controlId: operatorControlId\n  });\n  var valueOptions = property ? (_b = getPropertyOptions(property, filteringOptions)) === null || _b === void 0 ? void 0 : _b.map(function (_a) {\n    var value = _a.value;\n    return {\n      value: value\n    };\n  }) : [];\n  var valueAutosuggestHandlers = useLoadItems(onLoadItems, '', property);\n  var asyncValueAutosuggesProps = temporaryToken.propertyKey ? __assign(__assign({}, valueAutosuggestHandlers), asyncProps) : {\n    empty: asyncProps.empty\n  };\n  var valueControlId = useUniqueId('value');\n  var valueAutosuggest = temporaryToken && React.createElement(InternalAutosuggest, __assign({\n    controlId: valueControlId,\n    enteredTextLabel: i18nStrings.enteredTextLabel,\n    value: temporaryToken.value || '',\n    onChange: function (e) {\n      setTemporaryToken(__assign(__assign({}, temporaryToken), {\n        value: e.detail.value\n      }));\n    },\n    disabled: !operatorText,\n    options: valueOptions\n  }, asyncValueAutosuggesProps, {\n    virtualScroll: true\n  }));\n  fields.push({\n    text: i18nStrings.valueText,\n    className: styles['value-selector'],\n    control: valueAutosuggest,\n    controlId: valueControlId\n  });\n  return React.createElement(\"div\", null, React.createElement(InternalSpaceBetween, {\n    size: \"l\"\n  }, fields.map(function (_a) {\n    var text = _a.text,\n        control = _a.control,\n        className = _a.className,\n        controlId = _a.controlId;\n    return React.createElement(\"div\", {\n      className: clsx(styles['token-editor-line'], className),\n      key: text\n    }, React.createElement(\"label\", {\n      className: styles['token-editor-label'],\n      htmlFor: controlId\n    }, text), React.createElement(\"div\", {\n      className: styles['token-editor-field']\n    }, control));\n  })));\n};\n\nexport var TokenEditor = function (props) {\n  var token = props.token,\n      triggerComponent = props.triggerComponent,\n      setToken = props.setToken,\n      i18nStrings = props.i18nStrings,\n      expandToViewport = props.expandToViewport;\n\n  var _a = useState(token),\n      temporaryToken = _a[0],\n      setTemporaryToken = _a[1];\n\n  var popoverRef = useRef(null);\n\n  var closePopover = function () {\n    popoverRef.current && popoverRef.current.dismissPopover();\n  };\n\n  return React.createElement(InternalPopover, {\n    ref: popoverRef,\n    className: styles['token-label'],\n    triggerType: \"text\",\n    header: i18nStrings.editTokenHeader,\n    size: \"large\",\n    position: \"right\",\n    dismissAriaLabel: i18nStrings.dismissAriaLabel,\n    __onOpen: function () {\n      return setTemporaryToken(token);\n    },\n    renderWithPortal: expandToViewport,\n    content: React.createElement(\"div\", {\n      className: styles['token-editor']\n    }, React.createElement(EditingFields, __assign({}, props, {\n      temporaryToken: temporaryToken,\n      setTemporaryToken: setTemporaryToken\n    })), React.createElement(\"div\", {\n      className: styles['token-editor-actions']\n    }, React.createElement(InternalButton, {\n      variant: \"link\",\n      className: styles['token-editor-cancel'],\n      onClick: closePopover\n    }, i18nStrings.cancelActionText), React.createElement(InternalButton, {\n      className: styles['token-editor-submit'],\n      onClick: function () {\n        setToken(temporaryToken);\n        closePopover();\n      }\n    }, i18nStrings.applyActionText)))\n  }, triggerComponent);\n};","map":{"version":3,"sources":["/Users/isingheg/Desktop/projects/amazonforvolunteers-ui/node_modules/@awsui/components-react/property-filter/token-editor.js"],"names":["__assign","React","useState","useRef","clsx","InternalSelect","InternalSpaceBetween","InternalAutosuggest","InternalPopover","InternalButton","useUniqueId","styles","useLoadItems","getAllowedOperators","getPropertyOptions","getPropertyByKey","operatorToDescription","getPropertySuggestions","EditingFields","_a","_b","temporaryToken","setTemporaryToken","asyncProps","asyncProperties","filteringProperties","filteringOptions","onLoadItems","customGroupsText","i18nStrings","disableFreeTextFiltering","fields","property","propertyKey","undefined","propertySelectHandlers","asyncPropertySelectProps","propertyOptions","propertyLabel","key","value","label","dontCloseOnSelect","allPropertiesOption","allPropertiesLabel","unshift","propertyControlId","propertySelect","createElement","controlId","options","selectedOption","onChange","e","filteringProperty","detail","reduce","acc","allowedOperators","freeTextOperators","operator","indexOf","push","text","propertyText","className","control","operatorText","operatorOptions","map","description","operatorControlId","operatorSelect","triggerVariant","disabled","valueOptions","valueAutosuggestHandlers","asyncValueAutosuggesProps","empty","valueControlId","valueAutosuggest","enteredTextLabel","virtualScroll","valueText","size","htmlFor","TokenEditor","props","token","triggerComponent","setToken","expandToViewport","popoverRef","closePopover","current","dismissPopover","ref","triggerType","header","editTokenHeader","position","dismissAriaLabel","__onOpen","renderWithPortal","content","variant","onClick","cancelActionText","applyActionText"],"mappings":"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","sourcesContent":["import { __assign } from \"tslib\";\nimport React, { useState, useRef } from 'react';\nimport clsx from 'clsx';\nimport InternalSelect from '../select/internal';\nimport InternalSpaceBetween from '../space-between/internal';\nimport InternalAutosuggest from '../autosuggest/internal';\nimport InternalPopover from '../popover/internal';\nimport { InternalButton } from '../button/internal';\nimport { useUniqueId } from '../internal/hooks/use-unique-id/index';\nimport styles from './styles.css.js';\nimport { useLoadItems } from './use-load-items';\nimport { getAllowedOperators, getPropertyOptions, getPropertyByKey, operatorToDescription, getPropertySuggestions, } from './controller';\nvar EditingFields = function (_a) {\n    var _b;\n    var temporaryToken = _a.temporaryToken, setTemporaryToken = _a.setTemporaryToken, asyncProps = _a.asyncProps, asyncProperties = _a.asyncProperties, filteringProperties = _a.filteringProperties, filteringOptions = _a.filteringOptions, onLoadItems = _a.onLoadItems, customGroupsText = _a.customGroupsText, i18nStrings = _a.i18nStrings, disableFreeTextFiltering = _a.disableFreeTextFiltering;\n    var fields = [];\n    var property = temporaryToken.propertyKey !== undefined\n        ? getPropertyByKey(filteringProperties, temporaryToken.propertyKey)\n        : undefined;\n    var propertySelectHandlers = useLoadItems(onLoadItems);\n    var asyncPropertySelectProps = asyncProperties\n        ? __assign(__assign({}, asyncProps), propertySelectHandlers) : {};\n    var propertyOptions = getPropertySuggestions(filteringProperties, customGroupsText, i18nStrings, function (_a) {\n        var propertyLabel = _a.propertyLabel, key = _a.key;\n        return ({\n            value: key,\n            label: propertyLabel,\n            dontCloseOnSelect: true\n        });\n    });\n    var allPropertiesOption = {\n        label: i18nStrings.allPropertiesLabel,\n        value: undefined\n    };\n    if (!disableFreeTextFiltering) {\n        propertyOptions.unshift(allPropertiesOption);\n    }\n    var propertyControlId = useUniqueId('property');\n    var propertySelect = (React.createElement(InternalSelect, __assign({ controlId: propertyControlId, options: propertyOptions, selectedOption: property\n            ? {\n                value: temporaryToken.propertyKey,\n                label: property.propertyLabel\n            }\n            : allPropertiesOption, onChange: function (e) {\n            var _a;\n            var filteringProperty = ((_a = e.detail.selectedOption) === null || _a === void 0 ? void 0 : _a.value)\n                ? filteringProperties.reduce(function (acc, property) { return (property.key === e.detail.selectedOption.value ? property : acc); }, undefined)\n                : undefined;\n            var allowedOperators = filteringProperty\n                ? getAllowedOperators(filteringProperty)\n                : freeTextOperators;\n            var operator = temporaryToken.operator;\n            if (temporaryToken.operator && allowedOperators.indexOf(temporaryToken.operator) === -1) {\n                operator = allowedOperators[0];\n            }\n            setTemporaryToken(__assign(__assign({}, temporaryToken), { operator: operator, propertyKey: e.detail.selectedOption.value }));\n        } }, asyncPropertySelectProps)));\n    fields.push({\n        text: i18nStrings.propertyText,\n        className: styles['property-selector'],\n        control: propertySelect,\n        controlId: propertyControlId\n    });\n    var operatorText = temporaryToken.operator;\n    var freeTextOperators = [':', '!:'];\n    var operatorOptions = (property ? getAllowedOperators(property) : freeTextOperators).map(function (operator) { return ({\n        value: operator,\n        label: operator,\n        description: operatorToDescription(operator, i18nStrings)\n    }); });\n    var operatorControlId = useUniqueId('operator');\n    var operatorSelect = temporaryToken && (React.createElement(InternalSelect, { controlId: operatorControlId, options: operatorOptions, triggerVariant: \"option\", selectedOption: operatorText\n            ? {\n                value: operatorText,\n                label: operatorText,\n                description: operatorToDescription(operatorText, i18nStrings)\n            }\n            : null, onChange: function (e) {\n            e.detail.selectedOption.value &&\n                setTemporaryToken(__assign(__assign({}, temporaryToken), { operator: e.detail.selectedOption.value }));\n        }, disabled: !temporaryToken }));\n    fields.push({\n        text: i18nStrings.operatorText,\n        className: styles['operator-selector'],\n        control: operatorSelect,\n        controlId: operatorControlId\n    });\n    var valueOptions = property ? (_b = getPropertyOptions(property, filteringOptions)) === null || _b === void 0 ? void 0 : _b.map(function (_a) {\n        var value = _a.value;\n        return ({ value: value });\n    }) : [];\n    var valueAutosuggestHandlers = useLoadItems(onLoadItems, '', property);\n    var asyncValueAutosuggesProps = temporaryToken.propertyKey\n        ? __assign(__assign({}, valueAutosuggestHandlers), asyncProps) : { empty: asyncProps.empty };\n    var valueControlId = useUniqueId('value');\n    var valueAutosuggest = temporaryToken && (React.createElement(InternalAutosuggest, __assign({ controlId: valueControlId, enteredTextLabel: i18nStrings.enteredTextLabel, value: temporaryToken.value || '', onChange: function (e) {\n            setTemporaryToken(__assign(__assign({}, temporaryToken), { value: e.detail.value }));\n        }, disabled: !operatorText, options: valueOptions }, asyncValueAutosuggesProps, { virtualScroll: true })));\n    fields.push({\n        text: i18nStrings.valueText,\n        className: styles['value-selector'],\n        control: valueAutosuggest,\n        controlId: valueControlId\n    });\n    return (React.createElement(\"div\", null,\n        React.createElement(InternalSpaceBetween, { size: \"l\" }, fields.map(function (_a) {\n            var text = _a.text, control = _a.control, className = _a.className, controlId = _a.controlId;\n            return (React.createElement(\"div\", { className: clsx(styles['token-editor-line'], className), key: text },\n                React.createElement(\"label\", { className: styles['token-editor-label'], htmlFor: controlId }, text),\n                React.createElement(\"div\", { className: styles['token-editor-field'] }, control)));\n        }))));\n};\nexport var TokenEditor = function (props) {\n    var token = props.token, triggerComponent = props.triggerComponent, setToken = props.setToken, i18nStrings = props.i18nStrings, expandToViewport = props.expandToViewport;\n    var _a = useState(token), temporaryToken = _a[0], setTemporaryToken = _a[1];\n    var popoverRef = useRef(null);\n    var closePopover = function () {\n        popoverRef.current && popoverRef.current.dismissPopover();\n    };\n    return (React.createElement(InternalPopover, { ref: popoverRef, className: styles['token-label'], triggerType: \"text\", header: i18nStrings.editTokenHeader, size: \"large\", position: \"right\", dismissAriaLabel: i18nStrings.dismissAriaLabel, __onOpen: function () { return setTemporaryToken(token); }, renderWithPortal: expandToViewport, content: React.createElement(\"div\", { className: styles['token-editor'] },\n            React.createElement(EditingFields, __assign({}, props, { temporaryToken: temporaryToken, setTemporaryToken: setTemporaryToken })),\n            React.createElement(\"div\", { className: styles['token-editor-actions'] },\n                React.createElement(InternalButton, { variant: \"link\", className: styles['token-editor-cancel'], onClick: closePopover }, i18nStrings.cancelActionText),\n                React.createElement(InternalButton, { className: styles['token-editor-submit'], onClick: function () {\n                        setToken(temporaryToken);\n                        closePopover();\n                    } }, i18nStrings.applyActionText))) }, triggerComponent));\n};\n"]},"metadata":{},"sourceType":"module"}