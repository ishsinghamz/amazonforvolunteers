{"ast":null,"code":"import { __assign, __rest } from \"tslib\";\nimport React, { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport clsx from 'clsx';\nimport { getBaseProps } from '../internal/base-component';\nimport { useControllable } from '../internal/hooks/use-controllable';\nimport { fireNonCancelableEvent } from '../internal/events';\nimport Legend from '../internal/components/chart-legend';\nimport Filter from '../internal/components/chart-filter';\nimport InternalSpaceBetween from '../space-between/internal';\nimport InternalBox from '../box/internal';\nimport InternalPieChart from './pie-chart';\nimport styles from './styles.css.js';\nimport { applyDisplayName } from '../internal/utils/apply-display-name';\nimport useBaseComponent from '../internal/hooks/use-base-component';\nimport mergeRefs from 'react-merge-refs';\nimport createCategoryColorScale from '../internal/utils/create-category-color-scale';\nimport useContainerWidth from '../internal/utils/use-container-width';\nimport { nodeContains } from '../internal/utils/dom';\n\nvar PieChart = function PieChart(_a) {\n  var _b;\n\n  var _c = _a.variant,\n      variant = _c === void 0 ? 'pie' : _c,\n      _d = _a.size,\n      size = _d === void 0 ? 'medium' : _d,\n      _e = _a.hideLegend,\n      hideLegend = _e === void 0 ? false : _e,\n      _f = _a.hideFilter,\n      hideFilter = _f === void 0 ? false : _f,\n      _g = _a.statusType,\n      statusType = _g === void 0 ? 'finished' : _g,\n      _h = _a.data,\n      externalData = _h === void 0 ? [] : _h,\n      i18nStrings = _a.i18nStrings,\n      controlledHighlightedSegment = _a.highlightedSegment,\n      controlledVisibleSegments = _a.visibleSegments,\n      controlledOnHighlightChange = _a.onHighlightChange,\n      onFilterChange = _a.onFilterChange,\n      additionalFilters = _a.additionalFilters,\n      legendTitle = _a.legendTitle,\n      _j = _a.detailPopoverSize,\n      detailPopoverSize = _j === void 0 ? 'medium' : _j,\n      props = __rest(_a, [\"variant\", \"size\", \"hideLegend\", \"hideFilter\", \"statusType\", \"data\", \"i18nStrings\", \"highlightedSegment\", \"visibleSegments\", \"onHighlightChange\", \"onFilterChange\", \"additionalFilters\", \"legendTitle\", \"detailPopoverSize\"]);\n\n  var _k = useBaseComponent('PieChart').__internalRootRef,\n      __internalRootRef = _k === void 0 ? null : _k;\n\n  var baseProps = getBaseProps(props);\n  var isEmpty = !externalData || externalData.length === 0;\n\n  var containerAttr = __assign(__assign({}, baseProps), {\n    className: clsx(baseProps.className, styles.root)\n  });\n\n  var containerRef = useRef(null);\n\n  var _l = useContainerWidth(),\n      containerWidth = _l[0],\n      measureRef = _l[1];\n\n  var data = useMemo(function () {\n    var colors = createCategoryColorScale(externalData, undefined, function (it) {\n      return it.color || null;\n    });\n    return externalData.map(function (datum, i) {\n      return {\n        index: i,\n        color: colors[i],\n        datum: datum\n      };\n    });\n  }, [externalData]);\n\n  var _m = useControllable(controlledHighlightedSegment, controlledOnHighlightChange, null, {\n    componentName: 'PieChart',\n    controlledProp: 'highlightedSegment',\n    changeHandler: 'onHighlightChange'\n  }),\n      _o = _m[0],\n      highlightedSegment = _o === void 0 ? null : _o,\n      setHighlightedSegment = _m[1];\n\n  var _p = useState(highlightedSegment),\n      legendSegment = _p[0],\n      setLegendSegment = _p[1];\n\n  useEffect(function () {\n    setLegendSegment(controlledHighlightedSegment || null);\n  }, [controlledHighlightedSegment]);\n\n  var _q = useControllable(controlledVisibleSegments, onFilterChange, externalData, {\n    componentName: 'PieChart',\n    controlledProp: 'visibleSegments',\n    changeHandler: 'onFilterChange'\n  }),\n      visibleSegments = _q[0],\n      setVisibleSegments = _q[1];\n\n  var _r = useState(null),\n      pinnedSegment = _r[0],\n      setPinnedSegment = _r[1];\n\n  var visibleData = useMemo(function () {\n    return data.filter(function (d) {\n      return (visibleSegments === null || visibleSegments === void 0 ? void 0 : visibleSegments.indexOf(d.datum)) !== -1;\n    });\n  }, [data, visibleSegments]);\n  var filterItems = data === null || data === void 0 ? void 0 : data.map(function (data) {\n    return {\n      label: data.datum.title,\n      color: data.color,\n      type: 'rectangle',\n      datum: data.datum\n    };\n  });\n  var legendItems = filterItems.filter(function (d) {\n    return (visibleSegments === null || visibleSegments === void 0 ? void 0 : visibleSegments.indexOf(d.datum)) !== -1;\n  });\n  var filterChange = useCallback(function (selectedSeries) {\n    setVisibleSegments(selectedSeries);\n    fireNonCancelableEvent(onFilterChange, {\n      visibleSegments: selectedSeries\n    });\n  }, [setVisibleSegments, onFilterChange]);\n  var onHighlightChange = useCallback(function (segment) {\n    if (pinnedSegment !== null) {\n      return;\n    }\n\n    segment && setLegendSegment(segment);\n    setHighlightedSegment(segment);\n    fireNonCancelableEvent(controlledOnHighlightChange, {\n      highlightedSegment: segment\n    });\n  }, [pinnedSegment, controlledOnHighlightChange, setHighlightedSegment]);\n\n  var onBlur = function (event) {\n    if (event.relatedTarget && !nodeContains(containerRef.current, event.relatedTarget)) {\n      highlightedSegment && onHighlightChange(null);\n      setLegendSegment(null);\n    }\n  };\n\n  var ref = useMemo(function () {\n    return mergeRefs([containerRef, measureRef, __internalRootRef]);\n  }, [measureRef, __internalRootRef]);\n  return React.createElement(\"div\", __assign({}, containerAttr, {\n    ref: ref,\n    onBlur: onBlur\n  }), statusType === 'finished' && !isEmpty && React.createElement(InternalBox, {\n    className: styles['filter-container'],\n    margin: {\n      bottom: 'l'\n    }\n  }, React.createElement(InternalSpaceBetween, {\n    size: \"l\",\n    direction: \"horizontal\",\n    className: clsx((_b = {}, _b[styles['has-default-filter']] = !hideFilter, _b))\n  }, !hideFilter && React.createElement(Filter, {\n    series: filterItems,\n    onChange: filterChange,\n    selectedSeries: visibleSegments,\n    i18nStrings: i18nStrings\n  }), additionalFilters)), React.createElement(InternalPieChart, __assign({}, props, {\n    variant: variant,\n    size: size,\n    data: externalData,\n    visibleData: visibleData,\n    width: containerWidth,\n    statusType: statusType,\n    hideLegend: hideLegend,\n    hideFilter: hideFilter,\n    additionalFilters: additionalFilters,\n    i18nStrings: i18nStrings,\n    onHighlightChange: onHighlightChange,\n    highlightedSegment: highlightedSegment,\n    legendSegment: legendSegment,\n    pinnedSegment: pinnedSegment,\n    setPinnedSegment: setPinnedSegment,\n    detailPopoverSize: detailPopoverSize\n  })), !hideLegend && !isEmpty && statusType === 'finished' && React.createElement(InternalBox, {\n    margin: {\n      top: 'm'\n    }\n  }, React.createElement(Legend, {\n    series: legendItems,\n    highlightedSeries: legendSegment,\n    legendTitle: legendTitle,\n    ariaLabel: i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.legendAriaLabel,\n    onHighlightChange: onHighlightChange\n  })));\n};\n\napplyDisplayName(PieChart, 'PieChart');\nexport default PieChart;","map":{"version":3,"sources":["/Users/isingheg/Desktop/projects/amazonforvolunteers-ui/node_modules/@awsui/components-react/pie-chart/index.js"],"names":["__assign","__rest","React","useCallback","useEffect","useMemo","useRef","useState","clsx","getBaseProps","useControllable","fireNonCancelableEvent","Legend","Filter","InternalSpaceBetween","InternalBox","InternalPieChart","styles","applyDisplayName","useBaseComponent","mergeRefs","createCategoryColorScale","useContainerWidth","nodeContains","PieChart","_a","_b","_c","variant","_d","size","_e","hideLegend","_f","hideFilter","_g","statusType","_h","data","externalData","i18nStrings","controlledHighlightedSegment","highlightedSegment","controlledVisibleSegments","visibleSegments","controlledOnHighlightChange","onHighlightChange","onFilterChange","additionalFilters","legendTitle","_j","detailPopoverSize","props","_k","__internalRootRef","baseProps","isEmpty","length","containerAttr","className","root","containerRef","_l","containerWidth","measureRef","colors","undefined","it","color","map","datum","i","index","_m","componentName","controlledProp","changeHandler","_o","setHighlightedSegment","_p","legendSegment","setLegendSegment","_q","setVisibleSegments","_r","pinnedSegment","setPinnedSegment","visibleData","filter","d","indexOf","filterItems","label","title","type","legendItems","filterChange","selectedSeries","segment","onBlur","event","relatedTarget","current","ref","createElement","margin","bottom","direction","series","onChange","width","top","highlightedSeries","ariaLabel","legendAriaLabel"],"mappings":"AAAA,SAASA,QAAT,EAAmBC,MAAnB,QAAiC,OAAjC;AACA,OAAOC,KAAP,IAAgBC,WAAhB,EAA6BC,SAA7B,EAAwCC,OAAxC,EAAiDC,MAAjD,EAAyDC,QAAzD,QAAyE,OAAzE;AACA,OAAOC,IAAP,MAAiB,MAAjB;AACA,SAASC,YAAT,QAA6B,4BAA7B;AACA,SAASC,eAAT,QAAgC,oCAAhC;AACA,SAASC,sBAAT,QAAuC,oBAAvC;AACA,OAAOC,MAAP,MAAmB,qCAAnB;AACA,OAAOC,MAAP,MAAmB,qCAAnB;AACA,OAAOC,oBAAP,MAAiC,2BAAjC;AACA,OAAOC,WAAP,MAAwB,iBAAxB;AACA,OAAOC,gBAAP,MAA6B,aAA7B;AACA,OAAOC,MAAP,MAAmB,iBAAnB;AACA,SAASC,gBAAT,QAAiC,sCAAjC;AACA,OAAOC,gBAAP,MAA6B,sCAA7B;AACA,OAAOC,SAAP,MAAsB,kBAAtB;AACA,OAAOC,wBAAP,MAAqC,+CAArC;AACA,OAAOC,iBAAP,MAA8B,uCAA9B;AACA,SAASC,YAAT,QAA6B,uBAA7B;;AACA,IAAIC,QAAQ,GAAG,SAASA,QAAT,CAAkBC,EAAlB,EAAsB;AACjC,MAAIC,EAAJ;;AACA,MAAIC,EAAE,GAAGF,EAAE,CAACG,OAAZ;AAAA,MAAqBA,OAAO,GAAGD,EAAE,KAAK,KAAK,CAAZ,GAAgB,KAAhB,GAAwBA,EAAvD;AAAA,MAA2DE,EAAE,GAAGJ,EAAE,CAACK,IAAnE;AAAA,MAAyEA,IAAI,GAAGD,EAAE,KAAK,KAAK,CAAZ,GAAgB,QAAhB,GAA2BA,EAA3G;AAAA,MAA+GE,EAAE,GAAGN,EAAE,CAACO,UAAvH;AAAA,MAAmIA,UAAU,GAAGD,EAAE,KAAK,KAAK,CAAZ,GAAgB,KAAhB,GAAwBA,EAAxK;AAAA,MAA4KE,EAAE,GAAGR,EAAE,CAACS,UAApL;AAAA,MAAgMA,UAAU,GAAGD,EAAE,KAAK,KAAK,CAAZ,GAAgB,KAAhB,GAAwBA,EAArO;AAAA,MAAyOE,EAAE,GAAGV,EAAE,CAACW,UAAjP;AAAA,MAA6PA,UAAU,GAAGD,EAAE,KAAK,KAAK,CAAZ,GAAgB,UAAhB,GAA6BA,EAAvS;AAAA,MAA2SE,EAAE,GAAGZ,EAAE,CAACa,IAAnT;AAAA,MAAyTC,YAAY,GAAGF,EAAE,KAAK,KAAK,CAAZ,GAAgB,EAAhB,GAAqBA,EAA7V;AAAA,MAAiWG,WAAW,GAAGf,EAAE,CAACe,WAAlX;AAAA,MAA+XC,4BAA4B,GAAGhB,EAAE,CAACiB,kBAAja;AAAA,MAAqbC,yBAAyB,GAAGlB,EAAE,CAACmB,eAApd;AAAA,MAAqeC,2BAA2B,GAAGpB,EAAE,CAACqB,iBAAtgB;AAAA,MAAyhBC,cAAc,GAAGtB,EAAE,CAACsB,cAA7iB;AAAA,MAA6jBC,iBAAiB,GAAGvB,EAAE,CAACuB,iBAAplB;AAAA,MAAumBC,WAAW,GAAGxB,EAAE,CAACwB,WAAxnB;AAAA,MAAqoBC,EAAE,GAAGzB,EAAE,CAAC0B,iBAA7oB;AAAA,MAAgqBA,iBAAiB,GAAGD,EAAE,KAAK,KAAK,CAAZ,GAAgB,QAAhB,GAA2BA,EAA/sB;AAAA,MAAmtBE,KAAK,GAAGnD,MAAM,CAACwB,EAAD,EAAK,CAAC,SAAD,EAAY,MAAZ,EAAoB,YAApB,EAAkC,YAAlC,EAAgD,YAAhD,EAA8D,MAA9D,EAAsE,aAAtE,EAAqF,oBAArF,EAA2G,iBAA3G,EAA8H,mBAA9H,EAAmJ,gBAAnJ,EAAqK,mBAArK,EAA0L,aAA1L,EAAyM,mBAAzM,CAAL,CAAjuB;;AACA,MAAI4B,EAAE,GAAGlC,gBAAgB,CAAC,UAAD,CAAhB,CAA6BmC,iBAAtC;AAAA,MAAyDA,iBAAiB,GAAGD,EAAE,KAAK,KAAK,CAAZ,GAAgB,IAAhB,GAAuBA,EAApG;;AACA,MAAIE,SAAS,GAAG9C,YAAY,CAAC2C,KAAD,CAA5B;AACA,MAAII,OAAO,GAAG,CAACjB,YAAD,IAAiBA,YAAY,CAACkB,MAAb,KAAwB,CAAvD;;AACA,MAAIC,aAAa,GAAG1D,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKuD,SAAL,CAAT,EAA0B;AAAEI,IAAAA,SAAS,EAAEnD,IAAI,CAAC+C,SAAS,CAACI,SAAX,EAAsB1C,MAAM,CAAC2C,IAA7B;AAAjB,GAA1B,CAA5B;;AACA,MAAIC,YAAY,GAAGvD,MAAM,CAAC,IAAD,CAAzB;;AACA,MAAIwD,EAAE,GAAGxC,iBAAiB,EAA1B;AAAA,MAA8ByC,cAAc,GAAGD,EAAE,CAAC,CAAD,CAAjD;AAAA,MAAsDE,UAAU,GAAGF,EAAE,CAAC,CAAD,CAArE;;AACA,MAAIxB,IAAI,GAAGjC,OAAO,CAAC,YAAY;AAC3B,QAAI4D,MAAM,GAAG5C,wBAAwB,CAACkB,YAAD,EAAe2B,SAAf,EAA0B,UAAUC,EAAV,EAAc;AAAE,aAAOA,EAAE,CAACC,KAAH,IAAY,IAAnB;AAA0B,KAApE,CAArC;AACA,WAAO7B,YAAY,CAAC8B,GAAb,CAAiB,UAAUC,KAAV,EAAiBC,CAAjB,EAAoB;AAAE,aAAQ;AAClDC,QAAAA,KAAK,EAAED,CAD2C;AAElDH,QAAAA,KAAK,EAAEH,MAAM,CAACM,CAAD,CAFqC;AAGlDD,QAAAA,KAAK,EAAEA;AAH2C,OAAR;AAIzC,KAJE,CAAP;AAKH,GAPiB,EAOf,CAAC/B,YAAD,CAPe,CAAlB;;AAQA,MAAIkC,EAAE,GAAG/D,eAAe,CAAC+B,4BAAD,EAA+BI,2BAA/B,EAA4D,IAA5D,EAAkE;AACtF6B,IAAAA,aAAa,EAAE,UADuE;AAEtFC,IAAAA,cAAc,EAAE,oBAFsE;AAGtFC,IAAAA,aAAa,EAAE;AAHuE,GAAlE,CAAxB;AAAA,MAIIC,EAAE,GAAGJ,EAAE,CAAC,CAAD,CAJX;AAAA,MAIgB/B,kBAAkB,GAAGmC,EAAE,KAAK,KAAK,CAAZ,GAAgB,IAAhB,GAAuBA,EAJ5D;AAAA,MAIgEC,qBAAqB,GAAGL,EAAE,CAAC,CAAD,CAJ1F;;AAKA,MAAIM,EAAE,GAAGxE,QAAQ,CAACmC,kBAAD,CAAjB;AAAA,MAAuCsC,aAAa,GAAGD,EAAE,CAAC,CAAD,CAAzD;AAAA,MAA8DE,gBAAgB,GAAGF,EAAE,CAAC,CAAD,CAAnF;;AACA3E,EAAAA,SAAS,CAAC,YAAY;AAClB6E,IAAAA,gBAAgB,CAACxC,4BAA4B,IAAI,IAAjC,CAAhB;AACH,GAFQ,EAEN,CAACA,4BAAD,CAFM,CAAT;;AAGA,MAAIyC,EAAE,GAAGxE,eAAe,CAACiC,yBAAD,EAA4BI,cAA5B,EAA4CR,YAA5C,EAA0D;AAC9EmC,IAAAA,aAAa,EAAE,UAD+D;AAE9EC,IAAAA,cAAc,EAAE,iBAF8D;AAG9EC,IAAAA,aAAa,EAAE;AAH+D,GAA1D,CAAxB;AAAA,MAIIhC,eAAe,GAAGsC,EAAE,CAAC,CAAD,CAJxB;AAAA,MAI6BC,kBAAkB,GAAGD,EAAE,CAAC,CAAD,CAJpD;;AAKA,MAAIE,EAAE,GAAG7E,QAAQ,CAAC,IAAD,CAAjB;AAAA,MAAyB8E,aAAa,GAAGD,EAAE,CAAC,CAAD,CAA3C;AAAA,MAAgDE,gBAAgB,GAAGF,EAAE,CAAC,CAAD,CAArE;;AACA,MAAIG,WAAW,GAAGlF,OAAO,CAAC,YAAY;AAAE,WAAOiC,IAAI,CAACkD,MAAL,CAAY,UAAUC,CAAV,EAAa;AAAE,aAAO,CAAC7C,eAAe,KAAK,IAApB,IAA4BA,eAAe,KAAK,KAAK,CAArD,GAAyD,KAAK,CAA9D,GAAkEA,eAAe,CAAC8C,OAAhB,CAAwBD,CAAC,CAACnB,KAA1B,CAAnE,MAAyG,CAAC,CAAjH;AAAqH,KAAhJ,CAAP;AAA2J,GAA1K,EAA4K,CAAChC,IAAD,EAAOM,eAAP,CAA5K,CAAzB;AACA,MAAI+C,WAAW,GAAGrD,IAAI,KAAK,IAAT,IAAiBA,IAAI,KAAK,KAAK,CAA/B,GAAmC,KAAK,CAAxC,GAA4CA,IAAI,CAAC+B,GAAL,CAAS,UAAU/B,IAAV,EAAgB;AAAE,WAAQ;AAC7FsD,MAAAA,KAAK,EAAEtD,IAAI,CAACgC,KAAL,CAAWuB,KAD2E;AAE7FzB,MAAAA,KAAK,EAAE9B,IAAI,CAAC8B,KAFiF;AAG7F0B,MAAAA,IAAI,EAAE,WAHuF;AAI7FxB,MAAAA,KAAK,EAAEhC,IAAI,CAACgC;AAJiF,KAAR;AAKpF,GALyD,CAA9D;AAMA,MAAIyB,WAAW,GAAGJ,WAAW,CAACH,MAAZ,CAAmB,UAAUC,CAAV,EAAa;AAAE,WAAO,CAAC7C,eAAe,KAAK,IAApB,IAA4BA,eAAe,KAAK,KAAK,CAArD,GAAyD,KAAK,CAA9D,GAAkEA,eAAe,CAAC8C,OAAhB,CAAwBD,CAAC,CAACnB,KAA1B,CAAnE,MAAyG,CAAC,CAAjH;AAAqH,GAAvJ,CAAlB;AACA,MAAI0B,YAAY,GAAG7F,WAAW,CAAC,UAAU8F,cAAV,EAA0B;AACrDd,IAAAA,kBAAkB,CAACc,cAAD,CAAlB;AACAtF,IAAAA,sBAAsB,CAACoC,cAAD,EAAiB;AACnCH,MAAAA,eAAe,EAAEqD;AADkB,KAAjB,CAAtB;AAGH,GAL6B,EAK3B,CAACd,kBAAD,EAAqBpC,cAArB,CAL2B,CAA9B;AAMA,MAAID,iBAAiB,GAAG3C,WAAW,CAAC,UAAU+F,OAAV,EAAmB;AACnD,QAAIb,aAAa,KAAK,IAAtB,EAA4B;AACxB;AACH;;AACDa,IAAAA,OAAO,IAAIjB,gBAAgB,CAACiB,OAAD,CAA3B;AACApB,IAAAA,qBAAqB,CAACoB,OAAD,CAArB;AACAvF,IAAAA,sBAAsB,CAACkC,2BAAD,EAA8B;AAAEH,MAAAA,kBAAkB,EAAEwD;AAAtB,KAA9B,CAAtB;AACH,GAPkC,EAOhC,CAACb,aAAD,EAAgBxC,2BAAhB,EAA6CiC,qBAA7C,CAPgC,CAAnC;;AAQA,MAAIqB,MAAM,GAAG,UAAUC,KAAV,EAAiB;AAC1B,QAAIA,KAAK,CAACC,aAAN,IAAuB,CAAC9E,YAAY,CAACsC,YAAY,CAACyC,OAAd,EAAuBF,KAAK,CAACC,aAA7B,CAAxC,EAAqF;AACjF3D,MAAAA,kBAAkB,IAAII,iBAAiB,CAAC,IAAD,CAAvC;AACAmC,MAAAA,gBAAgB,CAAC,IAAD,CAAhB;AACH;AACJ,GALD;;AAMA,MAAIsB,GAAG,GAAGlG,OAAO,CAAC,YAAY;AAAE,WAAOe,SAAS,CAAC,CAACyC,YAAD,EAAeG,UAAf,EAA2BV,iBAA3B,CAAD,CAAhB;AAAkE,GAAjF,EAAmF,CAACU,UAAD,EAAaV,iBAAb,CAAnF,CAAjB;AACA,SAAQpD,KAAK,CAACsG,aAAN,CAAoB,KAApB,EAA2BxG,QAAQ,CAAC,EAAD,EAAK0D,aAAL,EAAoB;AAAE6C,IAAAA,GAAG,EAAEA,GAAP;AAAYJ,IAAAA,MAAM,EAAEA;AAApB,GAApB,CAAnC,EACJ/D,UAAU,KAAK,UAAf,IAA6B,CAACoB,OAA9B,IAA0CtD,KAAK,CAACsG,aAAN,CAAoBzF,WAApB,EAAiC;AAAE4C,IAAAA,SAAS,EAAE1C,MAAM,CAAC,kBAAD,CAAnB;AAAyCwF,IAAAA,MAAM,EAAE;AAAEC,MAAAA,MAAM,EAAE;AAAV;AAAjD,GAAjC,EACtCxG,KAAK,CAACsG,aAAN,CAAoB1F,oBAApB,EAA0C;AAAEgB,IAAAA,IAAI,EAAE,GAAR;AAAa6E,IAAAA,SAAS,EAAE,YAAxB;AAAsChD,IAAAA,SAAS,EAAEnD,IAAI,EAAEkB,EAAE,GAAG,EAAL,EACzFA,EAAE,CAACT,MAAM,CAAC,oBAAD,CAAP,CAAF,GAAmC,CAACiB,UADqD,EAEzFR,EAFuF;AAArD,GAA1C,EAGI,CAACQ,UAAD,IAAgBhC,KAAK,CAACsG,aAAN,CAAoB3F,MAApB,EAA4B;AAAE+F,IAAAA,MAAM,EAAEjB,WAAV;AAAuBkB,IAAAA,QAAQ,EAAEb,YAAjC;AAA+CC,IAAAA,cAAc,EAAErD,eAA/D;AAAgFJ,IAAAA,WAAW,EAAEA;AAA7F,GAA5B,CAHpB,EAIIQ,iBAJJ,CADsC,CADtC,EAOJ9C,KAAK,CAACsG,aAAN,CAAoBxF,gBAApB,EAAsChB,QAAQ,CAAC,EAAD,EAAKoD,KAAL,EAAY;AAAExB,IAAAA,OAAO,EAAEA,OAAX;AAAoBE,IAAAA,IAAI,EAAEA,IAA1B;AAAgCQ,IAAAA,IAAI,EAAEC,YAAtC;AAAoDgD,IAAAA,WAAW,EAAEA,WAAjE;AAA8EuB,IAAAA,KAAK,EAAE/C,cAArF;AAAqG3B,IAAAA,UAAU,EAAEA,UAAjH;AAA6HJ,IAAAA,UAAU,EAAEA,UAAzI;AAAqJE,IAAAA,UAAU,EAAEA,UAAjK;AAA6Kc,IAAAA,iBAAiB,EAAEA,iBAAhM;AAAmNR,IAAAA,WAAW,EAAEA,WAAhO;AAA6OM,IAAAA,iBAAiB,EAAEA,iBAAhQ;AAAmRJ,IAAAA,kBAAkB,EAAEA,kBAAvS;AAA2TsC,IAAAA,aAAa,EAAEA,aAA1U;AAAyVK,IAAAA,aAAa,EAAEA,aAAxW;AAAuXC,IAAAA,gBAAgB,EAAEA,gBAAzY;AAA2ZnC,IAAAA,iBAAiB,EAAEA;AAA9a,GAAZ,CAA9C,CAPI,EAQJ,CAACnB,UAAD,IAAe,CAACwB,OAAhB,IAA2BpB,UAAU,KAAK,UAA1C,IAAyDlC,KAAK,CAACsG,aAAN,CAAoBzF,WAApB,EAAiC;AAAE0F,IAAAA,MAAM,EAAE;AAAEM,MAAAA,GAAG,EAAE;AAAP;AAAV,GAAjC,EACrD7G,KAAK,CAACsG,aAAN,CAAoB5F,MAApB,EAA4B;AAAEgG,IAAAA,MAAM,EAAEb,WAAV;AAAuBiB,IAAAA,iBAAiB,EAAEhC,aAA1C;AAAyD/B,IAAAA,WAAW,EAAEA,WAAtE;AAAmFgE,IAAAA,SAAS,EAAEzE,WAAW,KAAK,IAAhB,IAAwBA,WAAW,KAAK,KAAK,CAA7C,GAAiD,KAAK,CAAtD,GAA0DA,WAAW,CAAC0E,eAApK;AAAqLpE,IAAAA,iBAAiB,EAAEA;AAAxM,GAA5B,CADqD,CARrD,CAAR;AAUH,CAvED;;AAwEA5B,gBAAgB,CAACM,QAAD,EAAW,UAAX,CAAhB;AACA,eAAeA,QAAf","sourcesContent":["import { __assign, __rest } from \"tslib\";\nimport React, { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport clsx from 'clsx';\nimport { getBaseProps } from '../internal/base-component';\nimport { useControllable } from '../internal/hooks/use-controllable';\nimport { fireNonCancelableEvent } from '../internal/events';\nimport Legend from '../internal/components/chart-legend';\nimport Filter from '../internal/components/chart-filter';\nimport InternalSpaceBetween from '../space-between/internal';\nimport InternalBox from '../box/internal';\nimport InternalPieChart from './pie-chart';\nimport styles from './styles.css.js';\nimport { applyDisplayName } from '../internal/utils/apply-display-name';\nimport useBaseComponent from '../internal/hooks/use-base-component';\nimport mergeRefs from 'react-merge-refs';\nimport createCategoryColorScale from '../internal/utils/create-category-color-scale';\nimport useContainerWidth from '../internal/utils/use-container-width';\nimport { nodeContains } from '../internal/utils/dom';\nvar PieChart = function PieChart(_a) {\n    var _b;\n    var _c = _a.variant, variant = _c === void 0 ? 'pie' : _c, _d = _a.size, size = _d === void 0 ? 'medium' : _d, _e = _a.hideLegend, hideLegend = _e === void 0 ? false : _e, _f = _a.hideFilter, hideFilter = _f === void 0 ? false : _f, _g = _a.statusType, statusType = _g === void 0 ? 'finished' : _g, _h = _a.data, externalData = _h === void 0 ? [] : _h, i18nStrings = _a.i18nStrings, controlledHighlightedSegment = _a.highlightedSegment, controlledVisibleSegments = _a.visibleSegments, controlledOnHighlightChange = _a.onHighlightChange, onFilterChange = _a.onFilterChange, additionalFilters = _a.additionalFilters, legendTitle = _a.legendTitle, _j = _a.detailPopoverSize, detailPopoverSize = _j === void 0 ? 'medium' : _j, props = __rest(_a, [\"variant\", \"size\", \"hideLegend\", \"hideFilter\", \"statusType\", \"data\", \"i18nStrings\", \"highlightedSegment\", \"visibleSegments\", \"onHighlightChange\", \"onFilterChange\", \"additionalFilters\", \"legendTitle\", \"detailPopoverSize\"]);\n    var _k = useBaseComponent('PieChart').__internalRootRef, __internalRootRef = _k === void 0 ? null : _k;\n    var baseProps = getBaseProps(props);\n    var isEmpty = !externalData || externalData.length === 0;\n    var containerAttr = __assign(__assign({}, baseProps), { className: clsx(baseProps.className, styles.root) });\n    var containerRef = useRef(null);\n    var _l = useContainerWidth(), containerWidth = _l[0], measureRef = _l[1];\n    var data = useMemo(function () {\n        var colors = createCategoryColorScale(externalData, undefined, function (it) { return it.color || null; });\n        return externalData.map(function (datum, i) { return ({\n            index: i,\n            color: colors[i],\n            datum: datum\n        }); });\n    }, [externalData]);\n    var _m = useControllable(controlledHighlightedSegment, controlledOnHighlightChange, null, {\n        componentName: 'PieChart',\n        controlledProp: 'highlightedSegment',\n        changeHandler: 'onHighlightChange'\n    }), _o = _m[0], highlightedSegment = _o === void 0 ? null : _o, setHighlightedSegment = _m[1];\n    var _p = useState(highlightedSegment), legendSegment = _p[0], setLegendSegment = _p[1];\n    useEffect(function () {\n        setLegendSegment(controlledHighlightedSegment || null);\n    }, [controlledHighlightedSegment]);\n    var _q = useControllable(controlledVisibleSegments, onFilterChange, externalData, {\n        componentName: 'PieChart',\n        controlledProp: 'visibleSegments',\n        changeHandler: 'onFilterChange'\n    }), visibleSegments = _q[0], setVisibleSegments = _q[1];\n    var _r = useState(null), pinnedSegment = _r[0], setPinnedSegment = _r[1];\n    var visibleData = useMemo(function () { return data.filter(function (d) { return (visibleSegments === null || visibleSegments === void 0 ? void 0 : visibleSegments.indexOf(d.datum)) !== -1; }); }, [data, visibleSegments]);\n    var filterItems = data === null || data === void 0 ? void 0 : data.map(function (data) { return ({\n        label: data.datum.title,\n        color: data.color,\n        type: 'rectangle',\n        datum: data.datum\n    }); });\n    var legendItems = filterItems.filter(function (d) { return (visibleSegments === null || visibleSegments === void 0 ? void 0 : visibleSegments.indexOf(d.datum)) !== -1; });\n    var filterChange = useCallback(function (selectedSeries) {\n        setVisibleSegments(selectedSeries);\n        fireNonCancelableEvent(onFilterChange, {\n            visibleSegments: selectedSeries\n        });\n    }, [setVisibleSegments, onFilterChange]);\n    var onHighlightChange = useCallback(function (segment) {\n        if (pinnedSegment !== null) {\n            return;\n        }\n        segment && setLegendSegment(segment);\n        setHighlightedSegment(segment);\n        fireNonCancelableEvent(controlledOnHighlightChange, { highlightedSegment: segment });\n    }, [pinnedSegment, controlledOnHighlightChange, setHighlightedSegment]);\n    var onBlur = function (event) {\n        if (event.relatedTarget && !nodeContains(containerRef.current, event.relatedTarget)) {\n            highlightedSegment && onHighlightChange(null);\n            setLegendSegment(null);\n        }\n    };\n    var ref = useMemo(function () { return mergeRefs([containerRef, measureRef, __internalRootRef]); }, [measureRef, __internalRootRef]);\n    return (React.createElement(\"div\", __assign({}, containerAttr, { ref: ref, onBlur: onBlur }),\n        statusType === 'finished' && !isEmpty && (React.createElement(InternalBox, { className: styles['filter-container'], margin: { bottom: 'l' } },\n            React.createElement(InternalSpaceBetween, { size: \"l\", direction: \"horizontal\", className: clsx((_b = {},\n                    _b[styles['has-default-filter']] = !hideFilter,\n                    _b)) },\n                !hideFilter && (React.createElement(Filter, { series: filterItems, onChange: filterChange, selectedSeries: visibleSegments, i18nStrings: i18nStrings })),\n                additionalFilters))),\n        React.createElement(InternalPieChart, __assign({}, props, { variant: variant, size: size, data: externalData, visibleData: visibleData, width: containerWidth, statusType: statusType, hideLegend: hideLegend, hideFilter: hideFilter, additionalFilters: additionalFilters, i18nStrings: i18nStrings, onHighlightChange: onHighlightChange, highlightedSegment: highlightedSegment, legendSegment: legendSegment, pinnedSegment: pinnedSegment, setPinnedSegment: setPinnedSegment, detailPopoverSize: detailPopoverSize })),\n        !hideLegend && !isEmpty && statusType === 'finished' && (React.createElement(InternalBox, { margin: { top: 'm' } },\n            React.createElement(Legend, { series: legendItems, highlightedSeries: legendSegment, legendTitle: legendTitle, ariaLabel: i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.legendAriaLabel, onHighlightChange: onHighlightChange })))));\n};\napplyDisplayName(PieChart, 'PieChart');\nexport default PieChart;\n"]},"metadata":{},"sourceType":"module"}