{"ast":null,"code":"import { __assign, __spreadArray } from \"tslib\";\nimport React, { useReducer, useRef } from 'react';\nimport InternalBreadcrumbGroup from '../../breadcrumb-group/internal';\nimport { InternalButton } from '../../button/internal';\nimport InternalModal from '../../modal/internal';\nimport InternalSpaceBetween from '../../space-between/internal';\nimport { useEffectOnUpdate } from '../../internal/hooks/use-effect-on-update';\nimport { useVisualRefresh } from '../../internal/hooks/use-visual-mode';\nimport { BucketsTable } from './buckets-table';\nimport { ObjectsTable } from './objects-table';\nimport { VersionsTable } from './versions-table';\nimport styles from './styles.css.js';\nimport { joinObjectPath } from '../utils';\n\nfunction assertNever(_value) {\n  return null;\n}\n\nvar initialBrowseState = {\n  selectedItem: null,\n  currentView: 'buckets',\n  breadcrumbs: []\n};\n\nfunction s3BrowseReducer(state, action) {\n  switch (action.type) {\n    case 'browse-buckets':\n      return initialBrowseState;\n\n    case 'browse-objects':\n      return {\n        selectedItem: null,\n        currentView: 'objects',\n        breadcrumbs: action.breadcrumbs\n      };\n\n    case 'browse-versions':\n      return {\n        selectedItem: null,\n        currentView: 'versions',\n        breadcrumbs: action.breadcrumbs\n      };\n\n    case 'select-item':\n      return __assign(__assign({}, state), {\n        selectedItem: action.item\n      });\n\n    default:\n      assertNever(action);\n  }\n\n  return state;\n}\n\nfunction createResourceInfo(_a) {\n  var currentView = _a.currentView,\n      breadcrumbs = _a.breadcrumbs,\n      selectedItem = _a.selectedItem;\n  var prefix = 's3://';\n\n  if (currentView === 'versions') {\n    return {\n      uri: prefix + joinObjectPath(breadcrumbs),\n      versionId: selectedItem !== null && selectedItem !== void 0 ? selectedItem : undefined\n    };\n  }\n\n  return {\n    uri: prefix + joinObjectPath(__spreadArray(__spreadArray([], breadcrumbs, true), [selectedItem], false))\n  };\n}\n\nexport function S3Modal(_a) {\n  var _b;\n\n  var i18nStrings = _a.i18nStrings,\n      alert = _a.alert,\n      selectableItemsTypes = _a.selectableItemsTypes,\n      fetchBuckets = _a.fetchBuckets,\n      bucketsVisibleColumns = _a.bucketsVisibleColumns,\n      bucketsIsItemDisabled = _a.bucketsIsItemDisabled,\n      fetchObjects = _a.fetchObjects,\n      objectsVisibleColumns = _a.objectsVisibleColumns,\n      objectsIsItemDisabled = _a.objectsIsItemDisabled,\n      fetchVersions = _a.fetchVersions,\n      versionsVisibleColumns = _a.versionsVisibleColumns,\n      versionsIsItemDisabled = _a.versionsIsItemDisabled,\n      onSubmit = _a.onSubmit,\n      onDismiss = _a.onDismiss;\n\n  var _c = useReducer(s3BrowseReducer, initialBrowseState),\n      _d = _c[0],\n      currentView = _d.currentView,\n      breadcrumbs = _d.breadcrumbs,\n      selectedItem = _d.selectedItem,\n      dispatch = _c[1];\n\n  var forwardFocusRef = useRef(null);\n  var modalWrapperRef = useRef(null);\n  var isVisualRefresh = useVisualRefresh(modalWrapperRef);\n  useEffectOnUpdate(function () {\n    var _a;\n\n    (_a = forwardFocusRef.current) === null || _a === void 0 ? void 0 : _a.focus();\n  }, [breadcrumbs]);\n  return React.createElement(\"div\", {\n    ref: modalWrapperRef\n  }, React.createElement(InternalModal, {\n    visible: true,\n    size: \"max\",\n    closeAriaLabel: i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.labelModalDismiss,\n    onDismiss: onDismiss,\n    header: i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.modalTitle,\n    footer: React.createElement(InternalSpaceBetween, {\n      className: styles['modal-actions'],\n      size: \"xs\",\n      direction: \"horizontal\"\n    }, React.createElement(InternalButton, {\n      variant: \"link\",\n      formAction: \"none\",\n      onClick: onDismiss\n    }, i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.modalCancelButton), React.createElement(InternalButton, {\n      variant: \"primary\",\n      className: styles['submit-button'],\n      disabled: !selectedItem,\n      formAction: \"none\",\n      onClick: function () {\n        return onSubmit(createResourceInfo({\n          currentView: currentView,\n          breadcrumbs: breadcrumbs,\n          selectedItem: selectedItem\n        }));\n      }\n    }, i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.modalSubmitButton))\n  }, React.createElement(InternalSpaceBetween, {\n    size: isVisualRefresh ? 'xxs' : 'xs'\n  }, React.createElement(InternalBreadcrumbGroup, {\n    ariaLabel: i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.labelBreadcrumbs,\n    onFollow: function (event) {\n      event.preventDefault();\n      event.detail.item.meta.onClick();\n    },\n    items: __spreadArray([{\n      text: (_b = i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.modalBreadcrumbRootItem) !== null && _b !== void 0 ? _b : '',\n      href: '',\n      meta: {\n        onClick: function () {\n          return dispatch({\n            type: 'browse-buckets'\n          });\n        }\n      }\n    }], breadcrumbs.map(function (segment, index) {\n      return {\n        text: segment,\n        href: '',\n        meta: {\n          onClick: function () {\n            return dispatch({\n              type: 'browse-objects',\n              breadcrumbs: breadcrumbs.slice(0, index + 1)\n            });\n          }\n        }\n      };\n    }), true)\n  }), alert, currentView === 'buckets' ? React.createElement(BucketsTable, {\n    forwardFocusRef: forwardFocusRef,\n    fetchData: fetchBuckets,\n    visibleColumns: bucketsVisibleColumns,\n    isItemDisabled: bucketsIsItemDisabled,\n    selectableItemsTypes: selectableItemsTypes,\n    i18nStrings: i18nStrings,\n    isVisualRefresh: isVisualRefresh,\n    onDrilldown: function (path) {\n      return dispatch({\n        type: 'browse-objects',\n        breadcrumbs: [path]\n      });\n    },\n    onSelect: function (item) {\n      return dispatch({\n        type: 'select-item',\n        item: item\n      });\n    }\n  }) : currentView === 'objects' ? React.createElement(ObjectsTable, {\n    forwardFocusRef: forwardFocusRef,\n    pathSegments: breadcrumbs,\n    fetchData: fetchObjects,\n    visibleColumns: objectsVisibleColumns,\n    isItemDisabled: objectsIsItemDisabled,\n    selectableItemsTypes: selectableItemsTypes,\n    i18nStrings: i18nStrings,\n    isVisualRefresh: isVisualRefresh,\n    onDrilldown: function (item) {\n      dispatch({\n        type: item.IsFolder ? 'browse-objects' : 'browse-versions',\n        breadcrumbs: __spreadArray(__spreadArray([], breadcrumbs, true), [item.Key], false)\n      });\n    },\n    onSelect: function (item) {\n      return dispatch({\n        type: 'select-item',\n        item: item\n      });\n    }\n  }) : currentView === 'versions' ? React.createElement(VersionsTable, {\n    forwardFocusRef: forwardFocusRef,\n    pathSegments: breadcrumbs,\n    fetchData: fetchVersions,\n    visibleColumns: versionsVisibleColumns,\n    isItemDisabled: versionsIsItemDisabled,\n    i18nStrings: i18nStrings,\n    isVisualRefresh: isVisualRefresh,\n    onSelect: function (item) {\n      return dispatch({\n        type: 'select-item',\n        item: item\n      });\n    }\n  }) : assertNever(currentView))));\n}","map":{"version":3,"sources":["/Users/isingheg/Desktop/projects/test-react-amplify/node_modules/@awsui/components-react/s3-resource-selector/s3-modal/index.js"],"names":["__assign","__spreadArray","React","useReducer","useRef","InternalBreadcrumbGroup","InternalButton","InternalModal","InternalSpaceBetween","useEffectOnUpdate","useVisualRefresh","BucketsTable","ObjectsTable","VersionsTable","styles","joinObjectPath","assertNever","_value","initialBrowseState","selectedItem","currentView","breadcrumbs","s3BrowseReducer","state","action","type","item","createResourceInfo","_a","prefix","uri","versionId","undefined","S3Modal","_b","i18nStrings","alert","selectableItemsTypes","fetchBuckets","bucketsVisibleColumns","bucketsIsItemDisabled","fetchObjects","objectsVisibleColumns","objectsIsItemDisabled","fetchVersions","versionsVisibleColumns","versionsIsItemDisabled","onSubmit","onDismiss","_c","_d","dispatch","forwardFocusRef","modalWrapperRef","isVisualRefresh","current","focus","createElement","ref","visible","size","closeAriaLabel","labelModalDismiss","header","modalTitle","footer","className","direction","variant","formAction","onClick","modalCancelButton","disabled","modalSubmitButton","ariaLabel","labelBreadcrumbs","onFollow","event","preventDefault","detail","meta","items","text","modalBreadcrumbRootItem","href","map","segment","index","slice","fetchData","visibleColumns","isItemDisabled","onDrilldown","path","onSelect","pathSegments","IsFolder","Key"],"mappings":"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","sourcesContent":["import { __assign, __spreadArray } from \"tslib\";\nimport React, { useReducer, useRef } from 'react';\nimport InternalBreadcrumbGroup from '../../breadcrumb-group/internal';\nimport { InternalButton } from '../../button/internal';\nimport InternalModal from '../../modal/internal';\nimport InternalSpaceBetween from '../../space-between/internal';\nimport { useEffectOnUpdate } from '../../internal/hooks/use-effect-on-update';\nimport { useVisualRefresh } from '../../internal/hooks/use-visual-mode';\nimport { BucketsTable } from './buckets-table';\nimport { ObjectsTable } from './objects-table';\nimport { VersionsTable } from './versions-table';\nimport styles from './styles.css.js';\nimport { joinObjectPath } from '../utils';\nfunction assertNever(_value) {\n    return null;\n}\nvar initialBrowseState = {\n    selectedItem: null,\n    currentView: 'buckets',\n    breadcrumbs: []\n};\nfunction s3BrowseReducer(state, action) {\n    switch (action.type) {\n        case 'browse-buckets':\n            return initialBrowseState;\n        case 'browse-objects':\n            return {\n                selectedItem: null,\n                currentView: 'objects',\n                breadcrumbs: action.breadcrumbs\n            };\n        case 'browse-versions':\n            return {\n                selectedItem: null,\n                currentView: 'versions',\n                breadcrumbs: action.breadcrumbs\n            };\n        case 'select-item':\n            return __assign(__assign({}, state), { selectedItem: action.item });\n        default:\n            assertNever(action);\n    }\n    return state;\n}\nfunction createResourceInfo(_a) {\n    var currentView = _a.currentView, breadcrumbs = _a.breadcrumbs, selectedItem = _a.selectedItem;\n    var prefix = 's3://';\n    if (currentView === 'versions') {\n        return { uri: prefix + joinObjectPath(breadcrumbs), versionId: selectedItem !== null && selectedItem !== void 0 ? selectedItem : undefined };\n    }\n    return { uri: prefix + joinObjectPath(__spreadArray(__spreadArray([], breadcrumbs, true), [selectedItem], false)) };\n}\nexport function S3Modal(_a) {\n    var _b;\n    var i18nStrings = _a.i18nStrings, alert = _a.alert, selectableItemsTypes = _a.selectableItemsTypes, fetchBuckets = _a.fetchBuckets, bucketsVisibleColumns = _a.bucketsVisibleColumns, bucketsIsItemDisabled = _a.bucketsIsItemDisabled, fetchObjects = _a.fetchObjects, objectsVisibleColumns = _a.objectsVisibleColumns, objectsIsItemDisabled = _a.objectsIsItemDisabled, fetchVersions = _a.fetchVersions, versionsVisibleColumns = _a.versionsVisibleColumns, versionsIsItemDisabled = _a.versionsIsItemDisabled, onSubmit = _a.onSubmit, onDismiss = _a.onDismiss;\n    var _c = useReducer(s3BrowseReducer, initialBrowseState), _d = _c[0], currentView = _d.currentView, breadcrumbs = _d.breadcrumbs, selectedItem = _d.selectedItem, dispatch = _c[1];\n    var forwardFocusRef = useRef(null);\n    var modalWrapperRef = useRef(null);\n    var isVisualRefresh = useVisualRefresh(modalWrapperRef);\n    useEffectOnUpdate(function () {\n        var _a;\n        (_a = forwardFocusRef.current) === null || _a === void 0 ? void 0 : _a.focus();\n    }, [breadcrumbs]);\n    return (React.createElement(\"div\", { ref: modalWrapperRef },\n        React.createElement(InternalModal, { visible: true, size: \"max\", closeAriaLabel: i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.labelModalDismiss, onDismiss: onDismiss, header: i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.modalTitle, footer: React.createElement(InternalSpaceBetween, { className: styles['modal-actions'], size: \"xs\", direction: \"horizontal\" },\n                React.createElement(InternalButton, { variant: \"link\", formAction: \"none\", onClick: onDismiss }, i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.modalCancelButton),\n                React.createElement(InternalButton, { variant: \"primary\", className: styles['submit-button'], disabled: !selectedItem, formAction: \"none\", onClick: function () { return onSubmit(createResourceInfo({ currentView: currentView, breadcrumbs: breadcrumbs, selectedItem: selectedItem })); } }, i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.modalSubmitButton)) },\n            React.createElement(InternalSpaceBetween, { size: isVisualRefresh ? 'xxs' : 'xs' },\n                React.createElement(InternalBreadcrumbGroup, { ariaLabel: i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.labelBreadcrumbs, onFollow: function (event) {\n                        event.preventDefault();\n                        event.detail.item.meta.onClick();\n                    }, items: __spreadArray([\n                        {\n                            text: (_b = i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.modalBreadcrumbRootItem) !== null && _b !== void 0 ? _b : '',\n                            href: '',\n                            meta: { onClick: function () { return dispatch({ type: 'browse-buckets' }); } }\n                        }\n                    ], breadcrumbs.map(function (segment, index) { return ({\n                        text: segment,\n                        href: '',\n                        meta: {\n                            onClick: function () {\n                                return dispatch({\n                                    type: 'browse-objects',\n                                    breadcrumbs: breadcrumbs.slice(0, index + 1)\n                                });\n                            }\n                        }\n                    }); }), true) }),\n                alert,\n                currentView === 'buckets' ? (React.createElement(BucketsTable, { forwardFocusRef: forwardFocusRef, fetchData: fetchBuckets, visibleColumns: bucketsVisibleColumns, isItemDisabled: bucketsIsItemDisabled, selectableItemsTypes: selectableItemsTypes, i18nStrings: i18nStrings, isVisualRefresh: isVisualRefresh, onDrilldown: function (path) {\n                        return dispatch({\n                            type: 'browse-objects',\n                            breadcrumbs: [path]\n                        });\n                    }, onSelect: function (item) { return dispatch({ type: 'select-item', item: item }); } })) : currentView === 'objects' ? (React.createElement(ObjectsTable, { forwardFocusRef: forwardFocusRef, pathSegments: breadcrumbs, fetchData: fetchObjects, visibleColumns: objectsVisibleColumns, isItemDisabled: objectsIsItemDisabled, selectableItemsTypes: selectableItemsTypes, i18nStrings: i18nStrings, isVisualRefresh: isVisualRefresh, onDrilldown: function (item) {\n                        dispatch({\n                            type: item.IsFolder ? 'browse-objects' : 'browse-versions',\n                            breadcrumbs: __spreadArray(__spreadArray([], breadcrumbs, true), [item.Key], false)\n                        });\n                    }, onSelect: function (item) { return dispatch({ type: 'select-item', item: item }); } })) : currentView === 'versions' ? (React.createElement(VersionsTable, { forwardFocusRef: forwardFocusRef, pathSegments: breadcrumbs, fetchData: fetchVersions, visibleColumns: versionsVisibleColumns, isItemDisabled: versionsIsItemDisabled, i18nStrings: i18nStrings, isVisualRefresh: isVisualRefresh, onSelect: function (item) { return dispatch({ type: 'select-item', item: item }); } })) : (assertNever(currentView))))));\n}\n"]},"metadata":{},"sourceType":"module"}