{"ast":null,"code":"import React, { useEffect, useRef, useState } from 'react';\nimport { addDays, addMonths, isSameMonth, startOfMonth } from 'date-fns';\nimport styles from '../styles.css.js';\nimport TabTrap from '../tab-trap';\nimport CalendarHeader from './header';\nimport Grid from './grid';\nimport moveFocusHandler from './utils/move-focus-handler';\n\nvar Calendar = function (_a) {\n  var locale = _a.locale,\n      startOfWeek = _a.startOfWeek,\n      displayedDate = _a.displayedDate,\n      _b = _a.focusedDate,\n      focusedDate = _b === void 0 ? null : _b,\n      todayAriaLabel = _a.todayAriaLabel,\n      calendarHasFocus = _a.calendarHasFocus,\n      selectedDate = _a.selectedDate,\n      isDateEnabled = _a.isDateEnabled,\n      onChangeMonth = _a.onChangeMonth,\n      onSelectDate = _a.onSelectDate,\n      onFocusDate = _a.onFocusDate,\n      previousMonthLabel = _a.previousMonthLabel,\n      nextMonthLabel = _a.nextMonthLabel;\n  var elementRef = useRef(null);\n  var gridWrapperRef = useRef(null);\n\n  var _c = useState(false),\n      gridHasFocus = _c[0],\n      setGridHasFocus = _c[1];\n\n  var selectFocusedDate = function (selected, baseDate) {\n    if (selected && isDateEnabled(selected) && isSameMonth(selected, baseDate)) {\n      return selected;\n    }\n\n    var today = new Date();\n\n    if (isDateEnabled(today) && isSameMonth(today, baseDate)) {\n      return today;\n    }\n\n    if (isDateEnabled(baseDate)) {\n      return baseDate;\n    }\n\n    return null;\n  };\n\n  var getBaseDate = function (date) {\n    var startDate = startOfMonth(date);\n\n    if (isDateEnabled(startDate)) {\n      return startDate;\n    }\n\n    return moveFocusHandler(startDate, isDateEnabled, function (date) {\n      return addDays(date, 1);\n    });\n  };\n\n  var baseDate = getBaseDate(displayedDate);\n\n  var focusCurrentDate = function () {\n    var _a, _b;\n\n    return (_b = (_a = elementRef.current) === null || _a === void 0 ? void 0 : _a.querySelector(\".\" + styles['calendar-day-focusable'])) === null || _b === void 0 ? void 0 : _b.focus();\n  };\n\n  var focusFirstButton = function () {\n    var _a, _b;\n\n    return (_b = (_a = elementRef.current) === null || _a === void 0 ? void 0 : _a.querySelector(\".\" + styles['calendar-prev-month-btn'])) === null || _b === void 0 ? void 0 : _b.focus();\n  };\n\n  var onHeaderChangeMonthHandler = function (isPrevious) {\n    return onChangeMonth(addMonths(baseDate, isPrevious ? -1 : 1));\n  };\n\n  useEffect(function () {\n    if (focusedDate instanceof Date && isSameMonth(focusedDate, baseDate) && gridHasFocus) {\n      focusCurrentDate();\n    }\n  }, [baseDate, focusedDate, gridHasFocus]);\n  useEffect(function () {\n    var _a;\n\n    var calendarShouldHaveFocus = calendarHasFocus;\n    var calendarActuallyHasFocus = (_a = elementRef.current) === null || _a === void 0 ? void 0 : _a.contains(document.activeElement);\n\n    if (calendarShouldHaveFocus && !calendarActuallyHasFocus) {\n      focusFirstButton();\n    }\n  }, [calendarHasFocus, baseDate, isDateEnabled]);\n\n  if (calendarHasFocus && !focusedDate) {\n    focusedDate = selectFocusedDate(selectedDate, baseDate);\n  }\n\n  var onGridBlur = function (event) {\n    var _a;\n\n    var newFocusTargetIsInGrid = event.relatedTarget && ((_a = gridWrapperRef.current) === null || _a === void 0 ? void 0 : _a.contains(event.relatedTarget));\n\n    if (!newFocusTargetIsInGrid) {\n      setGridHasFocus(false);\n    }\n  };\n\n  var onGridFocus = function () {\n    if (!gridHasFocus) {\n      setGridHasFocus(true);\n    }\n  };\n\n  return React.createElement(\"div\", {\n    className: styles.calendar,\n    role: \"application\",\n    ref: elementRef\n  }, calendarHasFocus && React.createElement(TabTrap, {\n    focusNextCallback: focusCurrentDate\n  }), React.createElement(\"div\", {\n    className: styles['calendar-inner']\n  }, React.createElement(CalendarHeader, {\n    baseDate: baseDate,\n    locale: locale,\n    onChangeMonth: onHeaderChangeMonthHandler,\n    previousMonthLabel: previousMonthLabel,\n    nextMonthLabel: nextMonthLabel,\n    calendarHasFocus: calendarHasFocus\n  }), React.createElement(\"div\", {\n    onBlur: onGridBlur,\n    onFocus: onGridFocus,\n    ref: gridWrapperRef\n  }, React.createElement(Grid, {\n    locale: locale,\n    baseDate: baseDate,\n    isDateEnabled: isDateEnabled,\n    focusedDate: focusedDate,\n    onSelectDate: onSelectDate,\n    onFocusDate: onFocusDate,\n    onChangeMonth: onChangeMonth,\n    startOfWeek: startOfWeek,\n    todayAriaLabel: todayAriaLabel,\n    selectedDate: selectedDate,\n    handleFocusMove: moveFocusHandler\n  }))), calendarHasFocus && React.createElement(TabTrap, {\n    focusNextCallback: focusFirstButton\n  }));\n};\n\nexport default Calendar;","map":{"version":3,"sources":["/Users/isingheg/Desktop/projects/test-react-amplify/node_modules/@awsui/components-react/date-picker/calendar/index.js"],"names":["React","useEffect","useRef","useState","addDays","addMonths","isSameMonth","startOfMonth","styles","TabTrap","CalendarHeader","Grid","moveFocusHandler","Calendar","_a","locale","startOfWeek","displayedDate","_b","focusedDate","todayAriaLabel","calendarHasFocus","selectedDate","isDateEnabled","onChangeMonth","onSelectDate","onFocusDate","previousMonthLabel","nextMonthLabel","elementRef","gridWrapperRef","_c","gridHasFocus","setGridHasFocus","selectFocusedDate","selected","baseDate","today","Date","getBaseDate","date","startDate","focusCurrentDate","current","querySelector","focus","focusFirstButton","onHeaderChangeMonthHandler","isPrevious","calendarShouldHaveFocus","calendarActuallyHasFocus","contains","document","activeElement","onGridBlur","event","newFocusTargetIsInGrid","relatedTarget","onGridFocus","createElement","className","calendar","role","ref","focusNextCallback","onBlur","onFocus","handleFocusMove"],"mappings":"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","sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\nimport { addDays, addMonths, isSameMonth, startOfMonth } from 'date-fns';\nimport styles from '../styles.css.js';\nimport TabTrap from '../tab-trap';\nimport CalendarHeader from './header';\nimport Grid from './grid';\nimport moveFocusHandler from './utils/move-focus-handler';\nvar Calendar = function (_a) {\n    var locale = _a.locale, startOfWeek = _a.startOfWeek, displayedDate = _a.displayedDate, _b = _a.focusedDate, focusedDate = _b === void 0 ? null : _b, todayAriaLabel = _a.todayAriaLabel, calendarHasFocus = _a.calendarHasFocus, selectedDate = _a.selectedDate, isDateEnabled = _a.isDateEnabled, onChangeMonth = _a.onChangeMonth, onSelectDate = _a.onSelectDate, onFocusDate = _a.onFocusDate, previousMonthLabel = _a.previousMonthLabel, nextMonthLabel = _a.nextMonthLabel;\n    var elementRef = useRef(null);\n    var gridWrapperRef = useRef(null);\n    var _c = useState(false), gridHasFocus = _c[0], setGridHasFocus = _c[1];\n    var selectFocusedDate = function (selected, baseDate) {\n        if (selected && isDateEnabled(selected) && isSameMonth(selected, baseDate)) {\n            return selected;\n        }\n        var today = new Date();\n        if (isDateEnabled(today) && isSameMonth(today, baseDate)) {\n            return today;\n        }\n        if (isDateEnabled(baseDate)) {\n            return baseDate;\n        }\n        return null;\n    };\n    var getBaseDate = function (date) {\n        var startDate = startOfMonth(date);\n        if (isDateEnabled(startDate)) {\n            return startDate;\n        }\n        return moveFocusHandler(startDate, isDateEnabled, function (date) { return addDays(date, 1); });\n    };\n    var baseDate = getBaseDate(displayedDate);\n    var focusCurrentDate = function () { var _a, _b; return (_b = (_a = elementRef.current) === null || _a === void 0 ? void 0 : _a.querySelector(\".\" + styles['calendar-day-focusable'])) === null || _b === void 0 ? void 0 : _b.focus(); };\n    var focusFirstButton = function () { var _a, _b; return (_b = (_a = elementRef.current) === null || _a === void 0 ? void 0 : _a.querySelector(\".\" + styles['calendar-prev-month-btn'])) === null || _b === void 0 ? void 0 : _b.focus(); };\n    var onHeaderChangeMonthHandler = function (isPrevious) {\n        return onChangeMonth(addMonths(baseDate, isPrevious ? -1 : 1));\n    };\n    useEffect(function () {\n        if (focusedDate instanceof Date && isSameMonth(focusedDate, baseDate) && gridHasFocus) {\n            focusCurrentDate();\n        }\n    }, [baseDate, focusedDate, gridHasFocus]);\n    useEffect(function () {\n        var _a;\n        var calendarShouldHaveFocus = calendarHasFocus;\n        var calendarActuallyHasFocus = (_a = elementRef.current) === null || _a === void 0 ? void 0 : _a.contains(document.activeElement);\n        if (calendarShouldHaveFocus && !calendarActuallyHasFocus) {\n            focusFirstButton();\n        }\n    }, [calendarHasFocus, baseDate, isDateEnabled]);\n    if (calendarHasFocus && !focusedDate) {\n        focusedDate = selectFocusedDate(selectedDate, baseDate);\n    }\n    var onGridBlur = function (event) {\n        var _a;\n        var newFocusTargetIsInGrid = event.relatedTarget && ((_a = gridWrapperRef.current) === null || _a === void 0 ? void 0 : _a.contains(event.relatedTarget));\n        if (!newFocusTargetIsInGrid) {\n            setGridHasFocus(false);\n        }\n    };\n    var onGridFocus = function () {\n        if (!gridHasFocus) {\n            setGridHasFocus(true);\n        }\n    };\n    return (React.createElement(\"div\", { className: styles.calendar, role: \"application\", ref: elementRef },\n        calendarHasFocus && React.createElement(TabTrap, { focusNextCallback: focusCurrentDate }),\n        React.createElement(\"div\", { className: styles['calendar-inner'] },\n            React.createElement(CalendarHeader, { baseDate: baseDate, locale: locale, onChangeMonth: onHeaderChangeMonthHandler, previousMonthLabel: previousMonthLabel, nextMonthLabel: nextMonthLabel, calendarHasFocus: calendarHasFocus }),\n            React.createElement(\"div\", { onBlur: onGridBlur, onFocus: onGridFocus, ref: gridWrapperRef },\n                React.createElement(Grid, { locale: locale, baseDate: baseDate, isDateEnabled: isDateEnabled, focusedDate: focusedDate, onSelectDate: onSelectDate, onFocusDate: onFocusDate, onChangeMonth: onChangeMonth, startOfWeek: startOfWeek, todayAriaLabel: todayAriaLabel, selectedDate: selectedDate, handleFocusMove: moveFocusHandler }))),\n        calendarHasFocus && React.createElement(TabTrap, { focusNextCallback: focusFirstButton })));\n};\nexport default Calendar;\n"]},"metadata":{},"sourceType":"module"}