{"ast":null,"code":"import { __rest } from \"tslib\";\nimport React, { useCallback, useEffect, useLayoutEffect, useMemo, useRef, useState } from 'react';\nimport { nodeContains } from '../internal/utils/dom';\nimport { useVisualRefresh } from '../internal/hooks/use-visual-mode';\nimport { getXTickCount, getYTickCount, createXTicks, createYTicks } from '../internal/components/cartesian-chart/ticks';\nimport ChartPlot from '../internal/components/chart-plot';\nimport AxisLabel from '../internal/components/cartesian-chart/axis-label';\nimport LabelsMeasure from '../internal/components/cartesian-chart/labels-measure';\nimport LeftLabels from '../internal/components/cartesian-chart/left-labels';\nimport BottomLabels from '../internal/components/cartesian-chart/bottom-labels';\nimport VerticalGridLines from '../internal/components/cartesian-chart/vertical-grid-lines';\nimport EmphasizedBaseline from '../internal/components/cartesian-chart/emphasized-baseline';\nimport HighlightedPoint from '../internal/components/cartesian-chart/highlighted-point';\nimport VerticalMarker from '../internal/components/cartesian-chart/vertical-marker';\nimport { ChartScale, NumericChartScale } from '../internal/components/cartesian-chart/scales';\nimport ChartPopover from './chart-popover';\nimport { computeDomainX, computeDomainY } from './utils';\nimport makeScaledSeries from './make-scaled-series';\nimport makeScaledBarGroups from './make-scaled-bar-groups';\nimport formatHighlighted from './format-highlighted';\nimport DataSeries from './data-series';\nimport BarGroups from './bar-groups';\nimport { useMouseHover } from './hooks/use-mouse-hover';\nimport { useNavigation } from './hooks/use-navigation';\nimport { usePopover } from './hooks/use-popover';\nimport styles from './styles.css.js';\nimport useContainerWidth from '../internal/utils/use-container-width';\nvar LEFT_LABELS_MARGIN = 16;\nvar BOTTOM_LABELS_OFFSET = 12;\nexport default function ChartContainer(_a) {\n  var _b;\n\n  var plotHeight = _a.height,\n      series = _a.series,\n      visibleSeries = _a.visibleSeries,\n      highlightedSeries = _a.highlightedSeries,\n      onHighlightChange = _a.onHighlightChange,\n      highlightedPoint = _a.highlightedPoint,\n      setHighlightedPoint = _a.setHighlightedPoint,\n      highlightedGroupIndex = _a.highlightedGroupIndex,\n      setHighlightedGroupIndex = _a.setHighlightedGroupIndex,\n      legendSeries = _a.legendSeries,\n      _c = _a.detailPopoverSize,\n      detailPopoverSize = _c === void 0 ? 'medium' : _c,\n      _d = _a.stackedBars,\n      stackedBars = _d === void 0 ? false : _d,\n      _e = _a.horizontalBars,\n      horizontalBars = _e === void 0 ? false : _e,\n      xScaleType = _a.xScaleType,\n      yScaleType = _a.yScaleType,\n      xTickFormatter = _a.xTickFormatter,\n      yTickFormatter = _a.yTickFormatter,\n      emphasizeBaselineAxis = _a.emphasizeBaselineAxis,\n      xTitle = _a.xTitle,\n      yTitle = _a.yTitle,\n      ariaLabel = _a.ariaLabel,\n      ariaLabelledby = _a.ariaLabelledby,\n      ariaDescription = _a.ariaDescription,\n      _f = _a.i18nStrings,\n      i18nStrings = _f === void 0 ? {} : _f,\n      props = __rest(_a, [\"height\", \"series\", \"visibleSeries\", \"highlightedSeries\", \"onHighlightChange\", \"highlightedPoint\", \"setHighlightedPoint\", \"highlightedGroupIndex\", \"setHighlightedGroupIndex\", \"legendSeries\", \"detailPopoverSize\", \"stackedBars\", \"horizontalBars\", \"xScaleType\", \"yScaleType\", \"xTickFormatter\", \"yTickFormatter\", \"emphasizeBaselineAxis\", \"xTitle\", \"yTitle\", \"ariaLabel\", \"ariaLabelledby\", \"ariaDescription\", \"i18nStrings\"]);\n\n  var plotRef = useRef(null);\n  var verticalMarkerRef = useRef(null);\n\n  var _g = useState(0),\n      leftLabelsWidth = _g[0],\n      setLeftLabelsWidth = _g[1];\n\n  var _h = useState(0),\n      bottomLabelsHeight = _h[0],\n      setBottomLabelsHeight = _h[1];\n\n  var _j = useContainerWidth(500),\n      containerWidth = _j[0],\n      containerRef = _j[1];\n\n  var plotWidth = containerWidth ? containerWidth - leftLabelsWidth - LEFT_LABELS_MARGIN : 500;\n  var isRefresh = useVisualRefresh(containerRef);\n  var linesOnly = series.every(function (_a) {\n    var series = _a.series;\n    return series.type === 'line' || series.type === 'threshold';\n  });\n  var xDomain = props.xDomain || computeDomainX(series, xScaleType);\n  var yDomain = props.yDomain || computeDomainY(series, yScaleType, stackedBars);\n  var xTickCount = getXTickCount(plotWidth);\n  var yTickCount = getYTickCount(plotHeight);\n  var rangeBottomTop = [0, plotHeight];\n  var rangeTopBottom = [plotHeight, 0];\n  var rangeLeftRight = [0, plotWidth];\n  var xScale = new ChartScale(xScaleType, xDomain, horizontalBars ? rangeBottomTop : rangeLeftRight, linesOnly);\n  var yScale = new NumericChartScale(yScaleType, yDomain, horizontalBars ? rangeLeftRight : rangeTopBottom, props.yDomain ? null : yTickCount);\n  var xTicks = createXTicks(xScale, xTickCount);\n  var yTicks = createYTicks(yScale, yTickCount);\n  var highlightedPointRef = useRef(null);\n  var highlightedGroupRef = useRef(null);\n\n  var _k = useState(false),\n      isPlotFocused = _k[0],\n      setPlotFocused = _k[1];\n\n  var x = !horizontalBars ? 'x' : 'y';\n  var y = !horizontalBars ? 'y' : 'x';\n  var xy = {\n    ticks: {\n      x: xTicks,\n      y: yTicks\n    },\n    scale: {\n      x: xScale,\n      y: yScale\n    },\n    tickFormatter: {\n      x: xTickFormatter,\n      y: yTickFormatter\n    },\n    title: {\n      x: xTitle,\n      y: yTitle\n    },\n    ariaRoleDescription: {\n      x: i18nStrings.xAxisAriaRoleDescription,\n      y: i18nStrings.yAxisAriaRoleDescription\n    }\n  };\n  var scaledSeries = makeScaledSeries(visibleSeries, xScale, yScale);\n  var barGroups = makeScaledBarGroups(visibleSeries, xScale, plotWidth, plotHeight, y);\n\n  var _l = usePopover(),\n      isPopoverOpen = _l.isPopoverOpen,\n      isPopoverPinned = _l.isPopoverPinned,\n      showPopover = _l.showPopover,\n      pinPopover = _l.pinPopover,\n      dismissPopover = _l.dismissPopover;\n\n  var _m = useState(!isPopoverPinned),\n      isHandlersDisabled = _m[0],\n      setHandlersDisabled = _m[1];\n\n  useEffect(function () {\n    if (isPopoverPinned) {\n      setHandlersDisabled(true);\n    } else {\n      var timeoutId_1 = setTimeout(function () {\n        return setHandlersDisabled(false);\n      }, 25);\n      return function () {\n        return clearTimeout(timeoutId_1);\n      };\n    }\n  }, [isPopoverPinned]);\n  var highlightPoint = useCallback(function (point) {\n    setHighlightedGroupIndex(null);\n    setHighlightedPoint(point);\n  }, [setHighlightedPoint, setHighlightedGroupIndex]);\n  var highlightSeries = useCallback(function (series) {\n    if (series !== highlightedSeries) {\n      onHighlightChange(series);\n    }\n  }, [highlightedSeries, onHighlightChange]);\n  var highlightGroup = useCallback(function (groupIndex) {\n    highlightSeries(null);\n    setHighlightedPoint(null);\n    setHighlightedGroupIndex(groupIndex);\n  }, [highlightSeries, setHighlightedPoint, setHighlightedGroupIndex]);\n  var clearHighlightedSeries = useCallback(function () {\n    highlightSeries(null);\n    setHighlightedGroupIndex(null);\n    setHighlightedPoint(null);\n    dismissPopover();\n  }, [dismissPopover, highlightSeries, setHighlightedGroupIndex, setHighlightedPoint]);\n\n  var _o = useNavigation({\n    series: series,\n    visibleSeries: visibleSeries,\n    scaledSeries: scaledSeries,\n    barGroups: barGroups,\n    xScale: xScale,\n    yScale: yScale,\n    highlightedPoint: highlightedPoint,\n    highlightedGroupIndex: highlightedGroupIndex,\n    highlightedSeries: highlightedSeries,\n    legendSeries: legendSeries,\n    isHandlersDisabled: isHandlersDisabled,\n    pinPopover: pinPopover,\n    highlightSeries: highlightSeries,\n    highlightGroup: highlightGroup,\n    highlightPoint: highlightPoint,\n    clearHighlightedSeries: clearHighlightedSeries\n  }),\n      isGroupNavigation = _o.isGroupNavigation,\n      handlers = __rest(_o, [\"isGroupNavigation\"]);\n\n  var _p = useMouseHover({\n    scaledSeries: scaledSeries,\n    barGroups: barGroups,\n    plotRef: plotRef,\n    highlightSeries: highlightSeries,\n    highlightPoint: highlightPoint,\n    highlightGroup: highlightGroup,\n    clearHighlightedSeries: clearHighlightedSeries,\n    isGroupNavigation: isGroupNavigation,\n    isHandlersDisabled: isHandlersDisabled\n  }),\n      onSVGMouseMove = _p.onSVGMouseMove,\n      onSVGMouseOut = _p.onSVGMouseOut,\n      verticalMarkerLeft = _p.verticalMarkerLeft;\n\n  var highlightedX = useMemo(function () {\n    var _a, _b, _c, _d;\n\n    if (highlightedGroupIndex !== null) {\n      return barGroups[highlightedGroupIndex].x;\n    }\n\n    if (verticalMarkerLeft !== null) {\n      for (var _i = 0, scaledSeries_1 = scaledSeries; _i < scaledSeries_1.length; _i++) {\n        var series_1 = scaledSeries_1[_i];\n\n        if (series_1.x === verticalMarkerLeft) {\n          return (_b = (_a = series_1.datum) === null || _a === void 0 ? void 0 : _a.x) !== null && _b !== void 0 ? _b : null;\n        }\n      }\n    }\n\n    if (highlightedPoint !== null) {\n      return (_d = (_c = highlightedPoint === null || highlightedPoint === void 0 ? void 0 : highlightedPoint.datum) === null || _c === void 0 ? void 0 : _c.x) !== null && _d !== void 0 ? _d : null;\n    }\n\n    return null;\n  }, [highlightedPoint, verticalMarkerLeft, highlightedGroupIndex, scaledSeries, barGroups]);\n\n  var onPopoverDismiss = function (outsideClick) {\n    dismissPopover();\n\n    if (!outsideClick) {\n      setTimeout(function () {\n        var _a, _b;\n\n        if (highlightedPoint || highlightedGroupIndex !== null) {\n          (_a = plotRef.current) === null || _a === void 0 ? void 0 : _a.focusApplication();\n        } else {\n          (_b = plotRef.current) === null || _b === void 0 ? void 0 : _b.focusPlot();\n        }\n      }, 0);\n    }\n  };\n\n  useLayoutEffect(function () {\n    if (highlightedX !== null) {\n      showPopover();\n    }\n  }, [highlightedX, showPopover]);\n\n  var onSVGMouseDown = function () {\n    if (isPopoverOpen) {\n      if (isPopoverPinned) {\n        dismissPopover();\n      } else {\n        pinPopover();\n      }\n    } else {\n      showPopover();\n    }\n  };\n\n  var onSVGFocus = function (event, trigger) {\n    setPlotFocused(true);\n\n    if (trigger === 'keyboard') {\n      handlers.onFocus();\n    } else {}\n  };\n\n  var onSVGBlur = function (event) {\n    setPlotFocused(false);\n    var blurTarget = event.relatedTarget || event.target;\n\n    if (blurTarget === null || !(blurTarget instanceof Element) || !nodeContains(containerRef.current, blurTarget)) {\n      clearHighlightedSeries();\n\n      if (isPopoverOpen && !isPopoverPinned) {\n        dismissPopover();\n      }\n    }\n  };\n\n  var onSVGKeyDown = handlers.onKeyDown;\n  var xOffset = xScale.isCategorical() ? Math.max(0, xScale.d3Scale.bandwidth() - 1) / 2 : 0;\n  var verticalLineX = null;\n\n  if (verticalMarkerLeft !== null) {\n    verticalLineX = verticalMarkerLeft;\n  } else if (isGroupNavigation && highlightedGroupIndex !== null) {\n    var x_1 = (_b = xScale.d3Scale(barGroups[highlightedGroupIndex].x)) !== null && _b !== void 0 ? _b : null;\n\n    if (x_1 !== null) {\n      verticalLineX = xOffset + x_1;\n    }\n  }\n\n  var point = useMemo(function () {\n    return highlightedPoint ? {\n      key: highlightedPoint.x + \"-\" + highlightedPoint.y,\n      x: highlightedPoint.x,\n      y: highlightedPoint.y,\n      color: highlightedPoint.color\n    } : null;\n  }, [highlightedPoint]);\n  var verticalMarkers = useMemo(function () {\n    return verticalLineX !== null ? scaledSeries.filter(function (_a) {\n      var x = _a.x;\n      return x === verticalLineX || isNaN(x);\n    }).map(function (_a, index) {\n      var x = _a.x,\n          y = _a.y,\n          color = _a.color;\n      return {\n        key: index + \"-\" + x + \"-\" + y,\n        x: !horizontalBars ? verticalLineX || 0 : y,\n        y: !horizontalBars ? y : verticalLineX || 0,\n        color: color\n      };\n    }) : [];\n  }, [scaledSeries, verticalLineX, horizontalBars]);\n  var popoverTrackRef = isGroupNavigation ? highlightedGroupRef : highlightedPoint ? highlightedPointRef : verticalMarkerRef;\n  var highlightDetails = useMemo(function () {\n    if (highlightedX === null) {\n      return null;\n    }\n\n    for (var _i = 0, visibleSeries_1 = visibleSeries; _i < visibleSeries_1.length; _i++) {\n      var series_2 = visibleSeries_1[_i];\n\n      if (series_2.series === (highlightedPoint === null || highlightedPoint === void 0 ? void 0 : highlightedPoint.series)) {\n        return formatHighlighted(highlightedX, [series_2], xTickFormatter);\n      }\n    }\n\n    return formatHighlighted(highlightedX, visibleSeries, xTickFormatter);\n  }, [highlightedX, highlightedPoint, visibleSeries, xTickFormatter]);\n  var activeAriaLabel = useMemo(function () {\n    return highlightDetails ? highlightDetails.position + \", \" + highlightDetails.details.map(function (d) {\n      return d.key + ' ' + d.value;\n    }).join(',') : '';\n  }, [highlightDetails]);\n  var activeLiveRegion = activeAriaLabel && !highlightedPoint && highlightedGroupIndex === null ? activeAriaLabel : '';\n  return React.createElement(\"div\", {\n    className: styles['chart-container'],\n    ref: containerRef\n  }, React.createElement(AxisLabel, {\n    axis: y,\n    position: \"left\",\n    title: xy.title[y]\n  }), React.createElement(\"div\", {\n    className: styles['chart-container__horizontal']\n  }, React.createElement(LabelsMeasure, {\n    ticks: xy.ticks[y],\n    scale: xy.scale[y],\n    tickFormatter: xy.tickFormatter[y],\n    autoWidth: setLeftLabelsWidth\n  }), React.createElement(\"div\", {\n    className: styles['chart-container__vertical']\n  }, React.createElement(ChartPlot, {\n    ref: plotRef,\n    width: plotWidth,\n    height: plotHeight,\n    offsetBottom: bottomLabelsHeight,\n    isClickable: isPopoverOpen && !isPopoverPinned,\n    ariaLabel: ariaLabel,\n    ariaLabelledby: ariaLabelledby,\n    ariaDescription: ariaDescription,\n    ariaRoleDescription: i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.chartAriaRoleDescription,\n    ariaLiveRegion: activeLiveRegion,\n    activeElementRef: isGroupNavigation ? highlightedGroupRef : highlightedPointRef,\n    activeElementKey: isPlotFocused && ((highlightedGroupIndex === null || highlightedGroupIndex === void 0 ? void 0 : highlightedGroupIndex.toString()) || (point === null || point === void 0 ? void 0 : point.key)),\n    activeElementFocusOffset: isGroupNavigation ? 0 : 3,\n    onMouseMove: onSVGMouseMove,\n    onMouseOut: onSVGMouseOut,\n    onMouseDown: onSVGMouseDown,\n    onFocus: onSVGFocus,\n    onBlur: onSVGBlur,\n    onKeyDown: onSVGKeyDown\n  }, React.createElement(LeftLabels, {\n    axis: y,\n    ticks: xy.ticks[y],\n    scale: xy.scale[y],\n    tickFormatter: xy.tickFormatter[y],\n    title: xy.title[y],\n    ariaRoleDescription: xy.ariaRoleDescription[y],\n    width: plotWidth,\n    height: plotHeight\n  }), horizontalBars && React.createElement(VerticalGridLines, {\n    scale: yScale,\n    ticks: yTicks,\n    height: plotHeight\n  }), emphasizeBaselineAxis && linesOnly && React.createElement(EmphasizedBaseline, {\n    axis: x,\n    scale: yScale,\n    width: plotWidth,\n    height: plotHeight\n  }), React.createElement(DataSeries, {\n    axis: x,\n    plotWidth: plotWidth,\n    plotHeight: plotHeight,\n    highlightedSeries: highlightedSeries !== null && highlightedSeries !== void 0 ? highlightedSeries : null,\n    highlightedGroupIndex: highlightedGroupIndex,\n    stackedBars: stackedBars,\n    isGroupNavigation: isGroupNavigation,\n    visibleSeries: visibleSeries,\n    xScale: xScale,\n    yScale: yScale\n  }), emphasizeBaselineAxis && !linesOnly && React.createElement(EmphasizedBaseline, {\n    axis: x,\n    scale: yScale,\n    width: plotWidth,\n    height: plotHeight\n  }), React.createElement(VerticalMarker, {\n    key: verticalLineX || '',\n    height: plotHeight,\n    showPoints: highlightedPoint === null,\n    showLine: !isGroupNavigation,\n    points: verticalMarkers,\n    ref: verticalMarkerRef\n  }), highlightedPoint && React.createElement(HighlightedPoint, {\n    ref: highlightedPointRef,\n    point: point,\n    role: \"button\",\n    ariaLabel: activeAriaLabel,\n    ariaHasPopup: true,\n    ariaExpanded: isPopoverPinned\n  }), isGroupNavigation && xScale.isCategorical() && React.createElement(BarGroups, {\n    ariaLabel: activeAriaLabel,\n    isRefresh: isRefresh,\n    isPopoverPinned: isPopoverPinned,\n    barGroups: barGroups,\n    highlightedGroupIndex: highlightedGroupIndex,\n    highlightedGroupRef: highlightedGroupRef\n  }), React.createElement(BottomLabels, {\n    axis: x,\n    ticks: xy.ticks[x],\n    scale: xy.scale[x],\n    tickFormatter: xy.tickFormatter[x],\n    title: xy.title[x],\n    ariaRoleDescription: xy.ariaRoleDescription[x],\n    height: plotHeight,\n    width: plotWidth,\n    offsetLeft: leftLabelsWidth + BOTTOM_LABELS_OFFSET,\n    offsetRight: BOTTOM_LABELS_OFFSET,\n    autoHeight: setBottomLabelsHeight\n  })), React.createElement(AxisLabel, {\n    axis: x,\n    position: \"bottom\",\n    title: xy.title[x]\n  })), React.createElement(ChartPopover, {\n    containerRef: containerRef,\n    trackRef: popoverTrackRef,\n    isOpen: isPopoverOpen,\n    isPinned: isPopoverPinned,\n    highlightDetails: highlightDetails,\n    onDismiss: onPopoverDismiss,\n    size: detailPopoverSize,\n    dismissAriaLabel: i18nStrings.detailPopoverDismissAriaLabel\n  })));\n}","map":{"version":3,"sources":["/Users/isingheg/Desktop/projects/amazonforvolunteers-ui/node_modules/@awsui/components-react/mixed-line-bar-chart/chart-container.js"],"names":["__rest","React","useCallback","useEffect","useLayoutEffect","useMemo","useRef","useState","nodeContains","useVisualRefresh","getXTickCount","getYTickCount","createXTicks","createYTicks","ChartPlot","AxisLabel","LabelsMeasure","LeftLabels","BottomLabels","VerticalGridLines","EmphasizedBaseline","HighlightedPoint","VerticalMarker","ChartScale","NumericChartScale","ChartPopover","computeDomainX","computeDomainY","makeScaledSeries","makeScaledBarGroups","formatHighlighted","DataSeries","BarGroups","useMouseHover","useNavigation","usePopover","styles","useContainerWidth","LEFT_LABELS_MARGIN","BOTTOM_LABELS_OFFSET","ChartContainer","_a","_b","plotHeight","height","series","visibleSeries","highlightedSeries","onHighlightChange","highlightedPoint","setHighlightedPoint","highlightedGroupIndex","setHighlightedGroupIndex","legendSeries","_c","detailPopoverSize","_d","stackedBars","_e","horizontalBars","xScaleType","yScaleType","xTickFormatter","yTickFormatter","emphasizeBaselineAxis","xTitle","yTitle","ariaLabel","ariaLabelledby","ariaDescription","_f","i18nStrings","props","plotRef","verticalMarkerRef","_g","leftLabelsWidth","setLeftLabelsWidth","_h","bottomLabelsHeight","setBottomLabelsHeight","_j","containerWidth","containerRef","plotWidth","isRefresh","linesOnly","every","type","xDomain","yDomain","xTickCount","yTickCount","rangeBottomTop","rangeTopBottom","rangeLeftRight","xScale","yScale","xTicks","yTicks","highlightedPointRef","highlightedGroupRef","_k","isPlotFocused","setPlotFocused","x","y","xy","ticks","scale","tickFormatter","title","ariaRoleDescription","xAxisAriaRoleDescription","yAxisAriaRoleDescription","scaledSeries","barGroups","_l","isPopoverOpen","isPopoverPinned","showPopover","pinPopover","dismissPopover","_m","isHandlersDisabled","setHandlersDisabled","timeoutId_1","setTimeout","clearTimeout","highlightPoint","point","highlightSeries","highlightGroup","groupIndex","clearHighlightedSeries","_o","isGroupNavigation","handlers","_p","onSVGMouseMove","onSVGMouseOut","verticalMarkerLeft","highlightedX","_i","scaledSeries_1","length","series_1","datum","onPopoverDismiss","outsideClick","current","focusApplication","focusPlot","onSVGMouseDown","onSVGFocus","event","trigger","onFocus","onSVGBlur","blurTarget","relatedTarget","target","Element","onSVGKeyDown","onKeyDown","xOffset","isCategorical","Math","max","d3Scale","bandwidth","verticalLineX","x_1","key","color","verticalMarkers","filter","isNaN","map","index","popoverTrackRef","highlightDetails","visibleSeries_1","series_2","activeAriaLabel","position","details","d","value","join","activeLiveRegion","createElement","className","ref","axis","autoWidth","width","offsetBottom","isClickable","chartAriaRoleDescription","ariaLiveRegion","activeElementRef","activeElementKey","toString","activeElementFocusOffset","onMouseMove","onMouseOut","onMouseDown","onBlur","showPoints","showLine","points","role","ariaHasPopup","ariaExpanded","offsetLeft","offsetRight","autoHeight","trackRef","isOpen","isPinned","onDismiss","size","dismissAriaLabel","detailPopoverDismissAriaLabel"],"mappings":"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","sourcesContent":["import { __rest } from \"tslib\";\nimport React, { useCallback, useEffect, useLayoutEffect, useMemo, useRef, useState } from 'react';\nimport { nodeContains } from '../internal/utils/dom';\nimport { useVisualRefresh } from '../internal/hooks/use-visual-mode';\nimport { getXTickCount, getYTickCount, createXTicks, createYTicks } from '../internal/components/cartesian-chart/ticks';\nimport ChartPlot from '../internal/components/chart-plot';\nimport AxisLabel from '../internal/components/cartesian-chart/axis-label';\nimport LabelsMeasure from '../internal/components/cartesian-chart/labels-measure';\nimport LeftLabels from '../internal/components/cartesian-chart/left-labels';\nimport BottomLabels from '../internal/components/cartesian-chart/bottom-labels';\nimport VerticalGridLines from '../internal/components/cartesian-chart/vertical-grid-lines';\nimport EmphasizedBaseline from '../internal/components/cartesian-chart/emphasized-baseline';\nimport HighlightedPoint from '../internal/components/cartesian-chart/highlighted-point';\nimport VerticalMarker from '../internal/components/cartesian-chart/vertical-marker';\nimport { ChartScale, NumericChartScale } from '../internal/components/cartesian-chart/scales';\nimport ChartPopover from './chart-popover';\nimport { computeDomainX, computeDomainY } from './utils';\nimport makeScaledSeries from './make-scaled-series';\nimport makeScaledBarGroups from './make-scaled-bar-groups';\nimport formatHighlighted from './format-highlighted';\nimport DataSeries from './data-series';\nimport BarGroups from './bar-groups';\nimport { useMouseHover } from './hooks/use-mouse-hover';\nimport { useNavigation } from './hooks/use-navigation';\nimport { usePopover } from './hooks/use-popover';\nimport styles from './styles.css.js';\nimport useContainerWidth from '../internal/utils/use-container-width';\nvar LEFT_LABELS_MARGIN = 16;\nvar BOTTOM_LABELS_OFFSET = 12;\nexport default function ChartContainer(_a) {\n    var _b;\n    var plotHeight = _a.height, series = _a.series, visibleSeries = _a.visibleSeries, highlightedSeries = _a.highlightedSeries, onHighlightChange = _a.onHighlightChange, highlightedPoint = _a.highlightedPoint, setHighlightedPoint = _a.setHighlightedPoint, highlightedGroupIndex = _a.highlightedGroupIndex, setHighlightedGroupIndex = _a.setHighlightedGroupIndex, legendSeries = _a.legendSeries, _c = _a.detailPopoverSize, detailPopoverSize = _c === void 0 ? 'medium' : _c, _d = _a.stackedBars, stackedBars = _d === void 0 ? false : _d, _e = _a.horizontalBars, horizontalBars = _e === void 0 ? false : _e, xScaleType = _a.xScaleType, yScaleType = _a.yScaleType, xTickFormatter = _a.xTickFormatter, yTickFormatter = _a.yTickFormatter, emphasizeBaselineAxis = _a.emphasizeBaselineAxis, xTitle = _a.xTitle, yTitle = _a.yTitle, ariaLabel = _a.ariaLabel, ariaLabelledby = _a.ariaLabelledby, ariaDescription = _a.ariaDescription, _f = _a.i18nStrings, i18nStrings = _f === void 0 ? {} : _f, props = __rest(_a, [\"height\", \"series\", \"visibleSeries\", \"highlightedSeries\", \"onHighlightChange\", \"highlightedPoint\", \"setHighlightedPoint\", \"highlightedGroupIndex\", \"setHighlightedGroupIndex\", \"legendSeries\", \"detailPopoverSize\", \"stackedBars\", \"horizontalBars\", \"xScaleType\", \"yScaleType\", \"xTickFormatter\", \"yTickFormatter\", \"emphasizeBaselineAxis\", \"xTitle\", \"yTitle\", \"ariaLabel\", \"ariaLabelledby\", \"ariaDescription\", \"i18nStrings\"]);\n    var plotRef = useRef(null);\n    var verticalMarkerRef = useRef(null);\n    var _g = useState(0), leftLabelsWidth = _g[0], setLeftLabelsWidth = _g[1];\n    var _h = useState(0), bottomLabelsHeight = _h[0], setBottomLabelsHeight = _h[1];\n    var _j = useContainerWidth(500), containerWidth = _j[0], containerRef = _j[1];\n    var plotWidth = containerWidth ? containerWidth - leftLabelsWidth - LEFT_LABELS_MARGIN : 500;\n    var isRefresh = useVisualRefresh(containerRef);\n    var linesOnly = series.every(function (_a) {\n        var series = _a.series;\n        return series.type === 'line' || series.type === 'threshold';\n    });\n    var xDomain = (props.xDomain || computeDomainX(series, xScaleType));\n    var yDomain = (props.yDomain || computeDomainY(series, yScaleType, stackedBars));\n    var xTickCount = getXTickCount(plotWidth);\n    var yTickCount = getYTickCount(plotHeight);\n    var rangeBottomTop = [0, plotHeight];\n    var rangeTopBottom = [plotHeight, 0];\n    var rangeLeftRight = [0, plotWidth];\n    var xScale = new ChartScale(xScaleType, xDomain, horizontalBars ? rangeBottomTop : rangeLeftRight, linesOnly);\n    var yScale = new NumericChartScale(yScaleType, yDomain, horizontalBars ? rangeLeftRight : rangeTopBottom, props.yDomain ? null : yTickCount);\n    var xTicks = createXTicks(xScale, xTickCount);\n    var yTicks = createYTicks(yScale, yTickCount);\n    var highlightedPointRef = useRef(null);\n    var highlightedGroupRef = useRef(null);\n    var _k = useState(false), isPlotFocused = _k[0], setPlotFocused = _k[1];\n    var x = !horizontalBars ? 'x' : 'y';\n    var y = !horizontalBars ? 'y' : 'x';\n    var xy = {\n        ticks: { x: xTicks, y: yTicks },\n        scale: { x: xScale, y: yScale },\n        tickFormatter: { x: xTickFormatter, y: yTickFormatter },\n        title: { x: xTitle, y: yTitle },\n        ariaRoleDescription: { x: i18nStrings.xAxisAriaRoleDescription, y: i18nStrings.yAxisAriaRoleDescription }\n    };\n    var scaledSeries = makeScaledSeries(visibleSeries, xScale, yScale);\n    var barGroups = makeScaledBarGroups(visibleSeries, xScale, plotWidth, plotHeight, y);\n    var _l = usePopover(), isPopoverOpen = _l.isPopoverOpen, isPopoverPinned = _l.isPopoverPinned, showPopover = _l.showPopover, pinPopover = _l.pinPopover, dismissPopover = _l.dismissPopover;\n    var _m = useState(!isPopoverPinned), isHandlersDisabled = _m[0], setHandlersDisabled = _m[1];\n    useEffect(function () {\n        if (isPopoverPinned) {\n            setHandlersDisabled(true);\n        }\n        else {\n            var timeoutId_1 = setTimeout(function () { return setHandlersDisabled(false); }, 25);\n            return function () { return clearTimeout(timeoutId_1); };\n        }\n    }, [isPopoverPinned]);\n    var highlightPoint = useCallback(function (point) {\n        setHighlightedGroupIndex(null);\n        setHighlightedPoint(point);\n    }, [setHighlightedPoint, setHighlightedGroupIndex]);\n    var highlightSeries = useCallback(function (series) {\n        if (series !== highlightedSeries) {\n            onHighlightChange(series);\n        }\n    }, [highlightedSeries, onHighlightChange]);\n    var highlightGroup = useCallback(function (groupIndex) {\n        highlightSeries(null);\n        setHighlightedPoint(null);\n        setHighlightedGroupIndex(groupIndex);\n    }, [highlightSeries, setHighlightedPoint, setHighlightedGroupIndex]);\n    var clearHighlightedSeries = useCallback(function () {\n        highlightSeries(null);\n        setHighlightedGroupIndex(null);\n        setHighlightedPoint(null);\n        dismissPopover();\n    }, [dismissPopover, highlightSeries, setHighlightedGroupIndex, setHighlightedPoint]);\n    var _o = useNavigation({\n        series: series,\n        visibleSeries: visibleSeries,\n        scaledSeries: scaledSeries,\n        barGroups: barGroups,\n        xScale: xScale,\n        yScale: yScale,\n        highlightedPoint: highlightedPoint,\n        highlightedGroupIndex: highlightedGroupIndex,\n        highlightedSeries: highlightedSeries,\n        legendSeries: legendSeries,\n        isHandlersDisabled: isHandlersDisabled,\n        pinPopover: pinPopover,\n        highlightSeries: highlightSeries,\n        highlightGroup: highlightGroup,\n        highlightPoint: highlightPoint,\n        clearHighlightedSeries: clearHighlightedSeries\n    }), isGroupNavigation = _o.isGroupNavigation, handlers = __rest(_o, [\"isGroupNavigation\"]);\n    var _p = useMouseHover({\n        scaledSeries: scaledSeries,\n        barGroups: barGroups,\n        plotRef: plotRef,\n        highlightSeries: highlightSeries,\n        highlightPoint: highlightPoint,\n        highlightGroup: highlightGroup,\n        clearHighlightedSeries: clearHighlightedSeries,\n        isGroupNavigation: isGroupNavigation,\n        isHandlersDisabled: isHandlersDisabled\n    }), onSVGMouseMove = _p.onSVGMouseMove, onSVGMouseOut = _p.onSVGMouseOut, verticalMarkerLeft = _p.verticalMarkerLeft;\n    var highlightedX = useMemo(function () {\n        var _a, _b, _c, _d;\n        if (highlightedGroupIndex !== null) {\n            return barGroups[highlightedGroupIndex].x;\n        }\n        if (verticalMarkerLeft !== null) {\n            for (var _i = 0, scaledSeries_1 = scaledSeries; _i < scaledSeries_1.length; _i++) {\n                var series_1 = scaledSeries_1[_i];\n                if (series_1.x === verticalMarkerLeft) {\n                    return (_b = (_a = series_1.datum) === null || _a === void 0 ? void 0 : _a.x) !== null && _b !== void 0 ? _b : null;\n                }\n            }\n        }\n        if (highlightedPoint !== null) {\n            return (_d = (_c = highlightedPoint === null || highlightedPoint === void 0 ? void 0 : highlightedPoint.datum) === null || _c === void 0 ? void 0 : _c.x) !== null && _d !== void 0 ? _d : null;\n        }\n        return null;\n    }, [highlightedPoint, verticalMarkerLeft, highlightedGroupIndex, scaledSeries, barGroups]);\n    var onPopoverDismiss = function (outsideClick) {\n        dismissPopover();\n        if (!outsideClick) {\n            setTimeout(function () {\n                var _a, _b;\n                if (highlightedPoint || highlightedGroupIndex !== null) {\n                    (_a = plotRef.current) === null || _a === void 0 ? void 0 : _a.focusApplication();\n                }\n                else {\n                    (_b = plotRef.current) === null || _b === void 0 ? void 0 : _b.focusPlot();\n                }\n            }, 0);\n        }\n    };\n    useLayoutEffect(function () {\n        if (highlightedX !== null) {\n            showPopover();\n        }\n    }, [highlightedX, showPopover]);\n    var onSVGMouseDown = function () {\n        if (isPopoverOpen) {\n            if (isPopoverPinned) {\n                dismissPopover();\n            }\n            else {\n                pinPopover();\n            }\n        }\n        else {\n            showPopover();\n        }\n    };\n    var onSVGFocus = function (event, trigger) {\n        setPlotFocused(true);\n        if (trigger === 'keyboard') {\n            handlers.onFocus();\n        }\n        else {\n        }\n    };\n    var onSVGBlur = function (event) {\n        setPlotFocused(false);\n        var blurTarget = event.relatedTarget || event.target;\n        if (blurTarget === null || !(blurTarget instanceof Element) || !nodeContains(containerRef.current, blurTarget)) {\n            clearHighlightedSeries();\n            if (isPopoverOpen && !isPopoverPinned) {\n                dismissPopover();\n            }\n        }\n    };\n    var onSVGKeyDown = handlers.onKeyDown;\n    var xOffset = xScale.isCategorical() ? Math.max(0, xScale.d3Scale.bandwidth() - 1) / 2 : 0;\n    var verticalLineX = null;\n    if (verticalMarkerLeft !== null) {\n        verticalLineX = verticalMarkerLeft;\n    }\n    else if (isGroupNavigation && highlightedGroupIndex !== null) {\n        var x_1 = (_b = xScale.d3Scale(barGroups[highlightedGroupIndex].x)) !== null && _b !== void 0 ? _b : null;\n        if (x_1 !== null) {\n            verticalLineX = xOffset + x_1;\n        }\n    }\n    var point = useMemo(function () {\n        return highlightedPoint\n            ? {\n                key: highlightedPoint.x + \"-\" + highlightedPoint.y,\n                x: highlightedPoint.x,\n                y: highlightedPoint.y,\n                color: highlightedPoint.color\n            }\n            : null;\n    }, [highlightedPoint]);\n    var verticalMarkers = useMemo(function () {\n        return verticalLineX !== null\n            ? scaledSeries\n                .filter(function (_a) {\n                var x = _a.x;\n                return x === verticalLineX || isNaN(x);\n            })\n                .map(function (_a, index) {\n                var x = _a.x, y = _a.y, color = _a.color;\n                return ({\n                    key: index + \"-\" + x + \"-\" + y,\n                    x: !horizontalBars ? verticalLineX || 0 : y,\n                    y: !horizontalBars ? y : verticalLineX || 0,\n                    color: color\n                });\n            })\n            : [];\n    }, [scaledSeries, verticalLineX, horizontalBars]);\n    var popoverTrackRef = isGroupNavigation\n        ? highlightedGroupRef\n        : highlightedPoint\n            ? highlightedPointRef\n            : verticalMarkerRef;\n    var highlightDetails = useMemo(function () {\n        if (highlightedX === null) {\n            return null;\n        }\n        for (var _i = 0, visibleSeries_1 = visibleSeries; _i < visibleSeries_1.length; _i++) {\n            var series_2 = visibleSeries_1[_i];\n            if (series_2.series === (highlightedPoint === null || highlightedPoint === void 0 ? void 0 : highlightedPoint.series)) {\n                return formatHighlighted(highlightedX, [series_2], xTickFormatter);\n            }\n        }\n        return formatHighlighted(highlightedX, visibleSeries, xTickFormatter);\n    }, [highlightedX, highlightedPoint, visibleSeries, xTickFormatter]);\n    var activeAriaLabel = useMemo(function () {\n        return highlightDetails\n            ? highlightDetails.position + \", \" + highlightDetails.details.map(function (d) { return d.key + ' ' + d.value; }).join(',')\n            : '';\n    }, [highlightDetails]);\n    var activeLiveRegion = activeAriaLabel && !highlightedPoint && highlightedGroupIndex === null ? activeAriaLabel : '';\n    return (React.createElement(\"div\", { className: styles['chart-container'], ref: containerRef },\n        React.createElement(AxisLabel, { axis: y, position: \"left\", title: xy.title[y] }),\n        React.createElement(\"div\", { className: styles['chart-container__horizontal'] },\n            React.createElement(LabelsMeasure, { ticks: xy.ticks[y], scale: xy.scale[y], tickFormatter: xy.tickFormatter[y], autoWidth: setLeftLabelsWidth }),\n            React.createElement(\"div\", { className: styles['chart-container__vertical'] },\n                React.createElement(ChartPlot, { ref: plotRef, width: plotWidth, height: plotHeight, offsetBottom: bottomLabelsHeight, isClickable: isPopoverOpen && !isPopoverPinned, ariaLabel: ariaLabel, ariaLabelledby: ariaLabelledby, ariaDescription: ariaDescription, ariaRoleDescription: i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.chartAriaRoleDescription, ariaLiveRegion: activeLiveRegion, activeElementRef: isGroupNavigation ? highlightedGroupRef : highlightedPointRef, activeElementKey: isPlotFocused && ((highlightedGroupIndex === null || highlightedGroupIndex === void 0 ? void 0 : highlightedGroupIndex.toString()) || (point === null || point === void 0 ? void 0 : point.key)), activeElementFocusOffset: isGroupNavigation ? 0 : 3, onMouseMove: onSVGMouseMove, onMouseOut: onSVGMouseOut, onMouseDown: onSVGMouseDown, onFocus: onSVGFocus, onBlur: onSVGBlur, onKeyDown: onSVGKeyDown },\n                    React.createElement(LeftLabels, { axis: y, ticks: xy.ticks[y], scale: xy.scale[y], tickFormatter: xy.tickFormatter[y], title: xy.title[y], ariaRoleDescription: xy.ariaRoleDescription[y], width: plotWidth, height: plotHeight }),\n                    horizontalBars && React.createElement(VerticalGridLines, { scale: yScale, ticks: yTicks, height: plotHeight }),\n                    emphasizeBaselineAxis && linesOnly && (React.createElement(EmphasizedBaseline, { axis: x, scale: yScale, width: plotWidth, height: plotHeight })),\n                    React.createElement(DataSeries, { axis: x, plotWidth: plotWidth, plotHeight: plotHeight, highlightedSeries: highlightedSeries !== null && highlightedSeries !== void 0 ? highlightedSeries : null, highlightedGroupIndex: highlightedGroupIndex, stackedBars: stackedBars, isGroupNavigation: isGroupNavigation, visibleSeries: visibleSeries, xScale: xScale, yScale: yScale }),\n                    emphasizeBaselineAxis && !linesOnly && (React.createElement(EmphasizedBaseline, { axis: x, scale: yScale, width: plotWidth, height: plotHeight })),\n                    React.createElement(VerticalMarker, { key: verticalLineX || '', height: plotHeight, showPoints: highlightedPoint === null, showLine: !isGroupNavigation, points: verticalMarkers, ref: verticalMarkerRef }),\n                    highlightedPoint && (React.createElement(HighlightedPoint, { ref: highlightedPointRef, point: point, role: \"button\", ariaLabel: activeAriaLabel, ariaHasPopup: true, ariaExpanded: isPopoverPinned })),\n                    isGroupNavigation && xScale.isCategorical() && (React.createElement(BarGroups, { ariaLabel: activeAriaLabel, isRefresh: isRefresh, isPopoverPinned: isPopoverPinned, barGroups: barGroups, highlightedGroupIndex: highlightedGroupIndex, highlightedGroupRef: highlightedGroupRef })),\n                    React.createElement(BottomLabels, { axis: x, ticks: xy.ticks[x], scale: xy.scale[x], tickFormatter: xy.tickFormatter[x], title: xy.title[x], ariaRoleDescription: xy.ariaRoleDescription[x], height: plotHeight, width: plotWidth, offsetLeft: leftLabelsWidth + BOTTOM_LABELS_OFFSET, offsetRight: BOTTOM_LABELS_OFFSET, autoHeight: setBottomLabelsHeight })),\n                React.createElement(AxisLabel, { axis: x, position: \"bottom\", title: xy.title[x] })),\n            React.createElement(ChartPopover, { containerRef: containerRef, trackRef: popoverTrackRef, isOpen: isPopoverOpen, isPinned: isPopoverPinned, highlightDetails: highlightDetails, onDismiss: onPopoverDismiss, size: detailPopoverSize, dismissAriaLabel: i18nStrings.detailPopoverDismissAriaLabel }))));\n}\n"]},"metadata":{},"sourceType":"module"}