{"ast":null,"code":"import React, { useCallback, useMemo, useRef, useState } from 'react';\nimport clsx from 'clsx';\nimport { pie } from 'd3-shape';\nimport { KeyCode } from '../internal/keycode';\nimport { nodeContains } from '../internal/utils/dom';\nimport { useUniqueId } from '../internal/hooks/use-unique-id';\nimport ChartPopover from '../internal/components/chart-popover';\nimport SeriesDetails from '../internal/components/chart-series-details';\nimport SeriesMarker from '../internal/components/chart-series-marker';\nimport ChartStatusContainer, { getChartStatus } from '../internal/components/chart-status-container';\nimport InternalBox from '../box/internal';\nimport Labels from './labels';\nimport styles from './styles.css.js';\nimport { defaultDetails, dimensionsBySize, refreshDimensionsBySize } from './utils';\nimport Segments from './segments';\nimport { useVisualRefresh } from '../internal/hooks/use-visual-mode';\nimport ChartPlot from '../internal/components/chart-plot';\nexport default (function (_a) {\n  var _b;\n\n  var _c;\n\n  var _d = _a.variant,\n      variant = _d === void 0 ? 'pie' : _d,\n      _e = _a.size,\n      size = _e === void 0 ? 'medium' : _e,\n      _f = _a.i18nStrings,\n      i18nStrings = _f === void 0 ? {} : _f,\n      ariaLabel = _a.ariaLabel,\n      ariaLabelledby = _a.ariaLabelledby,\n      data = _a.data,\n      visibleData = _a.visibleData,\n      ariaDescription = _a.ariaDescription,\n      innerMetricValue = _a.innerMetricValue,\n      innerMetricDescription = _a.innerMetricDescription,\n      _g = _a.hideTitles,\n      hideTitles = _g === void 0 ? false : _g,\n      _h = _a.hideDescriptions,\n      hideDescriptions = _h === void 0 ? false : _h,\n      detailPopoverContent = _a.detailPopoverContent,\n      detailPopoverSize = _a.detailPopoverSize,\n      width = _a.width,\n      additionalFilters = _a.additionalFilters,\n      hideFilter = _a.hideFilter,\n      hideLegend = _a.hideLegend,\n      _j = _a.statusType,\n      statusType = _j === void 0 ? 'finished' : _j,\n      empty = _a.empty,\n      noMatch = _a.noMatch,\n      errorText = _a.errorText,\n      recoveryText = _a.recoveryText,\n      loadingText = _a.loadingText,\n      onRecoveryClick = _a.onRecoveryClick,\n      segmentDescription = _a.segmentDescription,\n      highlightedSegment = _a.highlightedSegment,\n      onHighlightChange = _a.onHighlightChange,\n      legendSegment = _a.legendSegment,\n      pinnedSegment = _a.pinnedSegment,\n      setPinnedSegment = _a.setPinnedSegment;\n  var plotRef = useRef(null);\n  var containerRef = useRef(null);\n  var focusedSegmentRef = useRef(null);\n  var popoverTrackRef = useRef(null);\n  var isRefresh = useVisualRefresh(containerRef);\n  var dimensions = isRefresh ? refreshDimensionsBySize[size] : dimensionsBySize[size];\n  var radius = dimensions.outerRadius;\n  var hasLabels = !(hideTitles && hideDescriptions);\n  var height = 2 * (radius + dimensions.padding + (hasLabels ? dimensions.paddingLabels : 0));\n  var hasInnerContent = variant === 'donut' && (innerMetricValue || innerMetricDescription && size !== 'small');\n  var innerMetricId = useUniqueId('awsui-pie-chart__inner');\n\n  var _k = useState(false),\n      isTooltipOpen = _k[0],\n      setTooltipOpen = _k[1];\n\n  var _l = useState(),\n      tooltipData = _l[0],\n      setTooltipData = _l[1];\n\n  var _m = useMemo(function () {\n    var dataSum = visibleData.reduce(function (sum, d) {\n      return sum + d.datum.value;\n    }, 0);\n    var pieFactory = pie().value(function (d) {\n      return d.datum.value < dataSum / 100 ? dataSum / 100 : d.datum.value;\n    }).sort(null);\n    var pieData = pieFactory(visibleData.filter(function (d) {\n      return d.datum.value > 0;\n    }));\n    return {\n      pieData: pieData,\n      dataSum: dataSum\n    };\n  }, [visibleData]),\n      pieData = _m.pieData,\n      dataSum = _m.dataSum;\n\n  var highlightedSegmentIndex = useMemo(function () {\n    for (var index = 0; index < pieData.length; index++) {\n      if (pieData[index].data.datum === highlightedSegment) {\n        return index;\n      }\n    }\n\n    return null;\n  }, [pieData, highlightedSegment]);\n  var detailFunction = detailPopoverContent || defaultDetails(i18nStrings);\n  var details = tooltipData ? detailFunction(tooltipData.datum, dataSum) : [];\n  var tooltipContent = tooltipData && React.createElement(SeriesDetails, {\n    details: details\n  });\n\n  var _o = getChartStatus({\n    externalData: data,\n    visibleData: pieData,\n    statusType: statusType\n  }),\n      isEmpty = _o.isEmpty,\n      showChart = _o.showChart;\n\n  var isNoMatch = isEmpty && visibleData.length !== data.length;\n  var reserveLegendSpace = !showChart && !hideLegend;\n  var reserveFilterSpace = statusType !== 'finished' && !isNoMatch && (!hideFilter || additionalFilters);\n  var popoverDismissedRecently = useRef(false);\n  var highlightSegment = useCallback(function (internalDatum) {\n    var segment = internalDatum.datum;\n\n    if (segment !== highlightedSegment) {\n      onHighlightChange(segment);\n    }\n\n    if (popoverTrackRef.current) {\n      setTooltipData({\n        datum: internalDatum.datum,\n        series: {\n          color: internalDatum.color,\n          index: internalDatum.index,\n          label: internalDatum.datum.title,\n          markerType: 'rectangle'\n        },\n        trackRef: popoverTrackRef\n      });\n      setTooltipOpen(true);\n    }\n  }, [highlightedSegment, setTooltipOpen, onHighlightChange]);\n  var clearHighlightedSegment = useCallback(function () {\n    setTooltipOpen(false);\n    onHighlightChange(null);\n  }, [onHighlightChange, setTooltipOpen]);\n  var onClick = useCallback(function (internalDatum) {\n    if (pinnedSegment === internalDatum.datum) {\n      setPinnedSegment(null);\n      clearHighlightedSegment();\n    } else {\n      setPinnedSegment(internalDatum.datum);\n      highlightSegment(internalDatum);\n    }\n  }, [pinnedSegment, clearHighlightedSegment, setPinnedSegment, highlightSegment]);\n  var onMouseOver = useCallback(function (internalDatum) {\n    if (pinnedSegment !== null) {\n      return;\n    }\n\n    highlightSegment(internalDatum);\n  }, [pinnedSegment, highlightSegment]);\n  var onMouseOut = useCallback(function () {\n    if (pinnedSegment !== null) {\n      return;\n    }\n\n    clearHighlightedSegment();\n  }, [pinnedSegment, clearHighlightedSegment]);\n  var onKeyDown = useCallback(function (event) {\n    if (event.keyCode !== KeyCode.right && event.keyCode !== KeyCode.left && event.keyCode !== KeyCode.enter) {\n      return;\n    }\n\n    event.preventDefault();\n    var nextIndex = highlightedSegmentIndex || 0;\n    var MAX = pieData.length - 1;\n\n    if (event.keyCode === KeyCode.right) {\n      nextIndex++;\n\n      if (nextIndex > MAX) {\n        nextIndex = 0;\n      }\n    } else if (event.keyCode === KeyCode.left) {\n      nextIndex--;\n\n      if (nextIndex < 0) {\n        nextIndex = MAX;\n      }\n    }\n\n    if (event.keyCode === KeyCode.enter) {\n      setPinnedSegment(pieData[nextIndex].data.datum);\n    }\n\n    highlightSegment(pieData[nextIndex].data);\n  }, [setPinnedSegment, highlightSegment, pieData, highlightedSegmentIndex]);\n  var onFocus = useCallback(function (_event, target) {\n    if (pinnedSegment !== null || popoverDismissedRecently.current || target === 'mouse') {\n      return;\n    }\n\n    var segment = highlightedSegment || legendSegment || pieData[0].data.datum;\n    var matched = pieData.filter(function (d) {\n      return d.data.datum === segment;\n    });\n    highlightSegment(matched[0].data);\n  }, [pinnedSegment, pieData, highlightSegment, highlightedSegment, legendSegment]);\n  var onBlur = useCallback(function (event) {\n    var blurTarget = event.relatedTarget || event.target;\n\n    if (blurTarget === null || !(blurTarget instanceof Element) || !nodeContains(containerRef.current, blurTarget)) {\n      clearHighlightedSegment();\n      setPinnedSegment(null);\n    }\n  }, [clearHighlightedSegment, setPinnedSegment]);\n\n  var onPopoverDismiss = function (outsideClick) {\n    setTooltipOpen(false);\n    setPinnedSegment(null);\n\n    if (!outsideClick) {\n      setTimeout(function () {\n        popoverDismissedRecently.current = true;\n        plotRef.current.focusApplication();\n        popoverDismissedRecently.current = false;\n      }, 0);\n    }\n  };\n\n  return React.createElement(\"div\", {\n    className: clsx(styles.content, styles[\"content--\" + size], (_b = {}, _b[styles['content--without-labels']] = !hasLabels, _b[styles['content--reserve-filter']] = reserveFilterSpace, _b[styles['content--reserve-legend']] = reserveLegendSpace, _b))\n  }, React.createElement(ChartStatusContainer, {\n    isEmpty: isEmpty,\n    isNoMatch: isNoMatch,\n    showChart: showChart,\n    statusType: statusType,\n    empty: empty,\n    noMatch: noMatch,\n    loadingText: loadingText,\n    errorText: errorText,\n    recoveryText: recoveryText,\n    onRecoveryClick: onRecoveryClick\n  }), showChart && React.createElement(\"div\", {\n    className: styles['chart-container'],\n    ref: containerRef\n  }, React.createElement(ChartPlot, {\n    ref: plotRef,\n    width: width,\n    height: height,\n    transform: \"translate(\" + width / 2 + \" \" + height / 2 + \")\",\n    isPrecise: true,\n    isClickable: !isTooltipOpen,\n    ariaLabel: ariaLabel,\n    ariaLabelledby: ariaLabelledby,\n    ariaDescription: ariaDescription,\n    ariaDescribedby: hasInnerContent ? innerMetricId : undefined,\n    ariaRoleDescription: i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.chartAriaRoleDescription,\n    ariaLiveRegion: tooltipContent,\n    activeElementRef: focusedSegmentRef,\n    activeElementKey: highlightedSegmentIndex === null || highlightedSegmentIndex === void 0 ? void 0 : highlightedSegmentIndex.toString(),\n    onFocus: onFocus,\n    onBlur: onBlur,\n    onKeyDown: onKeyDown\n  }, React.createElement(Segments, {\n    pieData: pieData,\n    size: size,\n    variant: variant,\n    containerRef: containerRef,\n    focusedSegmentRef: focusedSegmentRef,\n    popoverTrackRef: popoverTrackRef,\n    highlightedSegment: highlightedSegment,\n    segmentAriaRoleDescription: i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.segmentAriaRoleDescription,\n    onClick: onClick,\n    onMouseOver: onMouseOver,\n    onMouseOut: onMouseOut\n  }), hasLabels && React.createElement(Labels, {\n    pieData: pieData,\n    size: size,\n    segmentDescription: segmentDescription,\n    visibleDataSum: dataSum,\n    hideTitles: hideTitles,\n    hideDescriptions: hideDescriptions,\n    highlightedSegment: highlightedSegment,\n    containerRef: containerRef\n  })), hasInnerContent && React.createElement(\"div\", {\n    className: styles['inner-content'],\n    id: innerMetricId\n  }, innerMetricValue && React.createElement(InternalBox, {\n    variant: size === 'small' ? 'h3' : 'h1',\n    tagOverride: \"div\",\n    color: \"inherit\",\n    padding: \"n\"\n  }, innerMetricValue), innerMetricDescription && size !== 'small' && React.createElement(InternalBox, {\n    variant: \"h3\",\n    color: \"text-body-secondary\",\n    tagOverride: \"div\",\n    padding: \"n\"\n  }, innerMetricDescription)), isTooltipOpen && tooltipData && React.createElement(ChartPopover, {\n    title: tooltipData.series && React.createElement(InternalBox, {\n      className: styles['popover-header'],\n      variant: \"strong\"\n    }, React.createElement(SeriesMarker, {\n      color: tooltipData.series.color,\n      type: tooltipData.series.markerType\n    }), ' ', tooltipData.series.label),\n    trackRef: tooltipData.trackRef,\n    trackKey: tooltipData.series.index,\n    dismissButton: pinnedSegment !== null,\n    dismissAriaLabel: i18nStrings.detailPopoverDismissAriaLabel,\n    onDismiss: onPopoverDismiss,\n    container: ((_c = plotRef.current) === null || _c === void 0 ? void 0 : _c.svg) || null,\n    size: detailPopoverSize\n  }, tooltipContent)));\n});","map":{"version":3,"sources":["/Users/isingheg/Desktop/projects/test-react-amplify/node_modules/@awsui/components-react/pie-chart/pie-chart.js"],"names":["React","useCallback","useMemo","useRef","useState","clsx","pie","KeyCode","nodeContains","useUniqueId","ChartPopover","SeriesDetails","SeriesMarker","ChartStatusContainer","getChartStatus","InternalBox","Labels","styles","defaultDetails","dimensionsBySize","refreshDimensionsBySize","Segments","useVisualRefresh","ChartPlot","_a","_b","_c","_d","variant","_e","size","_f","i18nStrings","ariaLabel","ariaLabelledby","data","visibleData","ariaDescription","innerMetricValue","innerMetricDescription","_g","hideTitles","_h","hideDescriptions","detailPopoverContent","detailPopoverSize","width","additionalFilters","hideFilter","hideLegend","_j","statusType","empty","noMatch","errorText","recoveryText","loadingText","onRecoveryClick","segmentDescription","highlightedSegment","onHighlightChange","legendSegment","pinnedSegment","setPinnedSegment","plotRef","containerRef","focusedSegmentRef","popoverTrackRef","isRefresh","dimensions","radius","outerRadius","hasLabels","height","padding","paddingLabels","hasInnerContent","innerMetricId","_k","isTooltipOpen","setTooltipOpen","_l","tooltipData","setTooltipData","_m","dataSum","reduce","sum","d","datum","value","pieFactory","sort","pieData","filter","highlightedSegmentIndex","index","length","detailFunction","details","tooltipContent","createElement","_o","externalData","isEmpty","showChart","isNoMatch","reserveLegendSpace","reserveFilterSpace","popoverDismissedRecently","highlightSegment","internalDatum","segment","current","series","color","label","title","markerType","trackRef","clearHighlightedSegment","onClick","onMouseOver","onMouseOut","onKeyDown","event","keyCode","right","left","enter","preventDefault","nextIndex","MAX","onFocus","_event","target","matched","onBlur","blurTarget","relatedTarget","Element","onPopoverDismiss","outsideClick","setTimeout","focusApplication","className","content","ref","transform","isPrecise","isClickable","ariaDescribedby","undefined","ariaRoleDescription","chartAriaRoleDescription","ariaLiveRegion","activeElementRef","activeElementKey","toString","segmentAriaRoleDescription","visibleDataSum","id","tagOverride","type","trackKey","dismissButton","dismissAriaLabel","detailPopoverDismissAriaLabel","onDismiss","container","svg"],"mappings":"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","sourcesContent":["import React, { useCallback, useMemo, useRef, useState } from 'react';\nimport clsx from 'clsx';\nimport { pie } from 'd3-shape';\nimport { KeyCode } from '../internal/keycode';\nimport { nodeContains } from '../internal/utils/dom';\nimport { useUniqueId } from '../internal/hooks/use-unique-id';\nimport ChartPopover from '../internal/components/chart-popover';\nimport SeriesDetails from '../internal/components/chart-series-details';\nimport SeriesMarker from '../internal/components/chart-series-marker';\nimport ChartStatusContainer, { getChartStatus } from '../internal/components/chart-status-container';\nimport InternalBox from '../box/internal';\nimport Labels from './labels';\nimport styles from './styles.css.js';\nimport { defaultDetails, dimensionsBySize, refreshDimensionsBySize } from './utils';\nimport Segments from './segments';\nimport { useVisualRefresh } from '../internal/hooks/use-visual-mode';\nimport ChartPlot from '../internal/components/chart-plot';\nexport default (function (_a) {\n    var _b;\n    var _c;\n    var _d = _a.variant, variant = _d === void 0 ? 'pie' : _d, _e = _a.size, size = _e === void 0 ? 'medium' : _e, _f = _a.i18nStrings, i18nStrings = _f === void 0 ? {} : _f, ariaLabel = _a.ariaLabel, ariaLabelledby = _a.ariaLabelledby, data = _a.data, visibleData = _a.visibleData, ariaDescription = _a.ariaDescription, innerMetricValue = _a.innerMetricValue, innerMetricDescription = _a.innerMetricDescription, _g = _a.hideTitles, hideTitles = _g === void 0 ? false : _g, _h = _a.hideDescriptions, hideDescriptions = _h === void 0 ? false : _h, detailPopoverContent = _a.detailPopoverContent, detailPopoverSize = _a.detailPopoverSize, width = _a.width, additionalFilters = _a.additionalFilters, hideFilter = _a.hideFilter, hideLegend = _a.hideLegend, _j = _a.statusType, statusType = _j === void 0 ? 'finished' : _j, empty = _a.empty, noMatch = _a.noMatch, errorText = _a.errorText, recoveryText = _a.recoveryText, loadingText = _a.loadingText, onRecoveryClick = _a.onRecoveryClick, segmentDescription = _a.segmentDescription, highlightedSegment = _a.highlightedSegment, onHighlightChange = _a.onHighlightChange, legendSegment = _a.legendSegment, pinnedSegment = _a.pinnedSegment, setPinnedSegment = _a.setPinnedSegment;\n    var plotRef = useRef(null);\n    var containerRef = useRef(null);\n    var focusedSegmentRef = useRef(null);\n    var popoverTrackRef = useRef(null);\n    var isRefresh = useVisualRefresh(containerRef);\n    var dimensions = isRefresh ? refreshDimensionsBySize[size] : dimensionsBySize[size];\n    var radius = dimensions.outerRadius;\n    var hasLabels = !(hideTitles && hideDescriptions);\n    var height = 2 * (radius + dimensions.padding + (hasLabels ? dimensions.paddingLabels : 0));\n    var hasInnerContent = variant === 'donut' && (innerMetricValue || (innerMetricDescription && size !== 'small'));\n    var innerMetricId = useUniqueId('awsui-pie-chart__inner');\n    var _k = useState(false), isTooltipOpen = _k[0], setTooltipOpen = _k[1];\n    var _l = useState(), tooltipData = _l[0], setTooltipData = _l[1];\n    var _m = useMemo(function () {\n        var dataSum = visibleData.reduce(function (sum, d) { return sum + d.datum.value; }, 0);\n        var pieFactory = pie()\n            .value(function (d) { return (d.datum.value < dataSum / 100 ? dataSum / 100 : d.datum.value); })\n            .sort(null);\n        var pieData = pieFactory(visibleData.filter(function (d) { return d.datum.value > 0; }));\n        return { pieData: pieData, dataSum: dataSum };\n    }, [visibleData]), pieData = _m.pieData, dataSum = _m.dataSum;\n    var highlightedSegmentIndex = useMemo(function () {\n        for (var index = 0; index < pieData.length; index++) {\n            if (pieData[index].data.datum === highlightedSegment) {\n                return index;\n            }\n        }\n        return null;\n    }, [pieData, highlightedSegment]);\n    var detailFunction = detailPopoverContent || defaultDetails(i18nStrings);\n    var details = tooltipData ? detailFunction(tooltipData.datum, dataSum) : [];\n    var tooltipContent = tooltipData && React.createElement(SeriesDetails, { details: details });\n    var _o = getChartStatus({ externalData: data, visibleData: pieData, statusType: statusType }), isEmpty = _o.isEmpty, showChart = _o.showChart;\n    var isNoMatch = isEmpty && visibleData.length !== data.length;\n    var reserveLegendSpace = !showChart && !hideLegend;\n    var reserveFilterSpace = statusType !== 'finished' && !isNoMatch && (!hideFilter || additionalFilters);\n    var popoverDismissedRecently = useRef(false);\n    var highlightSegment = useCallback(function (internalDatum) {\n        var segment = internalDatum.datum;\n        if (segment !== highlightedSegment) {\n            onHighlightChange(segment);\n        }\n        if (popoverTrackRef.current) {\n            setTooltipData({\n                datum: internalDatum.datum,\n                series: {\n                    color: internalDatum.color,\n                    index: internalDatum.index,\n                    label: internalDatum.datum.title,\n                    markerType: 'rectangle'\n                },\n                trackRef: popoverTrackRef\n            });\n            setTooltipOpen(true);\n        }\n    }, [highlightedSegment, setTooltipOpen, onHighlightChange]);\n    var clearHighlightedSegment = useCallback(function () {\n        setTooltipOpen(false);\n        onHighlightChange(null);\n    }, [onHighlightChange, setTooltipOpen]);\n    var onClick = useCallback(function (internalDatum) {\n        if (pinnedSegment === internalDatum.datum) {\n            setPinnedSegment(null);\n            clearHighlightedSegment();\n        }\n        else {\n            setPinnedSegment(internalDatum.datum);\n            highlightSegment(internalDatum);\n        }\n    }, [pinnedSegment, clearHighlightedSegment, setPinnedSegment, highlightSegment]);\n    var onMouseOver = useCallback(function (internalDatum) {\n        if (pinnedSegment !== null) {\n            return;\n        }\n        highlightSegment(internalDatum);\n    }, [pinnedSegment, highlightSegment]);\n    var onMouseOut = useCallback(function () {\n        if (pinnedSegment !== null) {\n            return;\n        }\n        clearHighlightedSegment();\n    }, [pinnedSegment, clearHighlightedSegment]);\n    var onKeyDown = useCallback(function (event) {\n        if (event.keyCode !== KeyCode.right && event.keyCode !== KeyCode.left && event.keyCode !== KeyCode.enter) {\n            return;\n        }\n        event.preventDefault();\n        var nextIndex = highlightedSegmentIndex || 0;\n        var MAX = pieData.length - 1;\n        if (event.keyCode === KeyCode.right) {\n            nextIndex++;\n            if (nextIndex > MAX) {\n                nextIndex = 0;\n            }\n        }\n        else if (event.keyCode === KeyCode.left) {\n            nextIndex--;\n            if (nextIndex < 0) {\n                nextIndex = MAX;\n            }\n        }\n        if (event.keyCode === KeyCode.enter) {\n            setPinnedSegment(pieData[nextIndex].data.datum);\n        }\n        highlightSegment(pieData[nextIndex].data);\n    }, [setPinnedSegment, highlightSegment, pieData, highlightedSegmentIndex]);\n    var onFocus = useCallback(function (_event, target) {\n        if (pinnedSegment !== null || popoverDismissedRecently.current || target === 'mouse') {\n            return;\n        }\n        var segment = highlightedSegment || legendSegment || pieData[0].data.datum;\n        var matched = pieData.filter(function (d) { return d.data.datum === segment; });\n        highlightSegment(matched[0].data);\n    }, [pinnedSegment, pieData, highlightSegment, highlightedSegment, legendSegment]);\n    var onBlur = useCallback(function (event) {\n        var blurTarget = event.relatedTarget || event.target;\n        if (blurTarget === null || !(blurTarget instanceof Element) || !nodeContains(containerRef.current, blurTarget)) {\n            clearHighlightedSegment();\n            setPinnedSegment(null);\n        }\n    }, [clearHighlightedSegment, setPinnedSegment]);\n    var onPopoverDismiss = function (outsideClick) {\n        setTooltipOpen(false);\n        setPinnedSegment(null);\n        if (!outsideClick) {\n            setTimeout(function () {\n                popoverDismissedRecently.current = true;\n                plotRef.current.focusApplication();\n                popoverDismissedRecently.current = false;\n            }, 0);\n        }\n    };\n    return (React.createElement(\"div\", { className: clsx(styles.content, styles[\"content--\" + size], (_b = {},\n            _b[styles['content--without-labels']] = !hasLabels,\n            _b[styles['content--reserve-filter']] = reserveFilterSpace,\n            _b[styles['content--reserve-legend']] = reserveLegendSpace,\n            _b)) },\n        React.createElement(ChartStatusContainer, { isEmpty: isEmpty, isNoMatch: isNoMatch, showChart: showChart, statusType: statusType, empty: empty, noMatch: noMatch, loadingText: loadingText, errorText: errorText, recoveryText: recoveryText, onRecoveryClick: onRecoveryClick }),\n        showChart && (React.createElement(\"div\", { className: styles['chart-container'], ref: containerRef },\n            React.createElement(ChartPlot, { ref: plotRef, width: width, height: height, transform: \"translate(\" + width / 2 + \" \" + height / 2 + \")\", isPrecise: true, isClickable: !isTooltipOpen, ariaLabel: ariaLabel, ariaLabelledby: ariaLabelledby, ariaDescription: ariaDescription, ariaDescribedby: hasInnerContent ? innerMetricId : undefined, ariaRoleDescription: i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.chartAriaRoleDescription, ariaLiveRegion: tooltipContent, activeElementRef: focusedSegmentRef, activeElementKey: highlightedSegmentIndex === null || highlightedSegmentIndex === void 0 ? void 0 : highlightedSegmentIndex.toString(), onFocus: onFocus, onBlur: onBlur, onKeyDown: onKeyDown },\n                React.createElement(Segments, { pieData: pieData, size: size, variant: variant, containerRef: containerRef, focusedSegmentRef: focusedSegmentRef, popoverTrackRef: popoverTrackRef, highlightedSegment: highlightedSegment, segmentAriaRoleDescription: i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.segmentAriaRoleDescription, onClick: onClick, onMouseOver: onMouseOver, onMouseOut: onMouseOut }),\n                hasLabels && (React.createElement(Labels, { pieData: pieData, size: size, segmentDescription: segmentDescription, visibleDataSum: dataSum, hideTitles: hideTitles, hideDescriptions: hideDescriptions, highlightedSegment: highlightedSegment, containerRef: containerRef }))),\n            hasInnerContent && (React.createElement(\"div\", { className: styles['inner-content'], id: innerMetricId },\n                innerMetricValue && (React.createElement(InternalBox, { variant: size === 'small' ? 'h3' : 'h1', tagOverride: \"div\", color: \"inherit\", padding: \"n\" }, innerMetricValue)),\n                innerMetricDescription && size !== 'small' && (React.createElement(InternalBox, { variant: \"h3\", color: \"text-body-secondary\", tagOverride: \"div\", padding: \"n\" }, innerMetricDescription)))),\n            isTooltipOpen && tooltipData && (React.createElement(ChartPopover, { title: tooltipData.series && (React.createElement(InternalBox, { className: styles['popover-header'], variant: \"strong\" },\n                    React.createElement(SeriesMarker, { color: tooltipData.series.color, type: tooltipData.series.markerType }),\n                    ' ',\n                    tooltipData.series.label)), trackRef: tooltipData.trackRef, trackKey: tooltipData.series.index, dismissButton: pinnedSegment !== null, dismissAriaLabel: i18nStrings.detailPopoverDismissAriaLabel, onDismiss: onPopoverDismiss, container: ((_c = plotRef.current) === null || _c === void 0 ? void 0 : _c.svg) || null, size: detailPopoverSize }, tooltipContent))))));\n});\n"]},"metadata":{},"sourceType":"module"}