{"ast":null,"code":"var _a, _b, _c;\n\nimport { __spreadArray } from \"tslib\";\nimport { useState } from 'react';\nimport { fireNonCancelableEvent } from '../internal/events';\nimport { useUniqueId } from '../internal/hooks/use-unique-id';\nimport { findUpUntil } from '../internal/utils/dom';\nimport { getTrackableValue } from './utils';\nimport selectionStyles from './selection-control/styles.css.js';\nvar SELECTION_ITEM = 'selection-item';\nvar SELECTION_ROOT = 'selection-root';\n\nfunction findSelectionControlByIndex(rootContainer, index) {\n  if (index === -1) {\n    return rootContainer.querySelector(\"[data-\" + SELECTION_ITEM + \"=\\\"all\\\"] .\" + selectionStyles.root + \" input\");\n  }\n\n  return rootContainer.querySelectorAll(\"[data-\" + SELECTION_ITEM + \"=\\\"item\\\"] .\" + selectionStyles.root + \" input\")[index];\n}\n\nfunction findRootContainer(element) {\n  return findUpUntil(element, function (node) {\n    return node.dataset.selectionRoot === 'true';\n  });\n}\n\nexport function useFocusMove(selectionType, totalItems) {\n  if (selectionType !== 'multi') {\n    return {};\n  }\n\n  function moveFocus(sourceElement, fromIndex, direction) {\n    var index = fromIndex;\n    var rootContainer = findRootContainer(sourceElement);\n\n    while (index >= -1 && index < totalItems) {\n      index += direction;\n      var control = findSelectionControlByIndex(rootContainer, index);\n\n      if (control && !control.disabled) {\n        control.focus();\n        break;\n      }\n    }\n  }\n\n  var _a = [1, -1].map(function (direction) {\n    return function (event) {\n      var target = event.currentTarget;\n      var itemNode = findUpUntil(target, function (node) {\n        return node.dataset.selectionItem === 'item';\n      });\n      var fromIndex = Array.prototype.indexOf.call(itemNode.parentElement.children, itemNode);\n      moveFocus(target, fromIndex, direction);\n    };\n  }),\n      moveFocusDown = _a[0],\n      moveFocusUp = _a[1];\n\n  return {\n    moveFocusDown: moveFocusDown,\n    moveFocusUp: moveFocusUp,\n    moveFocus: moveFocus\n  };\n}\n\nvar ItemSet = function () {\n  function ItemSet(trackBy, items) {\n    var _this = this;\n\n    this.map = new Map();\n\n    this.put = function (item) {\n      return _this.map.set.call(_this.map, getTrackableValue(_this.trackBy, item), item);\n    };\n\n    this.has = function (item) {\n      return _this.map.has.call(_this.map, getTrackableValue(_this.trackBy, item));\n    };\n\n    this.forEach = this.map.forEach.bind(this.map);\n    this.trackBy = trackBy;\n    items.forEach(this.put);\n  }\n\n  return ItemSet;\n}();\n\nexport var focusMarkers = {\n  item: (_a = {}, _a['data-' + SELECTION_ITEM] = 'item', _a),\n  all: (_b = {}, _b['data-' + SELECTION_ITEM] = 'all', _b),\n  root: (_c = {}, _c['data-' + SELECTION_ROOT] = 'true', _c)\n};\nexport function useSelection(_a) {\n  var items = _a.items,\n      _b = _a.selectedItems,\n      selectedItems = _b === void 0 ? [] : _b,\n      selectionType = _a.selectionType,\n      _c = _a.isItemDisabled,\n      isItemDisabled = _c === void 0 ? function () {\n    return false;\n  } : _c,\n      trackBy = _a.trackBy,\n      onSelectionChange = _a.onSelectionChange,\n      ariaLabels = _a.ariaLabels;\n\n  var _d = useState(false),\n      shiftPressed = _d[0],\n      setShiftPressed = _d[1];\n\n  var _e = useState(null),\n      lastClickedItem = _e[0],\n      setLastClickedItem = _e[1];\n\n  var selectionName = useUniqueId();\n  var finalSelectedItems = selectionType === 'single' ? selectedItems.slice(0, 1) : selectedItems;\n  var selectedSet = new ItemSet(trackBy, finalSelectedItems);\n  var itemIndexesMap = new Map();\n  items.forEach(function (item, i) {\n    return itemIndexesMap.set(getTrackableValue(trackBy, item), i);\n  });\n  var isItemSelected = selectedSet.has.bind(selectedSet);\n\n  var getItemState = function (item) {\n    return {\n      disabled: isItemDisabled(item),\n      selected: isItemSelected(item)\n    };\n  };\n\n  var _f = selectionType ? items.reduce(function (_a, item) {\n    var allDisabled = _a[0],\n        allEnabledSelected = _a[1],\n        hasSelected = _a[2];\n\n    var _b = getItemState(item),\n        disabled = _b.disabled,\n        selected = _b.selected;\n\n    return [allDisabled && disabled, allEnabledSelected && (selected || disabled), hasSelected || selected];\n  }, [true, true, false]) : [true, true, false],\n      allDisabled = _f[0],\n      allEnabledSelected = _f[1],\n      hasSelected = _f[2];\n\n  var handleToggleAll = function () {\n    var requestedItems = new ItemSet(trackBy, items);\n    var newSelectedItems = allEnabledSelected ? deselectItems(requestedItems) : selectItems(requestedItems);\n    fireNonCancelableEvent(onSelectionChange, {\n      selectedItems: newSelectedItems\n    });\n  };\n\n  var getRequestedItems = function (item) {\n    var requestedItems = new ItemSet(trackBy, [item]);\n    var lastClickedItemIndex = lastClickedItem ? itemIndexesMap.get(getTrackableValue(trackBy, lastClickedItem)) : -1;\n\n    if (lastClickedItemIndex === undefined) {\n      lastClickedItemIndex = -1;\n    }\n\n    if (shiftPressed && lastClickedItemIndex !== -1) {\n      var currentItemIndex = itemIndexesMap.get(getTrackableValue(trackBy, item));\n      var start = Math.min(currentItemIndex, lastClickedItemIndex);\n      var end = Math.max(currentItemIndex, lastClickedItemIndex);\n      items.slice(start, end + 1).forEach(function (item) {\n        return requestedItems.put(item);\n      });\n    }\n\n    return requestedItems;\n  };\n\n  var deselectItems = function (requestedItems) {\n    var newSelectedItems = [];\n    selectedItems.forEach(function (selectedItem) {\n      var toUnselect = requestedItems.has(selectedItem);\n\n      if (!toUnselect || isItemDisabled(selectedItem)) {\n        newSelectedItems.push(selectedItem);\n      }\n    });\n    return newSelectedItems;\n  };\n\n  var selectItems = function (requestedItems) {\n    var newSelectedItems = __spreadArray([], selectedItems, true);\n\n    requestedItems.forEach(function (newItem) {\n      var _a = getItemState(newItem),\n          selected = _a.selected,\n          disabled = _a.disabled;\n\n      if (!selected && !disabled) {\n        newSelectedItems.push(newItem);\n      }\n    });\n    return newSelectedItems;\n  };\n\n  var handleToggleItem = function (item) {\n    return function () {\n      var _a = getItemState(item),\n          disabled = _a.disabled,\n          selected = _a.selected;\n\n      if (disabled || selectionType === 'single' && selected) {\n        return;\n      }\n\n      if (selectionType === 'single') {\n        fireNonCancelableEvent(onSelectionChange, {\n          selectedItems: [item]\n        });\n      } else {\n        var requestedItems = getRequestedItems(item);\n        var selectedItems_1 = selected ? deselectItems(requestedItems) : selectItems(requestedItems);\n        fireNonCancelableEvent(onSelectionChange, {\n          selectedItems: selectedItems_1\n        });\n        setLastClickedItem(item);\n      }\n    };\n  };\n\n  var getRowLabel = function (item) {\n    return ariaLabels && ariaLabels.selectionGroupLabel + ' ' + ariaLabels.itemSelectionLabel({\n      selectedItems: selectedItems\n    }, item);\n  };\n\n  return {\n    isItemSelected: isItemSelected,\n    selectAllProps: {\n      name: selectionName,\n      disabled: allDisabled,\n      selectionType: selectionType,\n      indeterminate: hasSelected && !allEnabledSelected,\n      checked: hasSelected && allEnabledSelected,\n      onChange: handleToggleAll,\n      ariaLabel: ariaLabels && ariaLabels.selectionGroupLabel + ' ' + (ariaLabels.allItemsSelectionLabel && ariaLabels.allItemsSelectionLabel({\n        selectedItems: selectedItems\n      }))\n    },\n    getItemSelectionProps: function (item) {\n      return {\n        name: selectionName,\n        selectionType: selectionType,\n        ariaLabel: getRowLabel(item),\n        onChange: handleToggleItem(item),\n        checked: isItemSelected(item),\n        disabled: isItemDisabled(item)\n      };\n    },\n    updateShiftToggle: function (value) {\n      setShiftPressed(value);\n    }\n  };\n}","map":{"version":3,"sources":["/Users/isingheg/Desktop/projects/test-react-amplify/node_modules/@awsui/components-react/table/use-selection.js"],"names":["_a","_b","_c","__spreadArray","useState","fireNonCancelableEvent","useUniqueId","findUpUntil","getTrackableValue","selectionStyles","SELECTION_ITEM","SELECTION_ROOT","findSelectionControlByIndex","rootContainer","index","querySelector","root","querySelectorAll","findRootContainer","element","node","dataset","selectionRoot","useFocusMove","selectionType","totalItems","moveFocus","sourceElement","fromIndex","direction","control","disabled","focus","map","event","target","currentTarget","itemNode","selectionItem","Array","prototype","indexOf","call","parentElement","children","moveFocusDown","moveFocusUp","ItemSet","trackBy","items","_this","Map","put","item","set","has","forEach","bind","focusMarkers","all","useSelection","selectedItems","isItemDisabled","onSelectionChange","ariaLabels","_d","shiftPressed","setShiftPressed","_e","lastClickedItem","setLastClickedItem","selectionName","finalSelectedItems","slice","selectedSet","itemIndexesMap","i","isItemSelected","getItemState","selected","_f","reduce","allDisabled","allEnabledSelected","hasSelected","handleToggleAll","requestedItems","newSelectedItems","deselectItems","selectItems","getRequestedItems","lastClickedItemIndex","get","undefined","currentItemIndex","start","Math","min","end","max","selectedItem","toUnselect","push","newItem","handleToggleItem","selectedItems_1","getRowLabel","selectionGroupLabel","itemSelectionLabel","selectAllProps","name","indeterminate","checked","onChange","ariaLabel","allItemsSelectionLabel","getItemSelectionProps","updateShiftToggle","value"],"mappings":"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","sourcesContent":["var _a, _b, _c;\nimport { __spreadArray } from \"tslib\";\nimport { useState } from 'react';\nimport { fireNonCancelableEvent } from '../internal/events';\nimport { useUniqueId } from '../internal/hooks/use-unique-id';\nimport { findUpUntil } from '../internal/utils/dom';\nimport { getTrackableValue } from './utils';\nimport selectionStyles from './selection-control/styles.css.js';\nvar SELECTION_ITEM = 'selection-item';\nvar SELECTION_ROOT = 'selection-root';\nfunction findSelectionControlByIndex(rootContainer, index) {\n    if (index === -1) {\n        return rootContainer.querySelector(\"[data-\" + SELECTION_ITEM + \"=\\\"all\\\"] .\" + selectionStyles.root + \" input\");\n    }\n    return rootContainer.querySelectorAll(\"[data-\" + SELECTION_ITEM + \"=\\\"item\\\"] .\" + selectionStyles.root + \" input\")[index];\n}\nfunction findRootContainer(element) {\n    return findUpUntil(element, function (node) { return node.dataset.selectionRoot === 'true'; });\n}\nexport function useFocusMove(selectionType, totalItems) {\n    if (selectionType !== 'multi') {\n        return {};\n    }\n    function moveFocus(sourceElement, fromIndex, direction) {\n        var index = fromIndex;\n        var rootContainer = findRootContainer(sourceElement);\n        while (index >= -1 && index < totalItems) {\n            index += direction;\n            var control = findSelectionControlByIndex(rootContainer, index);\n            if (control && !control.disabled) {\n                control.focus();\n                break;\n            }\n        }\n    }\n    var _a = [1, -1].map(function (direction) {\n        return function (event) {\n            var target = event.currentTarget;\n            var itemNode = findUpUntil(target, function (node) { return node.dataset.selectionItem === 'item'; });\n            var fromIndex = Array.prototype.indexOf.call(itemNode.parentElement.children, itemNode);\n            moveFocus(target, fromIndex, direction);\n        };\n    }), moveFocusDown = _a[0], moveFocusUp = _a[1];\n    return {\n        moveFocusDown: moveFocusDown,\n        moveFocusUp: moveFocusUp,\n        moveFocus: moveFocus\n    };\n}\nvar ItemSet = (function () {\n    function ItemSet(trackBy, items) {\n        var _this = this;\n        this.map = new Map();\n        this.put = function (item) { return _this.map.set.call(_this.map, getTrackableValue(_this.trackBy, item), item); };\n        this.has = function (item) { return _this.map.has.call(_this.map, getTrackableValue(_this.trackBy, item)); };\n        this.forEach = this.map.forEach.bind(this.map);\n        this.trackBy = trackBy;\n        items.forEach(this.put);\n    }\n    return ItemSet;\n}());\nexport var focusMarkers = {\n    item: (_a = {}, _a['data-' + SELECTION_ITEM] = 'item', _a),\n    all: (_b = {}, _b['data-' + SELECTION_ITEM] = 'all', _b),\n    root: (_c = {}, _c['data-' + SELECTION_ROOT] = 'true', _c)\n};\nexport function useSelection(_a) {\n    var items = _a.items, _b = _a.selectedItems, selectedItems = _b === void 0 ? [] : _b, selectionType = _a.selectionType, _c = _a.isItemDisabled, isItemDisabled = _c === void 0 ? function () { return false; } : _c, trackBy = _a.trackBy, onSelectionChange = _a.onSelectionChange, ariaLabels = _a.ariaLabels;\n    var _d = useState(false), shiftPressed = _d[0], setShiftPressed = _d[1];\n    var _e = useState(null), lastClickedItem = _e[0], setLastClickedItem = _e[1];\n    var selectionName = useUniqueId();\n    var finalSelectedItems = selectionType === 'single' ? selectedItems.slice(0, 1) : selectedItems;\n    var selectedSet = new ItemSet(trackBy, finalSelectedItems);\n    var itemIndexesMap = new Map();\n    items.forEach(function (item, i) { return itemIndexesMap.set(getTrackableValue(trackBy, item), i); });\n    var isItemSelected = selectedSet.has.bind(selectedSet);\n    var getItemState = function (item) { return ({\n        disabled: isItemDisabled(item),\n        selected: isItemSelected(item)\n    }); };\n    var _f = selectionType\n        ? items.reduce(function (_a, item) {\n            var allDisabled = _a[0], allEnabledSelected = _a[1], hasSelected = _a[2];\n            var _b = getItemState(item), disabled = _b.disabled, selected = _b.selected;\n            return [\n                allDisabled && disabled,\n                allEnabledSelected && (selected || disabled),\n                hasSelected || selected,\n            ];\n        }, [true, true, false])\n        : [true, true, false], allDisabled = _f[0], allEnabledSelected = _f[1], hasSelected = _f[2];\n    var handleToggleAll = function () {\n        var requestedItems = new ItemSet(trackBy, items);\n        var newSelectedItems = allEnabledSelected ? deselectItems(requestedItems) : selectItems(requestedItems);\n        fireNonCancelableEvent(onSelectionChange, { selectedItems: newSelectedItems });\n    };\n    var getRequestedItems = function (item) {\n        var requestedItems = new ItemSet(trackBy, [item]);\n        var lastClickedItemIndex = lastClickedItem ? itemIndexesMap.get(getTrackableValue(trackBy, lastClickedItem)) : -1;\n        if (lastClickedItemIndex === undefined) {\n            lastClickedItemIndex = -1;\n        }\n        if (shiftPressed && lastClickedItemIndex !== -1) {\n            var currentItemIndex = itemIndexesMap.get(getTrackableValue(trackBy, item));\n            var start = Math.min(currentItemIndex, lastClickedItemIndex);\n            var end = Math.max(currentItemIndex, lastClickedItemIndex);\n            items.slice(start, end + 1).forEach(function (item) { return requestedItems.put(item); });\n        }\n        return requestedItems;\n    };\n    var deselectItems = function (requestedItems) {\n        var newSelectedItems = [];\n        selectedItems.forEach(function (selectedItem) {\n            var toUnselect = requestedItems.has(selectedItem);\n            if (!toUnselect || isItemDisabled(selectedItem)) {\n                newSelectedItems.push(selectedItem);\n            }\n        });\n        return newSelectedItems;\n    };\n    var selectItems = function (requestedItems) {\n        var newSelectedItems = __spreadArray([], selectedItems, true);\n        requestedItems.forEach(function (newItem) {\n            var _a = getItemState(newItem), selected = _a.selected, disabled = _a.disabled;\n            if (!selected && !disabled) {\n                newSelectedItems.push(newItem);\n            }\n        });\n        return newSelectedItems;\n    };\n    var handleToggleItem = function (item) { return function () {\n        var _a = getItemState(item), disabled = _a.disabled, selected = _a.selected;\n        if (disabled || (selectionType === 'single' && selected)) {\n            return;\n        }\n        if (selectionType === 'single') {\n            fireNonCancelableEvent(onSelectionChange, { selectedItems: [item] });\n        }\n        else {\n            var requestedItems = getRequestedItems(item);\n            var selectedItems_1 = selected ? deselectItems(requestedItems) : selectItems(requestedItems);\n            fireNonCancelableEvent(onSelectionChange, { selectedItems: selectedItems_1 });\n            setLastClickedItem(item);\n        }\n    }; };\n    var getRowLabel = function (item) {\n        return ariaLabels && ariaLabels.selectionGroupLabel + ' ' + ariaLabels.itemSelectionLabel({ selectedItems: selectedItems }, item);\n    };\n    return {\n        isItemSelected: isItemSelected,\n        selectAllProps: {\n            name: selectionName,\n            disabled: allDisabled,\n            selectionType: selectionType,\n            indeterminate: hasSelected && !allEnabledSelected,\n            checked: hasSelected && allEnabledSelected,\n            onChange: handleToggleAll,\n            ariaLabel: ariaLabels &&\n                ariaLabels.selectionGroupLabel +\n                    ' ' +\n                    (ariaLabels.allItemsSelectionLabel && ariaLabels.allItemsSelectionLabel({ selectedItems: selectedItems }))\n        },\n        getItemSelectionProps: function (item) { return ({\n            name: selectionName,\n            selectionType: selectionType,\n            ariaLabel: getRowLabel(item),\n            onChange: handleToggleItem(item),\n            checked: isItemSelected(item),\n            disabled: isItemDisabled(item)\n        }); },\n        updateShiftToggle: function (value) {\n            setShiftPressed(value);\n        }\n    };\n}\n"]},"metadata":{},"sourceType":"module"}